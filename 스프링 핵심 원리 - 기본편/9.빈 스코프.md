# ğŸ“– ë¹ˆ ìŠ¤ì½”í”„
<br/><br/>
# ğŸ” ë¹ˆ ìŠ¤ì½”í”„ë€?
ìŠ¤í”„ë§ ë¹ˆì€ ê¸°ë³¸ì ìœ¼ë¡œ ì‹±ê¸€í†¤ ìŠ¤ì½”í”„ë¡œ ìƒì„±ë˜ë©°, ìŠ¤ì½”í”„ëŠ” ë¹ˆì´ ì¡´ì¬í•  ìˆ˜ ìˆëŠ” ë²”ìœ„ë¥¼ ëœ»í•œë‹¤.<br/><br/>
#### ìŠ¤í”„ë§ì€ ë‹¤ìŒê³¼ ê°™ì€ ë‹¤ì–‘í•œ ìŠ¤ì½”í”„ë¥¼ ì§€ì›í•œë‹¤.
- **ì‹±ê¸€í†¤**: ê¸°ë³¸ ìŠ¤ì½”í”„, ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì˜ ì‹œì‘ê³¼ ì¢…ë£Œê¹Œì§€ ìœ ì§€ë˜ëŠ” ê°€ì¥ ë„“ì€ ë²”ìœ„ì˜ ìŠ¤ì½”í”„ì´ë‹¤.
- **í”„ë¡œí† íƒ€ì…**: ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” í”„ë¡œí† íƒ€ì… ë¹ˆì˜ ìƒì„±ê³¼ ì˜ì¡´ê´€ê³„ ì£¼ì…ê¹Œì§€ë§Œ ê´€ì—¬í•˜ê³  ë”ëŠ” ê´€ë¦¬í•˜ì§€ ì•ŠëŠ” ë§¤ìš° ì§§ì€ ë²”ìœ„ì˜ ìŠ¤ì½”í”„ì´ë‹¤.
- **ì›¹ ê´€ë ¨ ìŠ¤ì½”í”„**
  - **request**: ì›¹ ìš”ì²­ì´ ë“¤ì–´ì˜¤ê³  ë‚˜ê°ˆë•Œ ê¹Œì§€ ìœ ì§€ë˜ëŠ” ìŠ¤ì½”í”„ì´ë‹¤.
  - **session**: ì›¹ ì„¸ì…˜ì´ ìƒì„±ë˜ê³  ì¢…ë£Œë  ë•Œ ê¹Œì§€ ìœ ì§€ë˜ëŠ” ìŠ¤ì½”í”„ì´ë‹¤.
  - **application**: ì›¹ì˜ ì„œë¸”ë¦¿ ì»¨í…ìŠ¤íŠ¸ì™€ ê°™ì€ ë²”ìœ„ë¡œ ìœ ì§€ë˜ëŠ” ìŠ¤ì½”í”„ì´ë‹¤.
<br/><br/>
# ğŸ” í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„
ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ì—ì„œ í•­ìƒ ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•´ì„œ ë°˜í™˜í•œë‹¤.<br/><br/>
![image](https://github.com/jang9205/spring_study/assets/123082616/17c2d075-4557-4674-9273-9322de2519fa)
![image](https://github.com/jang9205/spring_study/assets/123082616/c8c845d8-5334-4a6f-acf5-0c21fc825187)<br/><br/>
ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” **í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìƒì„±í•˜ê³ , ì˜ì¡´ê´€ê³„ ì£¼ì…, ì´ˆê¸°í™”ê¹Œì§€ë§Œ ì²˜ë¦¬**í•œë‹¤.<br/>
í´ë¼ì´ì–¸íŠ¸ì— ë¹ˆì„ ë°˜í™˜í•˜ê³ , ì´í›„ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ìƒì„±ëœ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ê´€ë¦¬í•˜ì§€ ì•ŠëŠ”ë‹¤.<br/>
í”„ë¡œí† íƒ€ì… ë¹ˆì„ ê´€ë¦¬í•  ì±…ì„ì€ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ë°›ì€ í´ë¼ì´ì–¸íŠ¸ì— ìˆë‹¤.<br/>
ê·¸ë˜ì„œ @PreDestroy ê°™ì€ ì¢…ë£Œ ë©”ì„œë“œê°€ í˜¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤.<br/><br/>
#### í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ ë¹ˆ í…ŒìŠ¤íŠ¸
```java
public class PrototypeTest {

    @Test
    void prototypeBeanFind() {
        AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(PrototypeBean.class);
        System.out.println("find prototypeBean1");
        PrototypeBean prototypeBean1 = ac.getBean(PrototypeBean.class);
        System.out.println("find prototypeBean2");
        PrototypeBean prototypeBean2 = ac.getBean(PrototypeBean.class);
        System.out.println("prototypeBean1 = " + prototypeBean1);
        System.out.println("prototypeBean2 = " + prototypeBean2);
        assertThat(prototypeBean1).isNotSameAs(prototypeBean2);

        ac.close();
    }

    @Scope("prototype")
    static class PrototypeBean {

        @PostConstruct
        public void init() {
            System.out.println("PrototypeBean.init");
        }

        @PreDestroy
        public void destroy() {
            System.out.println("PrototypeBean.destroy");
        }
    }
}
```
<br/>![image](https://github.com/jang9205/spring_study/assets/123082616/446b1410-8b0a-4b80-bd7a-af2ee8c38619)<br/><br/>
ì‹±ê¸€í†¤ ë¹ˆì€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„± ì‹œì ì— ì´ˆê¸°í™” ë©”ì„œë“œê°€ ì‹¤í–‰ ë˜ì§€ë§Œ, í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ì˜ ë¹ˆì€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì—ì„œ ë¹ˆì„ ì¡°íšŒí•  ë•Œ ìƒì„±ë˜ê³ , ì´ˆê¸°í™” ë©”ì„œë“œë„ ì‹¤í–‰ëœë‹¤.<br/>
í”„ë¡œí† íƒ€ì… ë¹ˆì„ 2ë²ˆ ì¡°íšŒí–ˆìœ¼ë¯€ë¡œ ì™„ì „íˆ ë‹¤ë¥¸ ìŠ¤í”„ë§ ë¹ˆì´ ìƒì„±ë˜ê³ , ì´ˆê¸°í™”ë„ 2ë²ˆ ì‹¤í–‰ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br/><br/>
# ğŸ” í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ - ì‹±ê¸€í†¤ ë¹ˆê³¼ í•¨ê»˜ ì‚¬ìš©ì‹œ ë¬¸ì œì 
### í”„ë¡œí† íƒ€ì… ë¹ˆ ì§ì ‘ ìš”ì²­
```java
public class SingletonWithPrototypeTest1 {

    @Test
    void prototypeFind() {
        AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(PrototypeBean.class);
        PrototypeBean prototypeBean1 = ac.getBean(PrototypeBean.class);
        prototypeBean1.addCount();
        Assertions.assertThat(prototypeBean1.getCount()).isEqualTo(1);

        PrototypeBean prototypeBean2 = ac.getBean(PrototypeBean.class);
        prototypeBean2.addCount();
        Assertions.assertThat(prototypeBean2.getCount()).isEqualTo(1);
    }

    @Scope("prototype")
    static class PrototypeBean {
        private int count = 0;

        public void addCount() {
            count++;
        }

        public int getCount() {
            return count;
        }

        @PostConstruct
        public void init() {
            System.out.println("PrototypeBean.init" + this);
        }

        @PreDestroy
        public void destroy() {
            System.out.println("PrototypeBean.destroy");
        }
    }
}
```
<br/><br/>
### ì‹±ê¸€í†¤ ë¹ˆì—ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆ ì‚¬ìš©
![image](https://github.com/jang9205/spring_study/assets/123082616/f7ad4b36-9932-4cc4-98e1-42e7eebce626)<br/><br/>
![image](https://github.com/jang9205/spring_study/assets/123082616/a1071b1b-9b70-45a3-af06-47c301e85263)<br/><br/>
![image](https://github.com/jang9205/spring_study/assets/123082616/2f8caf07-ad13-4893-9372-2a4aab1bf4a5)
```java
public class SingletonWithPrototypeTest1 {

    @Test
    void singletonClientUsePrototype() {
        AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(ClientBean.class, PrototypeBean.class);

        ClientBean clientBean1 = ac.getBean(ClientBean.class);
        int count1 = clientBean1.logic();
        assertThat(count1).isEqualTo(1);

        ClientBean clientBean2 = ac.getBean(ClientBean.class);
        int count2 = clientBean2.logic();
        assertThat(count2).isEqualTo(2);

    }

    @Scope("singleton")
    static class ClientBean {
        private final PrototypeBean prototypeBean; //ìƒì„±ì‹œì ì— ì£¼ì…

        @Autowired
        public ClientBean(PrototypeBean prototypeBean) {
            this.prototypeBean = prototypeBean;
        }

        public int logic() {
            prototypeBean.addCount();
            int count = prototypeBean.getCount();
            return count;
        }
    }

    @Scope("prototype")
    static class PrototypeBean {

        ...

    }
}
```
í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì£¼ì… ì‹œì ì—ë§Œ ìƒˆë¡œ ìƒì„±í•˜ëŠ”ê²Œ ì•„ë‹ˆë¼, ì‚¬ìš©í•  ë•Œ ë§ˆë‹¤ ìƒˆë¡œ ìƒì„±í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì›í•œë‹¤.<br/><br/>
# ğŸ” í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ - ì‹±ê¸€í†¤ ë¹ˆê³¼ í•¨ê»˜ ì‚¬ìš©ì‹œ Providerë¡œ ë¬¸ì œ í•´ê²°
### ObjectFactory, ObjectProvider
ObjectProviderëŠ” ì§€ì •ëœ ë¹ˆì„ ì»¨í…Œì´ë„ˆì—ì„œ ëŒ€ì‹  ì°¾ì•„ì£¼ëŠ” **DL(Dependency** **Lookup)** ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•œë‹¤.
```java
    @Scope("singleton")
    static class ClientBean {

        @Autowired
        private ObjectProvider<PrototypeBean> prototypeBeanProvider;

        public int logic() {
            PrototypeBean prototypeBean = prototypeBeanProvider.getObject();
            prototypeBean.addCount();
            int count = prototypeBean.getCount();
            return count;
        }
    }
```
![image](https://github.com/jang9205/spring_study/assets/123082616/55ec3573-fb73-4a14-a61d-c95d187a1a04)<br/><br/>
prototypeBeanProvider.getObject()ë¥¼ í†µí•´ì„œ í•­ìƒ ìƒˆë¡œìš´ í”„ë¡œí† íƒ€ì… ë¹ˆì´ ìƒì„±ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br/>
ObjectProviderì˜ getObject()ë¥¼ í˜¸ì¶œí•˜ë©´ ë‚´ë¶€ì—ì„œëŠ” ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ í†µí•´ í•´ë‹¹ ë¹ˆì„ ì°¾ì•„ì„œ ë°˜í™˜í•œë‹¤.(DL)<br/><br/>
í•˜ì§€ë§Œ ObjectProviderëŠ” ìŠ¤í”„ë§ì— ì˜ì¡´ì ì´ë‹¤.<br/><br/>
### JSR-330 Provider
**jakarta.inject.Provider**ë¼ëŠ” JSR-330 ìë°” í‘œì¤€ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ë‹¤.<br/><br/>
jakarta.inject:jakarta.inject-api:2.0.1 ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ gradleì— ì¶”ê°€í•´ì•¼ í•œë‹¤.
```java
    @Scope("singleton")
    static class ClientBean {

        @Autowired
        private Provider<PrototypeBean> prototypeBeanProvider;

        public int logic() {
            PrototypeBean prototypeBean = prototypeBeanProvider.get();
            prototypeBean.addCount();
            int count = prototypeBean.getCount();
            return count;
        }
    }
```
![image](https://github.com/jang9205/spring_study/assets/123082616/d9c83c80-dd7e-4b76-8a25-618b4f8868f0)<br/><br/>
provider.get()ì„ í†µí•´ì„œ í•­ìƒ ìƒˆë¡œìš´ í”„ë¡œí† íƒ€ì… ë¹ˆì´ ìƒì„±ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br/>
providerì˜ get()ì„ í˜¸ì¶œí•˜ë©´ ë‚´ë¶€ì—ì„œëŠ” ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ í†µí•´ í•´ë‹¹ ë¹ˆì„ ì°¾ì•„ì„œ ë°˜í™˜í•œë‹¤.(DL)<br/>
ìë°” í‘œì¤€ì´ê³ , ê¸°ëŠ¥ì´ ë‹¨ìˆœí•˜ë¯€ë¡œ ë‹¨ìœ„í…ŒìŠ¤íŠ¸ë¥¼ ë§Œë“¤ê±°ë‚˜ mock ì½”ë“œë¥¼ ë§Œë“¤ê¸°ëŠ” í›¨ì”¬ ì‰¬ì›Œì§„ë‹¤.<br/><br/>
ObjectProvider, JSR330 Provider ë“±ì€ í”„ë¡œí† íƒ€ì… ë¿ë§Œ ì•„ë‹ˆë¼ DLì´ í•„ìš”í•œ ê²½ìš°ëŠ” ì–¸ì œë“ ì§€ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.<br/><br/>
# ğŸ” ì›¹ ìŠ¤ì½”í”„
#### ì›¹ ìŠ¤ì½”í”„ì˜ íŠ¹ì§•
- ì›¹ ìŠ¤ì½”í”„ëŠ” ì›¹ í™˜ê²½ì—ì„œë§Œ ë™ì‘í•œë‹¤.
- ì›¹ ìŠ¤ì½”í”„ëŠ” í”„ë¡œí† íƒ€ì…ê³¼ ë‹¤ë¥´ê²Œ ìŠ¤í”„ë§ì´ í•´ë‹¹ ìŠ¤ì½”í”„ì˜ ì¢…ë£Œì‹œì ê¹Œì§€ ê´€ë¦¬í•œë‹¤. ë”°ë¼ì„œ ì¢…ë£Œ ë©”ì„œë“œê°€ í˜¸ì¶œëœë‹¤.
<br/><br/>
#### ì›¹ ìŠ¤ì½”í”„ ì¢…ë¥˜
- **request**: HTTP ìš”ì²­ í•˜ë‚˜ê°€ ë“¤ì–´ì˜¤ê³  ë‚˜ê°ˆ ë•Œ ê¹Œì§€ ìœ ì§€ë˜ëŠ” ìŠ¤ì½”í”„, ê°ê°ì˜ HTTP ìš”ì²­ë§ˆë‹¤ ë³„ë„ì˜ ë¹ˆ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë˜ê³ , ê´€ë¦¬ëœë‹¤.
- **session**: HTTP Sessionê³¼ ë™ì¼í•œ ìƒëª…ì£¼ê¸°ë¥¼ ê°€ì§€ëŠ” ìŠ¤ì½”í”„
- **application**: ì„œë¸”ë¦¿ ì»¨í…ìŠ¤íŠ¸(ServletContext)ì™€ ë™ì¼í•œ ìƒëª…ì£¼ê¸°ë¥¼ ê°€ì§€ëŠ” ìŠ¤ì½”í”„
- **websocket**: ì›¹ ì†Œì¼“ê³¼ ë™ì¼í•œ ìƒëª…ì£¼ê¸°ë¥¼ ê°€ì§€ëŠ” ìŠ¤ì½”í”„
<br/><br/>![image](https://github.com/jang9205/spring_study/assets/123082616/b6171e1f-cf07-409f-b140-6d482715f834)<br/><br/>
# ğŸ” request ìŠ¤ì½”í”„ ì˜ˆì œ ë§Œë“¤ê¸°
### ì›¹ í™˜ê²½ ì¶”ê°€
ì›¹ ìŠ¤ì½”í”„ëŠ” ì›¹ í™˜ê²½ì—ì„œë§Œ ë™ì‘í•œë‹¤. web í™˜ê²½ì´ ë™ì‘í•˜ë„ë¡ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¶”ê°€í•´ì•¼ í•œë‹¤.
- org.springframework.boot:spring-boot-starter-web ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ gradleì— ì¶”ê°€í•œë‹¤.<br/><br/>
`src/main/java/hello.core/CoreApplication`ë¥¼ ì‹¤í–‰í•˜ë©´ í†°ì¼“ ë‚´ì¥ ì„œë²„ê°€ ì—´ë¦¬ê³ <br/>
[http://localhost:8080/](http://localhost:8080/)ì— ë“¤ì–´ê°€ë©´ ë‹¤ìŒê³¼ ê°™ì´ í™”ë©´ì´ ëœ¬ë‹¤.
<br/><br/>![image](https://github.com/jang9205/spring_study/assets/123082616/3bb21218-eca8-4f26-8404-56799d769887)<br/><br/>
### request ìŠ¤ì½”í”„ ì˜ˆì œ ê°œë°œ
ë™ì‹œì— ì—¬ëŸ¬ HTTP ìš”ì²­ì´ ì˜¤ë©´ ì •í™•íˆ ì–´ë–¤ ìš”ì²­ì´ ë‚¨ê¸´ ë¡œê·¸ì¸ì§€ êµ¬ë¶„í•˜ê¸° ì–´ë µë‹¤.<br/>
ì´ëŸ´ë•Œ ì‚¬ìš©í•˜ê¸° ë”± ì¢‹ì€ê²ƒì´ ë°”ë¡œ request ìŠ¤ì½”í”„ì´ë‹¤.<br/><br/>
`src/main/java/hello.core/common/MyLogger`
```java
@Component
@Scope(value = "request")
public class MyLogger {

    private String uuid;
    private String requestURL;

    public void setRequestURL(String requestURL) {
        this.requestURL = requestURL;
    }

    public void log(String message) {
        System.out.println("[" + uuid + "]" + "[" + requestURL + "] " + message);
    }

    @PostConstruct
    public void init() {
        uuid = UUID.randomUUID().toString();
        System.out.println("[" + uuid + "] request scope bean create : " + this);
    }

    @PreDestroy
    public void close() {
        System.out.println("[" + uuid + "] request scope bean close : " + this);
    }
}
```
ë¡œê·¸ë¥¼ ì¶œë ¥í•˜ê¸° ìœ„í•œ MyLogger í´ë˜ìŠ¤ì´ë‹¤.<br/>
@Scope(value = "request")ë¥¼ ì‚¬ìš©í•´ì„œ request ìŠ¤ì½”í”„ë¡œ ì§€ì •í–ˆê³ , ì´ ë¹ˆì€ HTTP ìš”ì²­ ë‹¹ í•˜ë‚˜ì”© ìƒì„±ë˜ê³ , HTTP ìš”ì²­ì´ ëë‚˜ëŠ” ì‹œì ì— ì†Œë©¸ëœë‹¤.<br/>
ë¹ˆì´ ìƒì„±ë˜ëŠ” ì‹œì ì— ìë™ìœ¼ë¡œ @PostConstruct ì´ˆê¸°í™” ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ì„œ uuidë¥¼ ìƒì„±í•´ì„œ ì €ì¥í•´ë‘”ë‹¤.<br/>
requestURLì€ ì´ ë¹ˆì´ ìƒì„±ë˜ëŠ” ì‹œì ì—ëŠ” ì•Œ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ, ì™¸ë¶€ì—ì„œ setterë¡œ ì…ë ¥ ë°›ëŠ”ë‹¤.<br/><br/>
`src/main/java/hello.core/web/LogDemoController`
```java
@Controller
@RequiredArgsConstructor
public class LogDemoController {

    private final LogDemoService logDemoService;
    private final MyLogger myLogger;

    @RequestMapping("log-demo")
    @ResponseBody
    public String logDemo(HttpServletRequest request) {
        String requestURL = request.getRequestURI().toString();
        myLogger.setRequestURL(requestURL);

        myLogger.log("controller test");
        logDemoService.logic("testId");
        return "OK";
    }
}
```
ë¡œê±°ê°€ ì˜ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” í…ŒìŠ¤íŠ¸ìš© ì»¨íŠ¸ë¡¤ëŸ¬ë‹¤.<br/>
HttpServletRequestë¥¼ í†µí•´ì„œ ìš”ì²­ URLì„ ë°›ê³ , myLoggerì— ì €ì¥í•´ë‘”ë‹¤.<br/><br/>
`src/main/java/hello.core/web/LogDemoService`
```java
@Service
@RequiredArgsConstructor
public class LogDemoService {

    private final MyLogger myLogger;

    public void logic(String id) {
        myLogger.log("service id = " + id);
    }
}
```
ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ìˆëŠ” ì„œë¹„ìŠ¤ ê³„ì¸µì—ì„œë„ ë¡œê·¸ë¥¼ ì¶œë ¥í•´ë³´ì.<br/><br/>
ì„œë¹„ìŠ¤ ê³„ì¸µì€ ì›¹ ê¸°ìˆ ì— ì¢…ì†ë˜ì§€ ì•Šê³ , ê°€ê¸‰ì  ìˆœìˆ˜í•˜ê²Œ ìœ ì§€í•˜ëŠ” ê²ƒì´ ìœ ì§€ë³´ìˆ˜ ê´€ì ì—ì„œ ì¢‹ë‹¤.<br/>
request scopeì˜ MyLogger ë•ë¶„ì— requestURL ê°™ì€ ì›¹ê³¼ ê´€ë ¨ëœ ì •ë³´ë¥¼ ì„œë¹„ìŠ¤ ê³„ì¸µì— íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê¸°ì§€ ì•Šê³ , MyLoggerì˜ ë©¤ë²„ë³€ìˆ˜ì— ì €ì¥í•´ì„œ ì½”ë“œì™€ ê³„ì¸µì„ ê¹”ë”í•˜ê²Œ ìœ ì§€í•  ìˆ˜ ìˆë‹¤.<br/><br/>
<br/><br/>![image](https://github.com/jang9205/spring_study/assets/123082616/0d7f6e1a-00b4-4462-90ef-bd615206dbed)<br/>
í•˜ì§€ë§Œ ìŠ¤í”„ë§ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰ ì‹œí‚¤ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.<br/>
ìŠ¤í”„ë§ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ëŠ” ì‹œì ì— ì‹±ê¸€í†¤ ë¹ˆì€ ìƒì„±í•´ì„œ ì£¼ì…ì´ ê°€ëŠ¥í•˜ì§€ë§Œ, request ìŠ¤ì½”í”„ ë¹ˆì€ ìƒì„±ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì´ë‹¤. request ìŠ¤ì½”í”„ ë¹ˆì€ HTTP ìš”ì²­ì´ ì™€ì•¼ ìƒì„±ëœë‹¤.<br/><br/>
# ğŸ” ìŠ¤ì½”í”„ì™€ Provider
ìœ„ì˜ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ObjectProviderë¥¼ ì‚¬ìš©í•œë‹¤.<br/><br/>
`src/main/java/hello.core/web/LogDemoController`
```java
@Controller
@RequiredArgsConstructor
public class LogDemoController {

    private final LogDemoService logDemoService;
    private final ObjectProvider<MyLogger> myLoggerProvider;

    @RequestMapping("log-demo")
    @ResponseBody
    public String logDemo(HttpServletRequest request) {
        String requestURL = request.getRequestURI().toString();
        MyLogger myLogger = myLoggerProvider.getObject();
        myLogger.setRequestURL(requestURL);

        myLogger.log("controller test");
        logDemoService.logic("testId");
        return "OK";
    }
}
```
`src/main/java/hello.core/web/LogDemoService`
```java
@Service
@RequiredArgsConstructor
public class LogDemoService {

    private final ObjectProvider<MyLogger> myLoggerProvider;

    public void logic(String id) {
        MyLogger myLogger = myLoggerProvider.getObject();
        myLogger.log("service id = " + id);
    }
}
```
ìŠ¤í”„ë§ì„ ì‹¤í–‰í•˜ê³ , [http://localhost:8080/log-demo](http://localhost:8080/log-demo)ì— ë“¤ì–´ê°€ë©´ ì˜ ì‘ë™í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br/><br/>
![image](https://github.com/jang9205/spring_study/assets/123082616/f97b39b3-06d2-443a-8cee-9d0f7f57c7a7)<br/>
ObjectProvider ë•ë¶„ì— ObjectProvider.getObject()ë¥¼ í˜¸ì¶œí•˜ëŠ” ì‹œì ê¹Œì§€ request scope ë¹ˆì˜ ìƒì„±ì„ ì§€ì—°í•  ìˆ˜ ìˆë‹¤.<br/>
ObjectProvider.getObject()ë¥¼ í˜¸ì¶œí•˜ì‹œëŠ” ì‹œì ì—ëŠ” HTTP ìš”ì²­ì´ ì§„í–‰ì¤‘ì´ë¯€ë¡œ request scope ë¹ˆì˜ ìƒì„±ì´ ì •ìƒ ì²˜ë¦¬ëœë‹¤.<br/><br/>
# ğŸ” ìŠ¤ì½”í”„ì™€ í”„ë¡ì‹œ
`src/main/java/hello.core/common/MyLogger`
```java
@Component
@Scope(value = "request", proxyMode = ScopedProxyMode.TARGET_CLASS)
public class MyLogger {
```
ì ìš© ëŒ€ìƒì´ í´ë˜ìŠ¤ë©´ TARGET_CLASS, ì¸í„°í˜ì´ìŠ¤ë©´ INTERFACESë¡œ ì‘ì„±í•œë‹¤.<br/>
ì´ë ‡ê²Œ í•˜ë©´ MyLoggerì˜ ê°€ì§œ í”„ë¡ì‹œ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ë‘ê³ , HTTP requestì™€ ìƒê´€ì—†ì´ ê°€ì§œ í”„ë¡ì‹œ í´ë˜ìŠ¤ë¥¼ ë‹¤ë¥¸ ë¹ˆì— ë¯¸ë¦¬ ì£¼ì…í•´ ë‘˜ ìˆ˜ ìˆë‹¤.<br/><br/>
`LogDemoController`, `LogDemoService`ì˜ ì½”ë“œëŠ” Provider ì‚¬ìš© ì´ì „ìœ¼ë¡œ ëŒë ¤ì¤€ë‹¤.<br/><br/>
### ì›¹ ìŠ¤ì½”í”„ì™€ í”„ë¡ì‹œ ë™ì‘ ì›ë¦¬
LogDemoControllerì— ì£¼ì…ëœ myloggerë¥¼ ì¶œë ¥í•´ë³´ë©´<br/><br/>
![image](https://github.com/jang9205/spring_study/assets/123082616/0dc0adb4-11c6-4fc4-92e3-bffc534860b5)<br/>
CGLIBë¼ëŠ” ë°”ì´íŠ¸ì½”ë“œë¥¼ ì¡°ì‘í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•´ì„œ, MyLoggerë¥¼ ìƒì†ë°›ì€ **ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ë¥¼ ìƒì„±**í•œë‹¤.<br/>
ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ë¥¼ ë“±ë¡í•œë‹¤. ê·¸ë˜ì„œ ì˜ì¡´ê´€ê³„ ì£¼ì…ë„ ì´ ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ê°€ ì£¼ì…ëœë‹¤.<br/><br/>
![image](https://github.com/jang9205/spring_study/assets/123082616/a7b3b9b1-9866-469b-b886-7cd7e7e878cd)<br/>
ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ëŠ” ì‹¤ì œ ìš”ì²­ì´ ì˜¤ë©´ ê·¸ë•Œ ë‚´ë¶€ì—ì„œ ì‹¤ì œ ë¹ˆì„ ìš”ì²­í•˜ëŠ” ìœ„ì„ ë¡œì§ì´ ë“¤ì–´ ìˆë‹¤.<br/>
ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ëŠ” ì›ë³¸ í´ë˜ìŠ¤ë¥¼ ìƒì† ë°›ì•„ì„œ ë§Œë“¤ì–´ì¡Œê¸° ë•Œë¬¸ì— ì´ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ ì…ì¥ì—ì„œëŠ” ì›ë³¸ì¸ì§€ ì•„ë‹Œì§€ë„ ëª¨ë¥´ê²Œ, ë™ì¼í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.(ë‹¤í˜•ì„±)<br/>
ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ëŠ” ì‹¤ì œ request scopeì™€ëŠ” ê´€ê³„ê°€ ì—†ë‹¤. ê·¸ëƒ¥ ê°€ì§œì´ê³ , ë‚´ë¶€ì— ë‹¨ìˆœí•œ ìœ„ì„ ë¡œì§ë§Œ ìˆê³ , ì‹±ê¸€í†¤ì²˜ëŸ¼ ë™ì‘í•œë‹¤.<br/><br/>
**Providerë¥¼ ì‚¬ìš©í•˜ë“ , í”„ë¡ì‹œë¥¼ ì‚¬ìš©í•˜ë“  í•µì‹¬ ì•„ì´ë””ì–´ëŠ” ì§„ì§œ ê°ì²´ ì¡°íšŒë¥¼ ê¼­ í•„ìš”í•œ ì‹œì ê¹Œì§€ ì§€ì—°ì²˜ë¦¬ í•œë‹¤ëŠ” ì ì´ë‹¤.**
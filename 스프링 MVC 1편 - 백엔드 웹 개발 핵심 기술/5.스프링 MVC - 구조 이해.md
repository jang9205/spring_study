# ğŸ“– ìŠ¤í”„ë§ MVC - êµ¬ì¡° ì´í•´
<br/><br/>
# ğŸ” ìŠ¤í”„ë§ MVC ì „ì²´ êµ¬ì¡°
### SpringMVC êµ¬ì¡°
![image](https://github.com/jang9205/spring_study/assets/123082616/dc52e8c3-8320-442b-8fac-ad17f7fd929b)<br/>
1. **í•¸ë“¤ëŸ¬ ì¡°íšŒ**: í•¸ë“¤ëŸ¬ ë§¤í•‘ì„ í†µí•´, ìš”ì²­ URLì— ë§¤í•‘ëœ í•¸ë“¤ëŸ¬(ì»¨íŠ¸ë¡¤ëŸ¬)ë¥¼ ì¡°íšŒ
2. **í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„° ì¡°íšŒ**: í•¸ë“¤ëŸ¬(ì»¨íŠ¸ë¡¤ëŸ¬)ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ë¥¼ ì¡°íšŒ
3. **í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„° ì‹¤í–‰**: í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„° ì‹¤í–‰
4. **í•¸ë“¤ëŸ¬ ì‹¤í–‰**: í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ê°€ ì‹¤ì œ í•¸ë“¤ëŸ¬(ì»¨íŠ¸ë¡¤ëŸ¬)ë¥¼ ì‹¤í–‰
5. **ModelAndView ë°˜í™˜**: í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ëŠ” í•¸ë“¤ëŸ¬(ì»¨íŠ¸ë¡¤ëŸ¬)ê°€ ë°˜í™˜í•˜ëŠ” ì •ë³´ë¥¼ ModelAndViewë¡œ ë³€í™˜í•´ì„œ ë°˜í™˜
6. **viewResolver í˜¸ì¶œ**: ë·° ë¦¬ì¡¸ë²„ë¥¼ ì°¾ê³  ì‹¤í–‰
7. **View ë°˜í™˜**: ë·°ì˜ ë…¼ë¦¬ ì´ë¦„ì„ ë¬¼ë¦¬ ì´ë¦„ìœ¼ë¡œ ë°”ê¾¸ê³ , ë Œë”ë§ ì—­í• ì„ ë‹´ë‹¹í•˜ëŠ” ë·° ê°ì²´ë¥¼ ë°˜í™˜
8. **ë·° ë Œë”ë§**: ë·°ë¥¼ í†µí•´ì„œ ë·°ë¥¼ ë Œë”ë§
<br/><br/>
### DispatcherServlet êµ¬ì¡° ì‚´í´ë³´ê¸°
ìŠ¤í”„ë§ MVCë„ í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ íŒ¨í„´ìœ¼ë¡œ êµ¬í˜„ë˜ì–´ ìˆëŠ”ë°,<br/>
ìŠ¤í”„ë§ MVCì˜ í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ë°”ë¡œ **DispacherServlet**ì´ë‹¤.<br/><br/>
DispacherServletë„ ë¶€ëª¨ í´ë˜ìŠ¤ì—ì„œ HttpServletì„ ìƒì† ë°›ì•„ì„œ ì‚¬ìš©í•˜ê³ , ì„œë¸”ë¦¿ìœ¼ë¡œ ë™ì‘í•œë‹¤.<br/>
ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” DispacherServletì„ ì„œë¸”ë¦¿ìœ¼ë¡œ ìë™ìœ¼ë¡œ ë“±ë¡í•˜ë©´ì„œ **ëª¨ë“  ê²½ë¡œ**( urlPatterns="/" )ì— ëŒ€í•´ì„œ ë§¤í•‘í•œë‹¤.<br/><br/>
ë” ìì„¸í•œ ê²½ë¡œê°€ ìš°ì„ ìˆœìœ„ê°€ ë†’ì•„ì„œ ê¸°ì¡´ì— ë“±ë¡í•œ ì„œë¸”ë¦¿ë„ í•¨ê»˜ ë™ì‘í•œë‹¤.<br/><br/>
#### ìš”ì²­ íë¦„
ì„œë¸”ë¦¿ì´ í˜¸ì¶œë˜ë©´ HttpServletì´ ì œê³µí•˜ëŠ” service()ê°€ í˜¸ì¶œëœë‹¤.<br/>
FrameworkServlet.service()ë¥¼ ì‹œì‘ìœ¼ë¡œ ì—¬ëŸ¬ ë©”ì„œë“œê°€ í˜¸ì¶œë˜ë©´ì„œ DispacherServlet.doDispatch()ê°€ í˜¸ì¶œëœë‹¤.<br/><br/>
# ğŸ” í•¸ë“¤ëŸ¬ ë§¤í•‘ê³¼ í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°
ì§€ê¸ˆì€ ì „í˜€ ì‚¬ìš©í•˜ì§€ ì•Šì§€ë§Œ, ê³¼ê±°ì— ì£¼ë¡œ ì‚¬ìš©í–ˆë˜ ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ê°„ë‹¨í•œ ì»¨íŠ¸ë¡¤ëŸ¬(ì¸í„°í˜ì´ìŠ¤)ë¡œ í•¸ë“¤ëŸ¬ ë§¤í•‘ê³¼ ì–´ëŒ‘í„°ë¥¼ ì´í•´í•´ë³´ì.<br/><br/>
`src/main/java/hello/servlet/web/springmvc/old/OldController`
```java
import org.springframework.web.servlet.mvc.Controller;

@Component("/springmvc/old-controller")
public class OldController implements Controller {
    @Override
    public ModelAndView handleRequest(HttpServletRequest request, HttpServletResponse response) throws Exception {
        System.out.println("OldController.handleRequest");
        return null;
    }
}
```
ì´ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” `/springmvc/old-controller` ë¼ëŠ” ì´ë¦„ì˜ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡ë˜ì—ˆë‹¤.<br/>
ë¹ˆì˜ ì´ë¦„ìœ¼ë¡œ URLì„ ë§¤í•‘í•´ë³¸ë‹¤.<br/><br/>
ì‹¤í–‰: http://localhost:8080/springmvc/old-controller<br/>
í™”ë©´ì€ ì—†ì§€ë§Œ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.<br/><br/>
**ì´ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ì–´ë–»ê²Œ í˜¸ì¶œëì„ê¹Œ?** <br/><br/>
ì»¨íŠ¸ë¡¤ëŸ¬ê°€ í˜¸ì¶œë˜ë ¤ë©´ í•¸ë“¤ëŸ¬ ë§¤í•‘ì—ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì°¾ì„ ìˆ˜ ìˆì–´ì•¼ í•˜ê³ ,<br/>
ì°¾ì€ ì»¨íŠ¸ë¡¤ëŸ¬(í•¸ë“¤ëŸ¬)ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ê°€ í•„ìš”í•˜ë‹¤.<br/><br/>
ìŠ¤í”„ë§ì€ ì´ë¯¸ í•„ìš”í•œ í•¸ë“¤ëŸ¬ ë§¤í•‘ê³¼ í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ë¥¼ ëŒ€ë¶€ë¶„ êµ¬í˜„í•´ë‘ì—ˆê¸° ë•Œë¬¸ì— í˜¸ì¶œì´ ë˜ì—ˆë‹¤.<br/>
ê°œë°œìê°€ ì§ì ‘ í•¸ë“¤ëŸ¬ ë§¤í•‘ê³¼ í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ë¥¼ ë§Œë“œëŠ” ì¼ì€ ê±°ì˜ ì—†ë‹¤.<br/><br/>
### ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ ìë™ ë“±ë¡í•˜ëŠ” í•¸ë“¤ëŸ¬ ë§¤í•‘ê³¼ í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°
#### HandlerMapping
```
0 = RequestMappingHandlerMapping : ì• ë…¸í…Œì´ì…˜ ê¸°ë°˜ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ì¸ @RequestMappingì—ì„œ ì‚¬ìš©
1 = BeanNameUrlHandlerMapping : ìŠ¤í”„ë§ ë¹ˆì˜ ì´ë¦„ìœ¼ë¡œ í•¸ë“¤ëŸ¬ë¥¼ ì°¾ìŒ
```
#### HandlerAdapter
```
0 = RequestMappingHandlerAdapter : ì• ë…¸í…Œì´ì…˜ ê¸°ë°˜ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ì¸ @RequestMappingì—ì„œ ì‚¬ìš©
1 = HttpRequestHandlerAdapter : HttpRequestHandler ì²˜ë¦¬
2 = SimpleControllerHandlerAdapter : Controller ì¸í„°í˜ì´ìŠ¤(ì• ë…¸í…Œì´ì…˜X, ê³¼ê±°ì— ì‚¬ìš©) ì²˜ë¦¬
```
í•¸ë“¤ëŸ¬ ë§¤í•‘ê³¼ í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ë¥¼ ëª¨ë‘ ìˆœì„œëŒ€ë¡œ ì°¾ê³  ë§Œì•½ ì—†ìœ¼ë©´ ë‹¤ìŒ ìˆœì„œë¡œ ë„˜ì–´ê°„ë‹¤.<br/><br/>
OldControllerë¥¼ ì‹¤í–‰í•˜ë©´ì„œ ì‚¬ìš©ëœ ê°ì²´ëŠ” **BeanNameUrlHandlerMapping**,  **SimpleControllerHandlerAdapter**ì´ë‹¤.<br/><br/>
# ğŸ” ë·° ë¦¬ì¡¸ë²„
ë·° ë¦¬ì¡¸ë²„ì— ëŒ€í•´ì„œ ìì„¸íˆ ì•Œì•„ë³´ê¸° ìœ„í•´, Viewë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë„ë¡ ë³€ê²½í•œë‹¤.<br/><br/>
`src/main/java/hello/servlet/web/springmvc/old/OldController`
```java
@Override
public ModelAndView handleRequest(HttpServletRequest request, HttpServletResponse response) throws Exception {
    System.out.println("OldController.handleRequest");
    return new ModelAndView("new-form");
    }
```
<br/><br/>
`src/main/resources/application.properties`
```
spring.mvc.view.prefix=/WEB-INF/views/
spring.mvc.view.suffix=.jsp
```
<br/><br/>ì‹¤í–‰: http://localhost:8080/springmvc/old-controller
<br/><br/>ì •ìƒì ìœ¼ë¡œ form í™”ë©´ì´ ë³´ì¸ë‹¤.<br/><br/>
ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” **InternalResourceViewResolver** ë¼ëŠ” **ë·° ë¦¬ì¡¸ë²„**ë¥¼ ìë™ìœ¼ë¡œ ë“±ë¡í•˜ëŠ”ë°,<br/>
ì´ë•Œ `application.properties`ì— ë“±ë¡í•œ spring.mvc.view.prefix, spring.mvc.view.suffix ì„¤ì • ì •ë³´ë¥¼ ì‚¬ìš©í•´ì„œ ë“±ë¡í•œë‹¤.<br/><br/>
### ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ ìë™ ë“±ë¡í•˜ëŠ” ë·° ë¦¬ì¡¸ë²„
```
1 = BeanNameViewResolver : ë¹ˆ ì´ë¦„ìœ¼ë¡œ ë·°ë¥¼ ì°¾ì•„ì„œ ë°˜í™˜(ì˜ˆ: ì—‘ì…€ íŒŒì¼ ìƒì„± ê¸°ëŠ¥ì— ì‚¬ìš©)
2 = InternalResourceViewResolver : JSPë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ë·°ë¥¼ ë°˜í™˜
```
<br/><br/>
# ğŸ” ìŠ¤í”„ë§ MVC - ì‹œì‘í•˜ê¸°
@RequestMapping ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ë§¤ìš° ìœ ì—°í•˜ê³  ì‹¤ìš©ì ì´ë‹¤.<br/><br/>
@RequestMapping ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•  ë•Œ<br/>
ê°€ì¥ ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ í•¸ë“¤ëŸ¬ ë§¤í•‘ê³¼ í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ëŠ” **RequestMappingHandlerMapping**, **RequestMappingHandlerAdapter**ì´ë‹¤.<br/><br/>
### ì»¨íŠ¸ë¡¤ëŸ¬ ìƒì„±
`src/main/java/hello/servlet/web/springmvc/v1/SpringMemberFormControllerV1`
```java
@Controller
public class SpringMemberFormControllerV1 {

    @RequestMapping("/springmvc/v1/members/new-form")
    public ModelAndView process() {
        return new ModelAndView("new-form");
    }
}
```
- @Controller : 
  - ìŠ¤í”„ë§ì´ ìë™ìœ¼ë¡œ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡í•œë‹¤.
  - ìŠ¤í”„ë§ MVCì—ì„œ ì• ë…¸í…Œì´ì…˜ ê¸°ë°˜ ì»¨íŠ¸ë¡¤ëŸ¬ë¡œ ì¸ì‹í•œë‹¤.
- @RequestMapping :
  - ìš”ì²­ ì •ë³´ë¥¼ ë§¤í•‘í•œë‹¤.
  - í•´ë‹¹ URLì´ í˜¸ì¶œë˜ë©´ ì´ ë©”ì„œë“œê°€ í˜¸ì¶œëœë‹¤.
  - ì• ë…¸í…Œì´ì…˜ì„ ê¸°ë°˜ìœ¼ë¡œ ë™ì‘í•˜ê¸° ë•Œë¬¸ì—, ë©”ì„œë“œì˜ ì´ë¦„ì€ ì„ì˜ë¡œ ì§€ìœ¼ë©´ ëœë‹¤.
- ModelAndView :
  - ëª¨ë¸ê³¼ ë·° ì •ë³´ë¥¼ ë‹´ì•„ì„œ ë°˜í™˜í•˜ë©´ ëœë‹¤.
##### 
`src/main/java/hello/servlet/web/springmvc/v1/SpringMemberSaveControllerV1`
```java
@Controller
public class SpringMemberSaveControllerV1 {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @RequestMapping("/springmvc/v1/members/save")
    public ModelAndView process(HttpServletRequest request, HttpServletResponse response) {
        String username = request.getParameter("username");
        int age = Integer.parseInt(request.getParameter("age"));

        Member member = new Member(username, age);
        memberRepository.save(member);

        ModelAndView mv = new ModelAndView("save-result");
        mv.addObject("member", member);
        return mv;
    }
}
```
ModelAndViewë¥¼ í†µí•´ Model ë°ì´í„°ë¥¼ ì¶”ê°€í•  ë•ŒëŠ” `addObject()`ë¥¼ ì‚¬ìš©í•œë‹¤.<br/><br/>
`SpringMemberListControllerV1` ì»¨íŠ¸ë¡¤ëŸ¬ë„ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ë§Œë“ ë‹¤.<br/><br/>
ì‹¤í–‰: http://localhost:8080/springmvc/v1/members/new-form<br/><br/>
íšŒì› ë“±ë¡ í¼, íšŒì› ì €ì¥, íšŒì› ëª©ë¡ ì¡°íšŒê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤.<br/><br/>
# ğŸ” ìŠ¤í”„ë§ MVC - ì»¨íŠ¸ë¡¤ëŸ¬ í†µí•©
`@RequestMapping`ì„ ì˜ ë³´ë©´ í´ë˜ìŠ¤ ë‹¨ìœ„ê°€ ì•„ë‹ˆë¼ **ë©”ì„œë“œ ë‹¨ìœ„**ì— ì ìš©ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br/>
ë”°ë¼ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ í´ë˜ìŠ¤ë¥¼ ìœ ì—°í•˜ê²Œ í•˜ë‚˜ë¡œ í†µí•©í•  ìˆ˜ ìˆë‹¤.<br/><br/>
`src/main/java/hello/servlet/web/springmvc/v2/SpringMemberControllerV2`
```java
@Controller
@RequestMapping("/springmvc/v2/members")
public class SpringMemberControllerV2 {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @RequestMapping("/new-form")
    public ModelAndView newForm() {
        return new ModelAndView("new-form");
    }

    @RequestMapping("/save")
    public ModelAndView save(HttpServletRequest request, HttpServletResponse response) {
        String username = request.getParameter("username");
        int age = Integer.parseInt(request.getParameter("age"));

        Member member = new Member(username, age);
        memberRepository.save(member);

        ModelAndView mv = new ModelAndView("save-result");
        mv.addObject("member", member);
        return mv;
    }

    @RequestMapping
    public ModelAndView members() {

        List<Member> members = memberRepository.findAll();

        ModelAndView mv = new ModelAndView("members");
        mv.addObject("members", members);
        return mv;
    }
}
```
ì‹¤í–‰: http://localhost:8080/springmvc/v2/members/new-form<br/><br/>
íšŒì› ë“±ë¡ í¼, íšŒì› ì €ì¥, íšŒì› ëª©ë¡ ì¡°íšŒê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤.<br/><br/>
# ğŸ” ìŠ¤í”„ë§ MVC - ì‹¤ìš©ì ì¸ ë°©ì‹
`src/main/java/hello/servlet/web/springmvc/v3/SpringMemberControllerV3`
```java
    @GetMapping("/new-form")
    public String newForm() {
        return "new-form";
    }
```
ìŠ¤í”„ë§ MVCëŠ” **HTTP Method**ë¥¼ êµ¬ë¶„í•  ìˆ˜ ìˆê²Œ Get, Post, Put, Delete, Patchì— ëŒ€í•œ ì• ë…¸í…Œì´ì…˜ì´ ìˆë‹¤.<br/>
í•´ë‹¹ ë©”ì„œë“œì˜ HTTP MethodëŠ” GETì´ë¯€ë¡œ **@GetMapping**ì„ ì‚¬ìš©í•´ì¤€ë‹¤.<br/><br/>
ë˜í•œ ë²ˆê±°ë¡­ê²Œ ModelAndView ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ë°˜í™˜í•  í•„ìš” ì—†ì´<br/>
ë·°ì˜ ë…¼ë¦¬ ì´ë¦„ì¸ **ViewNameì„ ì§ì ‘ ë°˜í™˜**í•  ìˆ˜ ìˆë‹¤.<br/><br/>
```java
    @PostMapping("/save")
    public String save(
            @RequestParam("username") String username,
            @RequestParam("age") int age,
            Model model) {

        Member member = new Member(username, age);
        memberRepository.save(member);

        model.addAttribute("member", member);
        return "save-result";
    }
```
ìŠ¤í”„ë§ì€ HTTP ìš”ì²­ íŒŒë¼ë¯¸í„°ë¥¼ **@RequestParam**ìœ¼ë¡œ ë°›ì„ ìˆ˜ ìˆë‹¤.<br/>
@RequestParam("username")ì€ request.getParameter("username")ì™€ ê±°ì˜ ê°™ì€ ì½”ë“œë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤.<br/>
GET ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°, POST Form ë°©ì‹ì„ ëª¨ë‘ ì§€ì›í•œë‹¤.<br/><br/>
ë˜í•œ Modelì„ íŒŒë¼ë¯¸í„°ë¡œ ë°›ì„ ìˆ˜ ìˆë‹¤.<br/><br/>
ì‹¤í–‰: http://localhost:8080/springmvc/v3/members/new-form<br/><br/>
íšŒì› ë“±ë¡ í¼, íšŒì› ì €ì¥, íšŒì› ëª©ë¡ ì¡°íšŒê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤.
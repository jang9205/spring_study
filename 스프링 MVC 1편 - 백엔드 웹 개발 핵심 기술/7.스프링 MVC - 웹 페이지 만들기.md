# ğŸ“– ìŠ¤í”„ë§ MVC - ì›¹ í˜ì´ì§€ ë§Œë“¤ê¸°
<br/><br/>
# ğŸ” í”„ë¡œì íŠ¸ ìƒì„±
[ìŠ¤í”„ë§ ë¶€íŠ¸ ìŠ¤íƒ€í„°](https://start.spring.io/)ì—ì„œ ìŠ¤í”„ë§ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•œë‹¤.<br/><br/>
![image](https://github.com/jang9205/spring_study/assets/123082616/bb0a3480-f933-4a6e-ab60-8f3f59548fe5)<br/><br/>
# ğŸ” ìš”êµ¬ì‚¬í•­ ë¶„ì„
ìƒí’ˆ ê´€ë¦¬ ì„œë¹„ìŠ¤ë¥¼ ë§Œë“¤ ê²ƒì´ë‹¤.<br/><br/>
### ì„œë¹„ìŠ¤ ì œê³µ íë¦„
![image](https://github.com/jang9205/spring_study/assets/123082616/ca63b0b1-a3a0-4363-8bc0-bdaf55315ea6)
- **ìƒí’ˆ ë„ë©”ì¸ ëª¨ë¸**
  - ìƒí’ˆ ID, ìƒí’ˆëª…, ê°€ê²©, ìˆ˜ëŸ‰
- **ìƒí’ˆ ê´€ë¦¬ ê¸°ëŠ¥**
  - ìƒí’ˆ ëª©ë¡, ìƒí’ˆ ìƒì„¸, ìƒí’ˆ ë“±ë¡, ìƒí’ˆ ìˆ˜ì •
<br/><br/>
# ğŸ” ìƒí’ˆ ë„ë©”ì¸ ê°œë°œ
### ìƒí’ˆ ê°ì²´ ìƒì„±
`src/main/java/hello/itemservice/domain/item/Item`
```java
@Data  //@Getter, @Setterë¥¼ í¬í•¨í•˜ëŠ” @Data ì• ë…¸í…Œì´ì…˜ ì‚¬ìš©
public class Item {

    private Long id;
    private String itemName;
    private Integer price;
    private Integer quantity;

    public Item() {
    }

    public Item(String itemName, Integer price, Integer quantity) {
        this.itemName = itemName;
        this.price = price;
        this.quantity = quantity;
    }
}
```
ìƒí’ˆ ID, ìƒí’ˆëª…, ê°€ê²©, ìˆ˜ëŸ‰ ë³€ìˆ˜ë¥¼ ë§Œë“¤ì–´ ì¤€ë‹¤.<br/>
intê°€ ì•„ë‹Œ Integerë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” null ê°’ë„ ë“¤ì–´ê°ˆ ìˆ˜ ìˆê²Œ í•˜ê¸° ìœ„í•´ì„œë‹¤.<br/><br/>
### ìƒí’ˆ ì €ì¥ì†Œ ìƒì„±
`src/main/java/hello/itemservice/domain/item/ItemRepository`
```java
@Repository
public class ItemRepository {

    private static final Map<Long, Item> store = new HashMap<>();   //ìƒí’ˆ ì •ë³´ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•œ HashMap
    private static long sequence = 0L;  //ìƒí’ˆì˜ ê³ ìœ í•œ IDë¥¼ ìƒì„±í•˜ê¸° ìœ„í•œ ìˆœì°¨ì ì¸ ê°’

    public Item save(Item item) {
        item.setId(++sequence);
        store.put(item.getId(), item);
        return item;
    }

    public Item findById(Long id) {
        return store.get(id);
    }

    public List<Item> findAll() {
        return new ArrayList<>(store.values());
    }

    public void update(Long itemId, Item updateParam) {
        Item findItem = findById(itemId);
        findItem.setItemName(updateParam.getItemName());
        findItem.setPrice(updateParam.getPrice());
        findItem.setQuantity(updateParam.getQuantity());
    }

    public void clearStore() {
        store.clear();
    }
}
```
ì €ì¥ì†Œì´ê¸° ë•Œë¬¸ì— @Repository ì• ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ì£¼ë©°,<br/>
ìƒí’ˆì„ ì €ì¥í•˜ëŠ” **save**, idë¡œ ìƒí’ˆ ì •ë³´ë¥¼ ì¡°íšŒí•˜ëŠ” **findById**, ì „ì²´ ìƒí’ˆ ì •ë³´ë¥¼ ì¡°íšŒí•´ì„œ ë¦¬ìŠ¤íŠ¸ë¡œ ë°˜í™˜í•˜ëŠ” **findAll**, idì™€ updateParam ê°ì²´ë¥¼ ë°›ì•„ì„œ ìƒí’ˆ ì •ë³´ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” **update**, ëª¨ë“  ìƒí’ˆ ì •ë³´ë¥¼ ì‚­ì œí•˜ëŠ” **clearStore** ë©”ì„œë“œë¥¼ ë§Œë“ ë‹¤.<br/><br/>
### ìƒí’ˆ ì €ì¥ì†Œ í…ŒìŠ¤íŠ¸
ìƒí’ˆ ì €ì¥ì†Œì—ì„œ ë§Œë“  ê¸°ëŠ¥ì´ ì œëŒ€ë¡œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” Test ì½”ë“œë¥¼ ë§Œë“ ë‹¤.<br/><br/>
`src/test/java/hello/itemservice/domain/item/ItemRepositoryTest`
```java
class ItemRepositoryTest {

    ItemRepository itemRepository = new ItemRepository();

    @AfterEach
    void afterEach() {
        itemRepository.clearStore();
    }

    @Test
    void save() {
        //given
        Item item = new Item("itemA", 10000, 10);

        //when
        Item savedItem = itemRepository.save(item);

        //then
        Item findItem = itemRepository.findById(item.getId());
        assertThat(findItem).isEqualTo(savedItem);
    }

    @Test
    void findAll() {
        //given
        Item item1 = new Item("item1", 10000, 10);
        Item item2 = new Item("item2", 20000, 20);

        itemRepository.save(item1);
        itemRepository.save(item2);

        //when
        List<Item> result = itemRepository.findAll();

        //then
        assertThat(result.size()).isEqualTo(2);
        assertThat(result).contains(item1, item2);
    }

    @Test
    void updateItem() {
        //given
        Item item = new Item("item1", 10000, 10);

        Item savedItem = itemRepository.save(item);
        Long itemId = savedItem.getId();

        //when
        Item updateParam = new Item("item2", 20000, 30);
        itemRepository.update(itemId, updateParam);

        //then
        Item findItem = itemRepository.findById(itemId);

        assertThat(findItem.getItemName()).isEqualTo(updateParam.getItemName());
        assertThat(findItem.getPrice()).isEqualTo(updateParam.getPrice());
        assertThat(findItem.getQuantity()).isEqualTo(updateParam.getQuantity());
    }
}
```
<br/><br/>
# ğŸ” ìƒí’ˆ ì„œë¹„ìŠ¤ HTML
ë¨¼ì € í•„ìš”í•œ ë¶€íŠ¸ìŠ¤íŠ¸ë© íŒŒì¼ì„ ì„¤ì¹˜í•œë‹¤.<br/>
https://getbootstrap.com/docs/5.0/getting-started/download/<br/><br/>
ì••ì¶•ì„ ì¶œê³  `bootstrap.min.css` íŒŒì¼ì„ ë³µì‚¬í•´ì„œ ë‹¤ìŒ í´ë”ì— ì¶”ê°€í•œë‹¤.<br/>
`src/main/resources/static/css`<br/><br/>
ê·¸ë¦¬ê³  ìƒí’ˆ ëª©ë¡(items.html), ìƒí’ˆ ìƒì„¸(item.html), ìƒí’ˆ ë“±ë¡ í¼(addForm.html), ìƒí’ˆ ìˆ˜ì • í¼(editForm.html) HTMLì„ ë§Œë“¤ì–´ ì¤€ë‹¤.<br/><br/>
![image](https://github.com/jang9205/spring_study/assets/123082616/35977eba-e48c-48b3-94e1-5cef32e88c09)<br/><br/>
# ğŸ” ìƒí’ˆ ëª©ë¡ - íƒ€ì„ë¦¬í”„
### ìƒí’ˆ ëª©ë¡ ì»¨íŠ¸ë¡¤ëŸ¬
`src/main/java/hello/itemservice/web/item/basic/BasicItemController`
```java
@Controller
@RequestMapping("/basic/items")
@RequiredArgsConstructor
public class BasicItemController {

    private final ItemRepository itemRepository;

    @GetMapping
    public String items(Model model) {
        List<Item> items = itemRepository.findAll();
        model.addAttribute("items", items); //modelì— itemsë¥¼ ë‹´ìŒ
        return "basic/items";   //ë·° í…œí”Œë¦¿ í˜¸ì¶œ
    }
```
@Controller: ë°˜í™˜ ê°’ì´ Stringì´ë©´ ë·° ì´ë¦„ìœ¼ë¡œ ì¸ì‹ë˜ì–´ì„œ ë·°ë¥¼ ì°¾ê³  ë·°ê°€ ëœë”ë§ ëœë‹¤.<br/>
@RequestMapping: ìš”ì²­ ì •ë³´ë¥¼ ë§¤í•‘í•œë‹¤. í•´ë‹¹ ì½”ë“œì—ì„œëŠ” í´ë˜ìŠ¤ ë‹¨ìœ„ì— ì ìš©ì‹œì¼°ë‹¤.<br/>
@RequiredArgsConstructor: í´ë˜ìŠ¤ ë‚´ë¶€ì— finalë¡œ ì„ ì–¸ëœ í•„ë“œë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ì¸ìê°€ ìˆëŠ” ìƒì„±ìë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•œë‹¤.<br/><br/>
ì¦‰, ì•„ë˜ì˜ ìƒì„±ìë¥¼ ìƒì„±í•œë‹¤.
```java
public BasicItemController(ItemRepository itemRepository) {
 this.itemRepository = itemRepository;
}
```
<br/><br/>
í…ŒìŠ¤íŠ¸ìš© ë°ì´í„°ë¥¼ ì¶”ê°€í•˜ì—¬ íšŒì› ëª©ë¡ ê¸°ëŠ¥ì´ ì •ìƒ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.
```java
    @PostConstruct
    public void init() {
        itemRepository.save(new Item("itemA", 10000, 10));
        itemRepository.save(new Item("itemB", 20000, 20));
    }
```
<br/><br/>
### ìƒí’ˆ ëª©ë¡ ë·° í…œí”Œë¦¿
`/resources/static/items.html` ê²½ë¡œì— ë§Œë“  ì •ì  htmlì„<br/>
`/resources/templates/basic/items.html` ê²½ë¡œì— ë·° í…œí”Œë¦¿(templates)ìœ¼ë¡œ ìˆ˜ì •í•´ì¤€ë‹¤.<br/><br/>
#### íƒ€ì„ë¦¬í”„ ì‚¬ìš© ì„ ì–¸
```html
<html xmlns:th="http://www.thymeleaf.org">
```
#### URL ë§í¬ í‘œí˜„ì‹(ì†ì„± ë³€ê²½ - th:href)
```html
    <link th:href="@{/css/bootstrap.min.css}"
            href="../css/bootstrap.min.css" rel="stylesheet">
```
HTMLì„ ê·¸ëŒ€ë¡œ ë³¼ ë•ŒëŠ” href ì†ì„±ì´ ì‚¬ìš©ë˜ê³ , ë·° í…œí”Œë¦¿ì„ ê±°ì¹˜ë©´ `th:href`ì˜ ê°’ì´ `href`ë¡œ ëŒ€ì²´ë˜ë©´ì„œ ë™ì ìœ¼ë¡œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.<br/>
íƒ€ì„ë¦¬í”„ëŠ” URL ë§í¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš° `@{...}`ë¥¼ ì‚¬ìš©í•œë‹¤. 
#### ìƒí’ˆ ë“±ë¡ í¼ìœ¼ë¡œ ì´ë™(ì†ì„± ë³€ê²½ - th:onclick)
```html
th:onclick="|location.href='@{/basic/items/add}'|"
```
ë¦¬í„°ëŸ´ ëŒ€ì²´ ë¬¸ë²•ì´ ì‚¬ìš©ë˜ì—ˆë‹¤.
#### ë°˜ë³µ ì¶œë ¥ - th:each
```html
<tr th:each="item : ${items}">
```
ëª¨ë¸ì— í¬í•¨ëœ `items` ì»¬ë ‰ì…˜ ë°ì´í„°ê°€ `item` ë³€ìˆ˜ì— í•˜ë‚˜ì”© í¬í•¨ë˜ê³ , ë°˜ë³µë¬¸ ì•ˆì—ì„œ `item` ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
#### URL ë§í¬ í‘œí˜„ì‹2
```html
th:href="@{/basic/items/{itemId}(itemId=${item.id})}"
```
ê²½ë¡œ ë³€ìˆ˜ê°€ ë“¤ì–´ê°„ URL ë§í¬ë„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.<br/>
ë˜í•œ, ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ê°€ ë“¤ì–´ê°„ URL ë§í¬ë„ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.
```html
<!--ìƒì„± ë§í¬: http://localhost:8080/basic/items/1?query=test-->
th:href="@{/basic/items/{itemId}(itemId=${item.id}, query='test')}"
```
#### ë‚´ìš© ë³€ê²½ - th:text
```html
<td th:text="${item.price}">10000</td>
```
ë‚´ìš©ì˜ ê°’ì„ `th:text`ì˜ ê°’ìœ¼ë¡œ ë³€ê²½í•œë‹¤.<br/>
ë˜í•œ ëª¨ë¸ì— ìˆëŠ” item ì •ë³´ë¥¼ í”„ë¡œí¼í‹° ì ‘ê·¼ë²•ìœ¼ë¡œ ì¶œë ¥í•œë‹¤.
<br/><br/>ì‹¤í–‰: http://localhost:8080/basic/items
<br/><br/>![image](https://github.com/jang9205/spring_study/assets/123082616/94ca7f4b-e3ee-4d2d-90bf-a4cd1eef30b1)<br/><br/>
# ğŸ” ìƒí’ˆ ìƒì„¸
### ìƒí’ˆ ìƒì„¸ ì»¨íŠ¸ë¡¤ëŸ¬
`src/main/java/hello/itemservice/web/item/basic/BasicItemController`
```java
    @GetMapping("/{itemId}")
    public String item(@PathVariable long itemId, Model model) {
        Item item = itemRepository.findById(itemId);
        model.addAttribute("item", item);
        return "basic/item";
    }
```
ê²½ë¡œ ë³€ìˆ˜ë¡œ ìƒí’ˆ idë¥¼ ë°›ì•„ì„œ ì €ì¥ì†Œì— ìˆëŠ” ìƒí’ˆì„ ì¡°íšŒí•œë‹¤.<br/><br/>
### ìƒí’ˆ ìƒì„¸ ë·° í…œí”Œë¦¿
`/resources/static/item.html` ê²½ë¡œì— ë§Œë“  ì •ì  htmlì„<br/>
`/resources/templates/basic/item.html` ê²½ë¡œì— ë·° í…œí”Œë¦¿(templates)ìœ¼ë¡œ ìˆ˜ì •í•´ì¤€ë‹¤.<br/><br/>
#### ì†ì„± ë³€ê²½ - th:value
```html
th:value="${item.id}"
```
ëª¨ë¸ì— ìˆëŠ” item ì •ë³´ë¥¼ í”„ë¡œí¼í‹° ì ‘ê·¼ë²•ìœ¼ë¡œ ì¶œë ¥í•œë‹¤.
#### ìƒí’ˆìˆ˜ì • ë§í¬
```html
th:onclick="|location.href='@{/basic/items/{itemId}/edit(itemId=${item.id})}'|"
```
#### ëª©ë¡ìœ¼ë¡œ ë§í¬
```html
th:onclick="|location.href='@{/basic/items}'|"
```
<br/><br/>ìƒí’ˆ ëª©ë¡ í˜ì´ì§€ì—ì„œ ìƒí’ˆì„ ì„ íƒí•˜ë©´ ì •ìƒì ìœ¼ë¡œ ìƒí’ˆ ìƒì„¸ í˜ì´ì§€ê°€ ë‚˜ì˜¨ë‹¤.<br/><br/>
![image](https://github.com/jang9205/spring_study/assets/123082616/626c973f-6b53-4293-8656-16df878daade)<br/><br/>
# ğŸ” ìƒí’ˆ ë“±ë¡ í¼
### ìƒí’ˆ ë“±ë¡ í¼ ì»¨íŠ¸ë¡¤ëŸ¬
`src/main/java/hello/itemservice/web/item/basic/BasicItemController`
```java
    @GetMapping("add")
    public String addForm() {
        return "basic/addForm";
    }
```
<br/><br/>
### ìƒí’ˆ ë“±ë¡ í¼ ë·° í…œí”Œë¦¿
`/resources/static/addForm.html` ê²½ë¡œì— ë§Œë“  ì •ì  htmlì„<br/>
`/resources/templates/basic/addForm.html` ê²½ë¡œì— ë·° í…œí”Œë¦¿(templates)ìœ¼ë¡œ ìˆ˜ì •í•´ì¤€ë‹¤.<br/><br/>
#### ì†ì„± ë³€ê²½ - th:action
```html
<form action="item.html" th:action method="post">
```
HTML formì—ì„œ `action`ì— ê°’ì´ ì—†ìœ¼ë©´ í˜„ì¬ URLì— ë°ì´í„°ë¥¼ ì „ì†¡í•œë‹¤.<br/><br/>
ìƒí’ˆ ë“±ë¡ í¼ì˜ URLê³¼ ì‹¤ì œ ìƒí’ˆ ë“±ë¡ì„ ì²˜ë¦¬í•˜ëŠ” URLì„ ë˜‘ê°™ì´ ë§ì¶”ê³  HTTP ë©”ì„œë“œë¡œ ë‘ ê¸°ëŠ¥ì„ êµ¬ë¶„í•œë‹¤.<br/>
ì´ë ‡ê²Œ í•˜ë©´ í•˜ë‚˜ì˜ URLë¡œ **ë“±ë¡ í¼**ê³¼, **ë“±ë¡ ì²˜ë¦¬**ë¥¼ ê¹”ë”í•˜ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.
- ìƒí’ˆ ë“±ë¡ í¼: GET `/basic/items/add`
- ìƒí’ˆ ë“±ë¡ ì²˜ë¦¬: POST `/basic/items/add`
#### ì·¨ì†Œ ë§í¬
```html
th:onclick="|location.href='@{/basic/items}'|"
```
<br/><br/>ì‹¤í–‰: http://localhost:8080/basic/items/add
<br/><br/>![image](https://github.com/jang9205/spring_study/assets/123082616/ea58cd05-a154-42de-83a6-0350bfab3ac4)<br/><br/>
ì •ìƒì ìœ¼ë¡œ ìƒí’ˆ ë“±ë¡ í¼ í˜ì´ì§€ê°€ ëœ¨ì§€ë§Œ ì•„ì§ ìƒí’ˆ ë“±ë¡ ê¸°ëŠ¥ì€ êµ¬í˜„í•˜ì§€ ì•Šì•˜ë‹¤.<br/><br/>
# ğŸ” ìƒí’ˆ ë“±ë¡ ì²˜ë¦¬ - @ModelAttribute
ì´ì œ ìƒí’ˆ ë“±ë¡ í¼ì—ì„œ ì „ë‹¬ëœ ë°ì´í„°ë¡œ ì‹¤ì œ ìƒí’ˆì„ ë“±ë¡ ì²˜ë¦¬í•  ê²ƒì´ë‹¤.<br/><br/>
**POST - HTML Form**
- `content-type: application/x-www-form-urlencoded`
- ë©”ì‹œì§€ ë°”ë””ì— ì¿¼ë¦¬ íŒŒë¦¬ë¯¸í„° í˜•ì‹ìœ¼ë¡œ ì „ë‹¬ `itemName=itemA&price=10000&quantity=10`
<br/><br/>
### ìƒí’ˆ ë“±ë¡ ì²˜ë¦¬ - @RequestParam ì‚¬ìš©
@RequestParam ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•´ì„œ ìš”ì²­ íŒŒë¼ë¯¸í„°ë¥¼ ë³€ìˆ˜ì— ë‹´ì•„ ìƒí’ˆ ë“±ë¡ ì²˜ë¦¬í•œë‹¤.<br/><br/>
`src/main/java/hello/itemservice/web/item/basic/BasicItemController`
```java
    @PostMapping("/add")
    public String addItemV1(@RequestParam String itemName,
                       @RequestParam int price,
                       @RequestParam Integer quantity,
                       Model model) {

        Item item = new Item();
        item.setItemName(itemName);
        item.setPrice(price);
        item.setQuantity(quantity);

        itemRepository.save(item);

        model.addAttribute("item", item);

        return "basic/item";
    }
```
<br/><br/>
### ìƒí’ˆ ë“±ë¡ ì²˜ë¦¬ - @ModelAttribute ì‚¬ìš©
ì´ë²ˆì—ëŠ” @ModelAttributeë¥¼ ì‚¬ìš©í•´ì„œ ê°„ë‹¨í•˜ê²Œ ì²˜ë¦¬í•´ë³´ì.<br/><br/>
```java
    @PostMapping("/add")
    public String addItemV2(@ModelAttribute("item") Item item) {
        itemRepository.save(item);
        return "basic/item";
    }
```
@ModelAttributeëŠ” Item ê°ì²´ë¥¼ ìƒì„±í•˜ê³ , ìš”ì²­ íŒŒë¼ë¯¸í„°ì˜ ê°’ì„ í”„ë¡œí¼í‹° ì ‘ê·¼ë²•(setXxx)ìœ¼ë¡œ ì…ë ¥í•´ì¤€ë‹¤.<br/>
@ModelAttributeëŠ” ì¤‘ìš”í•œ í•œê°€ì§€ ê¸°ëŠ¥ì´ ë” ìˆëŠ”ë°, ë°”ë¡œ ëª¨ë¸(Model)ì— @ModelAttributeë¡œ ì§€ì •í•œ ê°ì²´ë¥¼ ìë™ìœ¼ë¡œ ë„£ì–´ì¤€ë‹¤.<br/><br/>
ëª¨ë¸ì— ë„£ëŠ” ê°ì²´ì˜ ì´ë¦„ì€ @ModelAttributeì— ì§€ì •í•œ name(value) ì†ì„±ì„ ì‚¬ìš©í•œë‹¤.<br/><br/>
ë˜í•œ, @ModelAttributeì˜ ì´ë¦„ì„ ìƒëµí•  ìˆ˜ ìˆë‹¤.
```java
    @PostMapping("/add")
    public String addItemV3(@ModelAttribute Item item) {
        itemRepository.save(item);
        return "basic/item";
    }
```
@ModelAttributeì˜ ì´ë¦„ì„ ìƒëµí•˜ë©´ ëª¨ë¸ì— ì €ì¥ë  ë•Œ í´ë˜ìŠ¤ëª…ì„ ì‚¬ìš©í•œë‹¤.<br/>
ì´ë•Œ í´ë˜ìŠ¤ì˜ ì²«ê¸€ìë§Œ ì†Œë¬¸ìë¡œ ë³€ê²½í•´ì„œ ë“±ë¡í•œë‹¤.
- Item -> item
- HelloWorld -> helloWorld
#### 
ì•„ì˜ˆ @ModelAttributeë¥¼ ìƒëµí•  ìˆ˜ë„ ìˆë‹¤.
```java
    public String addItemV4(Item item) {
```
<br/><br/>
# ğŸ” ìƒí’ˆ ìˆ˜ì •
ìƒí’ˆ ìˆ˜ì •ì€ ìƒí’ˆ ë“±ë¡ê³¼ ì „ì²´ í”„ë¡œì„¸ìŠ¤ê°€ ìœ ì‚¬í•˜ë‹¤.
- GET /items/{itemId}/edit : ìƒí’ˆ ìˆ˜ì • í¼
- POST /items/{itemId}/edit : ìƒí’ˆ ìˆ˜ì • ì²˜ë¦¬
### ìƒí’ˆ ìˆ˜ì • í¼ ì»¨íŠ¸ë¡¤ëŸ¬
`src/main/java/hello/itemservice/web/item/basic/BasicItemController`
```java
    @GetMapping("/{itemId}/edit")
    public String editForm(@PathVariable Long itemId, Model model) {
        Item item = itemRepository.findById(itemId);
        model.addAttribute("item", item);
        return "basic/editForm";
    }
```
ê²½ë¡œ ë³€ìˆ˜ë¡œ ìƒí’ˆ idë¥¼ ë°›ì•„ì„œ ì •ë³´ë¥¼ ì¡°íšŒí•œë‹¤.<br/><br/>
### ìƒí’ˆ ìˆ˜ì • í¼ ë·° í…œí”Œë¦¿
`/resources/static/editForm.html` ê²½ë¡œì— ë§Œë“  ì •ì  htmlì„<br/>
`/resources/templates/basic/editForm.html` ê²½ë¡œì— ë·° í…œí”Œë¦¿(templates)ìœ¼ë¡œ ìˆ˜ì •í•´ì¤€ë‹¤.<br/><br/>
```html
...
    <form action="item.html" th:action method="post">
...
            <input type="text" id="id" name="id" class="form-control" value="1" th:value="${item.id}" readonly>
...
                        th:onclick="|location.href='@{/basic/items/{itemId}(itemId=${item.id})'|"
...
```
<br/><br/>
### ìƒí’ˆ ìˆ˜ì • ì²˜ë¦¬ ì»¨íŠ¸ë¡¤ëŸ¬
```java
    @PostMapping("/{itemId}/edit")
    public String edit(@PathVariable Long itemId, @ModelAttribute Item item) {
        itemRepository.update(itemId, item);
        return "redirect:/basic/items/{itemId}";
    }
```
ìƒí’ˆ ìˆ˜ì •ì€ ë§ˆì§€ë§‰ì— ë·° í…œí”Œë¦¿ì„ í˜¸ì¶œí•˜ëŠ” ëŒ€ì‹ ì— ìƒí’ˆ ìƒì„¸ í™”ë©´ìœ¼ë¡œ ì´ë™í•˜ë„ë¡ ë¦¬ë‹¤ì´ë ‰íŠ¸ë¥¼ í˜¸ì¶œí•œë‹¤.<br/>
ìŠ¤í”„ë§ì€ `redirect:/...`ìœ¼ë¡œ í¸ë¦¬í•˜ê²Œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë¥¼ ì§€ì›í•œë‹¤.<br/><br/>
ë˜í•œ, ì»¨íŠ¸ë¡¤ëŸ¬ì— ë§¤í•‘ëœ @PathVariableì˜ ê°’ì€ redirectì—ë„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.<br/><br/>
![image](https://github.com/jang9205/spring_study/assets/123082616/c7aaeb7f-6fe8-4dff-a461-8dbbdbdc4f04)<br/><br/>
# ğŸ” PRG Post/Redirect/Get
ì§€ê¸ˆê¹Œì§€ ì§„í–‰í•œ ìƒí’ˆ ë“±ë¡ ì²˜ë¦¬ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ì‹¬ê°í•œ ë¬¸ì œê°€ ìˆë‹¤.<br/><br/>
ìƒí’ˆ ë“±ë¡ì„ ì™„ë£Œí•˜ê³  ì›¹ ë¸Œë¼ìš°ì €ì˜ ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ìƒí’ˆì´ ê³„ì†í•´ì„œ ì¤‘ë³µ ë“±ë¡ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br/><br/>
![image](https://github.com/jang9205/spring_study/assets/123082616/0503b872-d549-423b-8ca0-58f304be9a23)<br/>
ì›¹ ë¸Œë¼ìš°ì €ì˜ ìƒˆë¡œ ê³ ì¹¨ì€ ë§ˆì§€ë§‰ì— ì„œë²„ì— ì „ì†¡í•œ ë°ì´í„°ë¥¼ ë‹¤ì‹œ ì „ì†¡í•œë‹¤.<br/>
ìƒí’ˆ ë“±ë¡ í¼ì—ì„œ ë°ì´í„°ë¥¼ ì…ë ¥í•˜ê³  ì €ì¥ì„ ì„ íƒí•˜ë©´ `POST /add` + ìƒí’ˆ ë°ì´í„°ë¥¼ ì„œë²„ë¡œ ì „ì†¡í•œë‹¤.<br/>
ì´ ìƒíƒœì—ì„œ ìƒˆë¡œ ê³ ì¹¨ì„ í•˜ë©´ ë§ˆì§€ë§‰ì— ì „ì†¡í•œ `POST /add` + ìƒí’ˆ ë°ì´í„°ë¥¼ ì„œë²„ë¡œ ë‹¤ì‹œ ì „ì†¡í•˜ê²Œ ëœë‹¤.<br/>
ê·¸ë˜ì„œ ë‚´ìš©ì€ ê°™ê³ , IDë§Œ ë‹¤ë¥¸ ìƒí’ˆ ë°ì´í„°ê°€ ê³„ì† ìŒ“ì´ê²Œ ëœë‹¤.<br/><br/>
ì´ ë¬¸ì œëŠ” **Redirect**ë¡œ í•´ê²° ê°€ëŠ¥í•˜ë‹¤.<br/><br/>
![image](https://github.com/jang9205/spring_study/assets/123082616/925767a5-f0af-4c7f-89c2-39b59eb8530c)<br/>
ìƒˆë¡œ ê³ ì¹¨ ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ë©´ ìƒí’ˆ ì €ì¥ í›„ì— ë·° í…œí”Œë¦¿ìœ¼ë¡œ ì´ë™í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ìƒí’ˆ ìƒì„¸ í™”ë©´ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë¥¼ í˜¸ì¶œí•´ì£¼ë©´ ëœë‹¤.<br/>
ì›¹ ë¸Œë¼ìš°ì €ëŠ” ë¦¬ë‹¤ì´ë ‰íŠ¸ì˜ ì˜í–¥ìœ¼ë¡œ ìƒí’ˆ ì €ì¥ í›„ì— ì‹¤ì œ ìƒí’ˆ ìƒì„¸ í™”ë©´ìœ¼ë¡œ ë‹¤ì‹œ ì´ë™í•œë‹¤.<br/>
ë”°ë¼ì„œ ë§ˆì§€ë§‰ì— í˜¸ì¶œí•œ ë‚´ìš©ì´ ìƒí’ˆ ìƒì„¸ í™”ë©´ì¸ `GET /items/{id}`ê°€ ë˜ëŠ” ê²ƒì´ë‹¤.<br/><br/>
### ìƒí’ˆ ë“±ë¡ ì²˜ë¦¬ ìˆ˜ì •
`src/main/java/hello/itemservice/web/item/basic/BasicItemController`
```java
    @PostMapping("/add")
    public String addItemV5(Item item) {
        itemRepository.save(item);
        return "redirect:/basic/items/" + item.getId();
    }
```
ìƒˆë¡œê³ ì¹¨ì„ í•˜ë©´ `POST /add`ê°€ ì•„ë‹ˆë¼ `GET /items/{id}`ê°€ í˜¸ì¶œëœë‹¤.<br/>
ì´ëŸ° ë¬¸ì œ í•´ê²° ë°©ì‹ì„ `PRG(Post/Redirect/Get)`ë¼ê³  í•œë‹¤.<br/><br/>
# ğŸ” RedirectAttributes
redirectì—ì„œ `+item.getId()`ì²˜ëŸ¼ URLì— ë³€ìˆ˜ë¥¼ ë”í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ URL ì¸ì½”ë”©ì´ ì•ˆë˜ê¸° ë•Œë¬¸ì— ìœ„í—˜í•˜ë‹¤.<br/>
ê·¸ë¦¬ê³  ê³ ê° ì…ì¥ì—ì„œëŠ” ì˜ ì €ì¥ë˜ì—ˆëŠ”ì§€ í™•ì‹ ì´ ë“¤ì§€ ì•Šì„ ìˆ˜ ìˆì–´, ì €ì¥ í›„ "ìƒí’ˆì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤"ë¼ëŠ” ë©”ì‹œì§€ë¥¼ ë³´ì—¬ì¤„ ê²ƒì´ë‹¤.<br/><br/>
### ìƒí’ˆ ë“±ë¡ ì²˜ë¦¬ ìˆ˜ì •
`src/main/java/hello/itemservice/web/item/basic/BasicItemController`
```java
    @PostMapping("/add")
    public String addItemV6(Item item, RedirectAttributes redirectAttributes) {
        Item savedItem = itemRepository.save(item);
        redirectAttributes.addAttribute("itemId", savedItem.getId());
        redirectAttributes.addAttribute("status", true);
        return "redirect:/basic/items/{itemId}";
    }
```
`RedirectAttributes`ë¥¼ ì‚¬ìš©í•˜ë©´ URL ì¸ì½”ë”©ì„ í•´ì£¼ê³ , pathVarible, ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ê¹Œì§€ ì²˜ë¦¬í•´ì¤€ë‹¤.<br/>
`status`ì²˜ëŸ¼ pathVariableë¡œ ë°”ì¸ë”©ë˜ì§€ ì•Šì€ ê²ƒì€ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¡œ ì²˜ë¦¬í•œë‹¤.
- `redirect:/basic/items/{itemId}`
  - pathVariable ë°”ì¸ë”©: `{itemId}`
  - ë‚˜ë¨¸ì§€ëŠ” ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¡œ ì²˜ë¦¬: `?status=true`
#### 
![image](https://github.com/jang9205/spring_study/assets/123082616/1a52b227-1804-46fa-aeab-a6c4607c4c63)<br/><br/>
### ë·° í…œí”Œë¦¿ ë©”ì‹œì§€ ì¶”ê°€
ìƒí’ˆ ë“±ë¡ì„ í•´ì„œ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ì— `status=true`ê°€ ìˆìœ¼ë©´ ìƒí’ˆì´ ì €ì¥ë˜ì—ˆë‹¤ëŠ” ë©”ì‹œì§€ê°€ ë‚˜ì˜¤ê²Œ í•´ì¤€ë‹¤.<br/><br/>
`resources/templates/basic/item.html`
```html
    <h2 th:if="${param.status}" th:text="'ìƒí’ˆì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.'"></h2>
```
th:if: í•´ë‹¹ ì¡°ê±´ì´ ì°¸ì´ë©´ ì‹¤í–‰<br/>
${param.status}: íƒ€ì„ë¦¬í”„ì—ì„œ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¥¼ í¸ë¦¬í•˜ê²Œ ì¡°íšŒí•˜ëŠ” ê¸°ëŠ¥<br/><br/>
![image](https://github.com/jang9205/spring_study/assets/123082616/5c42a4e8-f6b9-422c-b68b-24d4cd7bc9c4)
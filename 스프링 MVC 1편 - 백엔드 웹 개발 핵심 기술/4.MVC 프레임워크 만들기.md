# ğŸ“– MVC í”„ë ˆì„ì›Œí¬ ë§Œë“¤ê¸°
<br/><br/>
# ğŸ” í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ íŒ¨í„´ ì†Œê°œ
### FrontController íŒ¨í„´
![image](https://github.com/jang9205/spring_study/assets/123082616/7e1c4cfc-4d86-4fdc-a5ed-bb96ea5a00ce)
- í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ ì„œë¸”ë¦¿ í•˜ë‚˜ë¡œ í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì„ ë°›ìŒ
- ìš”ì²­ì— ë§ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì°¾ì•„ì„œ í˜¸ì¶œ
- ê³µí†µ ì²˜ë¦¬ ê°€ëŠ¥
- í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ì„œë¸”ë¦¿ì„ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ë¨
<br/><br/>
# ğŸ” í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ ë„ì… - v1
ê¸°ì¡´ ì½”ë“œë¥¼ ìµœëŒ€í•œ ìœ ì§€í•˜ë©´ì„œ, í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë„ì…í•œë‹¤.<br/><br/>
![image](https://github.com/jang9205/spring_study/assets/123082616/7a5b73ee-08b6-465a-a978-fd4145711a35)<br/><br/>
### ì»¨íŠ¸ë¡¤ëŸ¬ ì¸í„°í˜ì´ìŠ¤ ìƒì„±
í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì´ ì»¨íŠ¸ë¡¤ëŸ¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ í˜¸ì¶œí•´ì„œ êµ¬í˜„ê³¼ ê´€ê³„ì—†ì´ ë¡œì§ì˜ ì¼ê´€ì„±ì„ ê°€ì ¸ê°ˆ ìˆ˜ ìˆë‹¤.<br/><br/>
`src/main/java/hello/servlet/web/frontcontroller/v1/ControllerV1`
```java
public interface ControllerV1 {
    void process(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException;
}
```
<br/><br/>
### ì»¨íŠ¸ë¡¤ëŸ¬ ìƒì„±
#### íšŒì› ë“±ë¡ ì»¨íŠ¸ë¡¤ëŸ¬
`src/main/java/hello/servlet/web/frontcontroller/v1/controller/MemberFormControllerV1`
```java
public class MemberFormControllerV1 implements ControllerV1 {

    @Override
    public void process(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

        //MvcMemberFormServletê³¼ ë™ì¼í•œ ë‚´ìš©
    }
}
```
#### íšŒì› ì €ì¥ ì»¨íŠ¸ë¡¤ëŸ¬
`src/main/java/hello/servlet/web/frontcontroller/v1/controller/MemberSaveControllerV1`
```java
public class MemberSaveControllerV1 implements ControllerV1 {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    public void process(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

        // MvcMemberSaveServletê³¼ ë™ì¼í•œ ë‚´ìš©
    }
}
```
#### íšŒì› ëª©ë¡ ì¡°íšŒ ì»¨íŠ¸ë¡¤ëŸ¬
`src/main/java/hello/servlet/web/frontcontroller/v1/controller/MemberListControllerV1`
```java
public class MemberListControllerV1 implements ControllerV1 {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    public void process(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

        // MvcMemberListServletê³¼ ë™ì¼í•œ ë‚´ìš©
    }
}
```
<br/><br/>
### í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ ìƒì„±
`src/main/java/hello/servlet/web/frontcontroller/v1/FrontControllerServletV1`
```java
@WebServlet(name = "frontControllerServletV1", urlPatterns = "/front-controller/v1/*")
public class FrontControllerServletV1 extends HttpServlet {

    private Map<String, ControllerV1> controllerMap = new HashMap<>();

    public FrontControllerServletV1() {
        controllerMap.put("/front-controller/v1/members/new-form", new MemberFormControllerV1());
        controllerMap.put("/front-controller/v1/members/save", new MemberSaveControllerV1());
        controllerMap.put("/front-controller/v1/members", new MemberListControllerV1());
    }

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        System.out.println("FrontControllerServletV1.service");

        String requestURI = request.getRequestURI();

        ControllerV1 controller = controllerMap.get(requestURI);
        if (controller == null) {
            response.setStatus(HttpServletResponse.SC_NOT_FOUND);   //404
            return;
        }

        controller.process(request, response);
    }
}
```
- **urlPatterns = "/front-controller/v1/*"** : `/front-controller/v1`ì„ í¬í•¨í•œ ëª¨ë“  í•˜ìœ„ ìš”ì²­ì€ ì´ ì„œë¸”ë¦¿ì—ì„œ ë°›ì•„ë“¤ì¸ë‹¤.
- `requestURI`ë¥¼ ì¡°íšŒí•´ì„œ ì‹¤ì œ í˜¸ì¶œí•  ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ `controllerMap`ì—ì„œ ì°¾ëŠ”ë‹¤. ë§Œì•½ ì—†ë‹¤ë©´ 404(SC_NOT_FOUND) ìƒíƒœ ì½”ë“œë¥¼ ë°˜í™˜í•œë‹¤.
- ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì°¾ê³  `controller.process(request, response);`ë¥¼ í˜¸ì¶œí•´ì„œ í•´ë‹¹ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì‹¤í–‰í•œë‹¤.
##### 
<br/><br/>ì‹¤í–‰: http://localhost:8080/front-controller/v1/members/new-form<br/><br/>
íšŒì› ë“±ë¡ í¼, íšŒì› ì €ì¥, íšŒì› ëª©ë¡ ì¡°íšŒê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤.<br/><br/>
# ğŸ” View ë¶„ë¦¬ - v2
ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë·°ë¡œ ì´ë™í•˜ëŠ” ë¶€ë¶„ì— ì¤‘ë³µì´ ìˆê³ , ê¹”ë”í•˜ì§€ ì•Šë‹¤.
```java
String viewPath = "/WEB-INF/views/new-form.jsp";
RequestDispatcher dispatcher = request.getRequestDispatcher(viewPath);
dispatcher.forward(request, response);
```
ì´ ë¶€ë¶„ì„ ê¹”ë”í•˜ê²Œ ë¶„ë¦¬í•˜ê¸° ìœ„í•´ ë³„ë„ë¡œ ë·°ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê°ì²´ë¥¼ ë§Œë“ ë‹¤.<br/><br/>
![image](https://github.com/jang9205/spring_study/assets/123082616/30998d35-962d-4d40-94ae-8082a3d6713f)<br/><br/>
### MyView ìƒì„±
`src/main/java/hello/servlet/web/frontcontroller/MyView`
```java
public class MyView {
    private String viewPath;

    public MyView(String viewPath) {
        this.viewPath = viewPath;
    }

    public void render(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        RequestDispatcher dispatcher = request.getRequestDispatcher(viewPath);
        dispatcher.forward(request, response);
    }
}
```
<br/><br/>
### ì»¨íŠ¸ë¡¤ëŸ¬ ì¸í„°í˜ì´ìŠ¤ ìƒì„±
v1ì€ ë°˜í™˜ì´ ì—†ì—ˆì§€ë§Œ v2ì—ì„œëŠ” MyViewë¥¼ ë°˜í™˜í•´ì¤€ë‹¤.<br/><br/>
`src/main/java/hello/servlet/web/frontcontroller/v2/ControllerV2`
```java
public interface ControllerV2 {
    MyView process(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException;
}
```
<br/><br/>
### ì»¨íŠ¸ë¡¤ëŸ¬ ìƒì„±
`src/main/java/hello/servlet/web/frontcontroller/v2/controller/MemberFormControllerV2`
```java
//ê¸°ì¡´ ì½”ë“œ
String viewPath = "/WEB-INF/views/new-form.jsp";
RequestDispatcher dispatcher = request.getRequestDispatcher(viewPath);
dispatcher.forward(request, response);
```
```java
//ë³€ê²½ ì½”ë“œ
return new MyView("/WEB-INF/views/new-form.jsp");
```
MyView ê°ì²´ë¥¼ ìƒì„±í•˜ê³ , ë·° ì´ë¦„ì„ ë„£ì–´ ë°˜í™˜í•´ì¤€ë‹¤.<br/><br/>
`MemberSaveControllerV2`, `MemberListControllerV2` ì»¨íŠ¸ë¡¤ëŸ¬ë„ ìœ„ ì½”ë“œì²˜ëŸ¼ ìˆ˜ì •í•´ì„œ ì¤‘ë³µì„ ì œê±°í•œë‹¤.<br/><br/>
### í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ ìƒì„±
`src/main/java/hello/servlet/web/frontcontroller/v2/FrontControllerServletV2`
```java
//ê¸°ì¡´ ì½”ë“œ
controller.process(request, response);
```
```java
//ë³€ê²½ ì½”ë“œ
MyView view = controller.process(request, response);
view.render(request, response);
```
v1ì—ì„œëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì§ì ‘ ë·°ë¡œ ì´ë™í–ˆê¸° ë•Œë¬¸ì— ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í˜¸ì¶œí•˜ëŠ” ì½”ë“œë§Œ ìˆì—ˆì§€ë§Œ<br/>
v2ì—ì„œëŠ” MyView ê°ì²´ë¥¼ ë°˜í™˜ë°›ì•„ì„œ í•´ë‹¹ ë·°(JSP)ë¡œ ì´ë™í•˜ëŠ” ì½”ë“œê°€ ì¶”ê°€ëœë‹¤.<br/><br/>
ì‹¤í–‰: http://localhost:8080/front-controller/v2/members/new-form<br/><br/>
íšŒì› ë“±ë¡ í¼, íšŒì› ì €ì¥, íšŒì› ëª©ë¡ ì¡°íšŒê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤.<br/><br/>
# ğŸ” Model ì¶”ê°€ - v3
### ì„œë¸”ë¦¿ ì¢…ì†ì„± ì œê±°
- ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” `HttpServletRequest`, `HttpServletResponse`ê°€ ê¼­ í•„ìš”í•˜ì§€ ì•Šë‹¤.
- ìš”ì²­ íŒŒë¼ë¯¸í„° ì •ë³´ëŠ” ìë°”ì˜ Mapìœ¼ë¡œ ëŒ€ì‹  ë„˜ê¸´ë‹¤.
- request ê°ì²´ë¥¼ Modelë¡œ ì‚¬ìš©í•˜ëŠ” ëŒ€ì‹ ì— ë³„ë„ì˜ Model ê°ì²´ë¥¼ ë§Œë“¤ì–´ì„œ ë°˜í™˜í•œë‹¤.
<br/><br/>
### ë·° ì´ë¦„ ì¤‘ë³µ ì œê±°
- ê¸°ì¡´ ì½”ë“œëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì§€ì •í•˜ëŠ” ë·° ì´ë¦„ì— ì¤‘ë³µì´ ìˆë‹¤.
- ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ë·°ì˜ ë…¼ë¦¬ ì´ë¦„ì„ ë°˜í™˜í•˜ê³ , ì‹¤ì œ ë¬¼ë¦¬ ìœ„ì¹˜ì˜ ì´ë¦„ì€ í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì²˜ë¦¬í•˜ë„ë¡ ë‹¨ìˆœí™”í•œë‹¤.
##### 
![image](https://github.com/jang9205/spring_study/assets/123082616/51a902e4-c409-4c33-a939-1251e8822725)<br/><br/>
### ModelView ìƒì„±
ì„œë¸”ë¦¿ì˜ ì¢…ì†ì„±ì„ ì œê±°í•˜ê¸° ìœ„í•´ Modelì„ ì§ì ‘ ë§Œë“¤ê³ , ì¶”ê°€ë¡œ View ì´ë¦„ê¹Œì§€ ì „ë‹¬í•˜ëŠ” ê°ì²´ë¥¼ ë§Œë“ ë‹¤.<br/><br/>
ModelViewì—ëŠ” viewì˜ ë…¼ë¦¬ ì´ë¦„(viewName)ê³¼, Modelì´ ìˆë‹¤.<br/>
ê·¸ë¦¬ê³  viewNameì— ëŒ€í•œ ìƒì„±ìë¥¼ ë§Œë“¤ê³ , viewNameê³¼ modelì˜ getterì™€ setterë¥¼ ë§Œë“¤ì–´ ì¤€ë‹¤.<br/><br/>
`src/main/java/hello/servlet/web/frontcontroller/ModelView`
```java
@Getter @Setter
public class ModelView {
    private String viewName;
    private Map<String, Object> model = new HashMap<>();

    public ModelView(String viewName) {
        this.viewName = viewName;
    }
}
```
<br/><br/>
### ì»¨íŠ¸ë¡¤ëŸ¬ ì¸í„°í˜ì´ìŠ¤ ìƒì„±
v3ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ ì¸í„°í˜ì´ìŠ¤ëŠ” ModelViewë¥¼ ë°˜í™˜í•´ ì¤€ë‹¤.<br/><br/>
`src/main/java/hello/servlet/web/frontcontroller/v3/ControllerV3`
```java
public interface ControllerV3 {
    ModelView process(Map<String, String> paramMap);
}
```
<br/><br/>
### ì»¨íŠ¸ë¡¤ëŸ¬ ìƒì„±
`src/main/java/hello/servlet/web/frontcontroller/v3/controller/MemberFormControllerV3`<br/><br/>
viewì˜ ë…¼ë¦¬ì  ì´ë¦„ì„ ë„£ì–´, ModelViewë¥¼ ìƒì„±í•œë‹¤.
```java
//ê¸°ì¡´ ì½”ë“œ
@Override
public MyView process(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    return new MyView("/WEB-INF/views/new-form.jsp");
}
```
```java
//ë³€ê²½ ì½”ë“œ
@Override
public ModelView process(Map<String, String> paramMap) {
    return new ModelView("new-form");
}
```
<br/><br/>
`src/main/java/hello/servlet/web/frontcontroller/v3/controller/MemberSaveControllerV3`<br/><br/>
íŒŒë¼ë¯¸í„° ì •ë³´ëŠ” mapì— ë‹´ê²¨ìˆì–´, mapì—ì„œ í•„ìš”í•œ ìš”ì²­ íŒŒë¼ë¯¸í„°ë¥¼ ì¡°íšŒí•œë‹¤.
```java
//ê¸°ì¡´ ì½”ë“œ
String username = request.getParameter("username"); //íŒŒë¼ë¯¸í„° ì¡°íšŒ
int age = Integer.parseInt(request.getParameter("age"));
```
```java
//ë³€ê²½ ì½”ë“œ
String username = paramMap.get("username");
int age = Integer.parseInt(paramMap.get("age"));
```
<br/><br/>
viewì˜ ë…¼ë¦¬ì  ì´ë¦„ì„ ë„£ì–´ ModelView ê°ì²´ë¥¼ ìƒì„±í•˜ê³ , ëª¨ë¸ì— ë·°ì—ì„œ í•„ìš”í•œ member ê°ì²´ë¥¼ ë„£ì–´ ë°˜í™˜í•œë‹¤.
```java
//ê¸°ì¡´ ì½”ë“œ
request.setAttribute("member", member);
return new MyView("/WEB-INF/views/save-result.jsp");
```
```java
//ë³€ê²½ ì½”ë“œ
ModelView mv = new ModelView("save-result");
mv.getModel().put("member", member);
return mv;
```
<br/><br/>`MemberListControllerV3` ì»¨íŠ¸ë¡¤ëŸ¬ë„ ìœ„ ì½”ë“œì²˜ëŸ¼ ModelView ê°ì²´ë¥¼ ìƒì„±í•˜ê³ , ëª¨ë¸ì— members ê°ì²´ë¥¼ ë„£ì–´ ë°˜í™˜í•œë‹¤.<br/><br/>
### í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ ìƒì„±
í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œëŠ” paramMapì„ ë§Œë“¤ì–´ ì£¼ê³ , ë…¼ë¦¬ ì´ë¦„ìœ¼ë¡œ ì‹¤ì œ ê²½ë¡œë¥¼ ì°¾ì„ ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.<br/><br/>
`src/main/java/hello/servlet/web/frontcontroller/v3/FrontControllerServletV3`
<br/><br/>ìš”ì²­í•œ requestì— ìˆëŠ” ëª¨ë“  íŒŒë¼ë¯¸í„° ì •ë³´ë¥¼ êº¼ë‚´ **paramMap**ì— ë„£ì–´ì£¼ê³ ,<br/>
paramMapì„ ì»¨íŠ¸ë¡¤ëŸ¬ì— ì „ë‹¬í•˜ë©´ì„œ í˜¸ì¶œí•œë‹¤.
```java
Map<String, String> paramMap = createParamMap(request);
ModelView mv = controller.process(paramMap);

private Map<String, String> createParamMap(HttpServletRequest request) {
    Map<String, String> paramMap = new HashMap<>();
    request.getParameterNames().asIterator()
            .forEachRemaining(paramName -> paramMap.put(paramName, request.getParameter(paramName)));
    return paramMap;
    }
```
<br/><br/>ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ë°˜í™˜í•œ ë…¼ë¦¬ ë·° ì´ë¦„ì„ ì‹¤ì œ ë¬¼ë¦¬ ë·° ê²½ë¡œë¡œ ë³€ê²½í•œë‹¤. ê·¸ë¦¬ê³  ì‹¤ì œ ë¬¼ë¦¬ ê²½ë¡œê°€ ìˆëŠ” MyView ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤.
```java
String viewName = mv.getViewName(); //viewì˜ ë…¼ë¦¬ì ì¸ ì´ë¦„
MyView view = viewResolver(viewName);

private MyView viewResolver(String viewName) {
    return new MyView("/WEB-INF/views/" + viewName + ".jsp");
    }
```
<br/><br/>modelì„ í•¨ê»˜ ë„£ì–´ viewë¥¼ renderingí•œë‹¤.
```java
view.render(mv.getModel(), request, response);
```
ê·¸ëŸ¬ë‚˜ íŒŒë¼ë¯¸í„°ê°€ 3ê°œì¸ render ë©”ì„œë“œê°€ ì—†ì–´ ìƒˆë¡œ ì¶”ê°€í•´ì¤€ë‹¤.<br/><br/>
`src/main/java/hello/servlet/web/frontcontroller/v3/MyView`
<br/><br/>JSPëŠ” `request.getAttribute()`ë¡œ ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ê¸° ë•Œë¬¸ì—, ëª¨ë¸ì˜ ë°ì´í„°ë¥¼ êº¼ë‚´ì„œ `request.setAttribute()`ë¡œ requestì— ëª¨ë¸ ë°ì´í„°ë¥¼ ë‹´ëŠ”ë‹¤.
```java
public void render(Map<String, Object> model, HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    modelToRequestAttribute(model, request);
    RequestDispatcher dispatcher = request.getRequestDispatcher(viewPath);
    dispatcher.forward(request, response);
    }

private static void modelToRequestAttribute(Map<String, Object> model, HttpServletRequest request) {
    model.forEach((key, value) -> request.setAttribute(key, value));
    }
```
<br/><br/>ì‹¤í–‰: http://localhost:8080/front-controller/v3/members/new-form<br/><br/>
íšŒì› ë“±ë¡ í¼, íšŒì› ì €ì¥, íšŒì› ëª©ë¡ ì¡°íšŒê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤.<br/><br/>
# ğŸ” ë‹¨ìˆœí•˜ê³  ì‹¤ìš©ì ì¸ ì»¨íŠ¸ë¡¤ëŸ¬ - v4
ì•ì„œ ë§Œë“  v3 ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” í•­ìƒ ModelView ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ë°˜í™˜í•´ì•¼ í•˜ëŠ” ë¶€ë¶„ì´ ì¡°ê¸ˆì€ ë²ˆê±°ë¡­ë‹¤.<br/><br/>
![image](https://github.com/jang9205/spring_study/assets/123082616/db72afe5-2239-4087-a95c-05d0faf3e9fd)<br/><br/>
v4ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ModelViewê°€ ì•„ë‹Œ ViewNameì„ ë°˜í™˜í•œë‹¤.<br/><br/>
### ì»¨íŠ¸ë¡¤ëŸ¬ ì¸í„°í˜ì´ìŠ¤ ìƒì„±
íŒŒë¼ë¯¸í„°ë¡œ paramMapê³¼ model ê°ì²´ê°€ ì „ë‹¬ë˜ê³ , ê²°ê³¼ë¡œ ë·°ì˜ ì´ë¦„ì„ ë°˜í™˜í•´ ì¤€ë‹¤.<br/><br/>
`src/main/java/hello/servlet/web/frontcontroller/v4/ControllerV4`
```java
public interface ControllerV4 {
    String process(Map<String, String> paramMap, Map<String, Object> model);
}
```
<br/><br/>
### ì»¨íŠ¸ë¡¤ëŸ¬ ìƒì„±
`src/main/java/hello/servlet/web/frontcontroller/v4/controller/MemberSaveControllerV4`<br/><br/>
ModelView ê°ì²´ë¥¼ ìƒì„±í•˜ê³ , modelì— ë°ì´í„°ë¥¼ ë³´ê´€í•  í•„ìš”ì—†ì´<br/>
íŒŒë¼ë¯¸í„°ë¡œ ë°›ì€ modelì— ë°”ë¡œ ë°ì´í„°ë¥¼ ë³´ê´€í•˜ê³  viewNameì„ ë°˜í™˜í•´ ì¤€ë‹¤.
```java
//ê¸°ì¡´ ì½”ë“œ
ModelView mv = new ModelView("save-result");
mv.getModel().put("member", member);
return mv;
```
```java
//ë³€ê²½ ì½”ë“œ
model.put("member", member);
return "save-result";
```
<br/><br/>`MemberFormControllerV4`, `MemberListControllerV4` ì»¨íŠ¸ë¡¤ëŸ¬ë„ ìœ„ ì½”ë“œì²˜ëŸ¼ viewNameì„ ë°˜í™˜í•˜ê²Œ ìˆ˜ì •í•œë‹¤.<br/><br/>
### í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ ìƒì„±
`src/main/java/hello/servlet/web/frontcontroller/v4/FrontControllerServletV4`<br/><br/>
ëª¨ë¸ ê°ì²´ë¥¼ í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ìƒì„±í•´ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ë¡œ ë„˜ê²¨ì¤€ë‹¤.<br/>
ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ëª¨ë¸ ê°ì²´ì— ê°’ì„ ë‹´ìœ¼ë©´ ì—¬ê¸°ì— ê·¸ëŒ€ë¡œ ë‹´ê²¨ìˆê²Œ ëœë‹¤.
```java
//ê¸°ì¡´ ì½”ë“œ
ModelView mv = controller.process(paramMap);
```
```java
//ë³€ê²½ ì½”ë“œ
Map<String, Object> model = new HashMap<>();  //ëª¨ë¸ ìƒì„±
String viewName = controller.process(paramMap, model);  //íŒŒë¼ë¯¸í„°ë¡œ ëª¨ë¸ ì „ë‹¬, ë·°ì˜ ì´ë¦„ì„ ë°˜í™˜ë°›ìŒ
```
<br/><br/>ë°˜í™˜ë°›ì€ viewNameìœ¼ë¡œ ì‹¤ì œ ê²½ë¡œ ì´ë¦„ì„ ì°¾ê³ , renderingí•œë‹¤.
```java
//ê¸°ì¡´ ì½”ë“œ
String viewName = mv.getViewName();
MyView view = viewResolver(viewName);

view.render(mv.getModel(), request, response);
```
```java
//ë³€ê²½ ì½”ë“œ
MyView view = viewResolver(viewName);

view.render(model, request, response);
```
<br/><br/>ì‹¤í–‰: http://localhost:8080/front-controller/v4/members/new-form<br/><br/>
íšŒì› ë“±ë¡ í¼, íšŒì› ì €ì¥, íšŒì› ëª©ë¡ ì¡°íšŒê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤.<br/><br/>
# ğŸ” ìœ ì—°í•œ ì»¨íŠ¸ë¡¤ëŸ¬1 - v5
ë§Œì•½ ControllerV3, ControllerV4 ë°©ì‹ì„ ë‘˜ ë‹¤ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´<br/>
**ì–´ëŒ‘í„° íŒ¨í„´**ì„ ì‚¬ìš©í•˜ì—¬ í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ë‹¤ì–‘í•œ ë°©ì‹ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.<br/><br/>
![image](https://github.com/jang9205/spring_study/assets/123082616/38d97402-669e-45c1-a2b4-4ae9a7d0b3a4)<br/><br/>
- **í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°**: ì¤‘ê°„ì—ì„œ ì–´ëŒ‘í„° ì—­í• ì„ í•œë‹¤. ë‹¤ì–‘í•œ ì¢…ë¥˜ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í˜¸ì¶œí•´ ì¤€ë‹¤.
- **í•¸ë“¤ëŸ¬**: ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ì´ë¦„ì„ ë” ë„“ì€ ë²”ìœ„ì¸ í•¸ë“¤ëŸ¬ë¡œ ë³€ê²½í•œë‹¤.
<br/><br/>
### ì–´ëŒ‘í„° ì¸í„°í˜ì´ìŠ¤ ìƒì„±
`src/main/java/hello/servlet/web/frontcontroller/v5/MyHandlerAdapter`
```java
public interface MyHandlerAdapter {
    //ì–´ëŒ‘í„°ê°€ í•´ë‹¹ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ”ì§€ íŒë‹¨í•˜ëŠ” ë©”ì„œë“œ
    boolean supports(Object handler);

    //ì‹¤ì œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í˜¸ì¶œí•˜ê³ , ê·¸ ê²°ê³¼ë¡œ ModelViewë¥¼ ë°˜í™˜
    ModelView handle(HttpServletRequest request, HttpServletResponse response, Object handler) throws ServletException, IOException;
}
```
<br/><br/>
### ì–´ëŒ‘í„° ìƒì„±
í•¸ë“¤ëŸ¬ë¥¼ í˜¸ì¶œí•˜ì—¬, ModelViewë¥¼ ë°˜í™˜í•˜ëŠ” í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ë¥¼ ìƒì„±í•œë‹¤.<br/><br/>
`src/main/java/hello/servlet/web/frontcontroller/v5/adapter/ControllerV3HandlerAdapter`
```java
public class ControllerV3HandlerAdapter implements MyHandlerAdapter {

    @Override
    public boolean supports(Object handler) {
        return (handler instanceof ControllerV3);  //handler ê°ì²´ê°€ ControllerV3ì˜ ì¸ìŠ¤í„´ìŠ¤ì¸ì§€ í™•ì¸
    }

    @Override
    public ModelView handle(HttpServletRequest request, HttpServletResponse response, Object handler) throws ServletException, IOException {
        //handlerë¥¼ ControllerV3ë¡œ í˜•ë³€í™˜
        ControllerV3 controller = (ControllerV3) handler;

        Map<String, String> paramMap = createParamMap(request);
        //ControllerV3ëŠ” ModelViewë¥¼ ë°˜í™˜
        ModelView mv = controller.process(paramMap);

        return mv;
    }

    private Map<String, String> createParamMap(HttpServletRequest request) {
        Map<String, String> paramMap = new HashMap<>();
        request.getParameterNames().asIterator()
                .forEachRemaining(paramName -> paramMap.put(paramName, request.getParameter(paramName)));
        return paramMap;
    }
}
```
<br/><br/>
### í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ ìƒì„±
`src/main/java/hello/servlet/web/frontcontroller/v5/FrontControllerServletV5`<br/><br/>
ëª¨ë“  í•¸ë“¤ëŸ¬(ì»¨íŠ¸ë¡¤ëŸ¬)ê°€ ë“¤ì–´ê°ˆ ìˆ˜ ìˆëŠ” mapê³¼ í•¸ë“¤ëŸ¬ ì–´íƒ­í„°ê°€ ë“¤ì–´ìˆëŠ” Listë¥¼ ìƒì„±í•œë‹¤.
```java
private final Map<String, Object> handlerMappingMap = new HashMap<>();
private final List<MyHandlerAdapter> handlerAdapters = new ArrayList<>();
```
<br/><br/>ìƒì„±ìë¥¼ ë§Œë“¤ì–´ í•¸ë“¤ëŸ¬(ì»¨íŠ¸ë¡¤ëŸ¬) ë§¤í•‘ê³¼ í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ë¥¼ ë“±ë¡í•œë‹¤.
```java
public FrontControllerServletV5() {
    initHandlerMappingMap(); // í•¸ë“¤ëŸ¬ ë§¤í•‘ ë“±ë¡
    initHandlerAdapters(); // í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„° ë“±ë¡
}

// í•¸ë“¤ëŸ¬ ë§¤í•‘ ë“±ë¡
private void initHandlerMappingMap() {
    handlerMappingMap.put("/front-controller/v5/v3/members/new-form", new MemberFormControllerV3());
    handlerMappingMap.put("/front-controller/v5/v3/members/save", new MemberSaveControllerV3());
    handlerMappingMap.put("/front-controller/v5/v3/members", new MemberListControllerV3());
}

// í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„° ë“±ë¡
private void initHandlerAdapters() {
    handlerAdapters.add(new ControllerV3HandlerAdapter());
}
```
<br/><br/>í•¸ë“¤ëŸ¬ ë§¤í•‘ ì •ë³´ë¥¼ í†µí•´ í•¸ë“¤ëŸ¬(ì»¨íŠ¸ë¡¤ëŸ¬)ë¥¼ ì¡°íšŒí•˜ê³ ,<br/>
í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„° ëª©ë¡ì—ì„œ í•¸ë“¤ëŸ¬(ì»¨íŠ¸ë¡¤ëŸ¬)ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” í•¸ë“¤ëŸ¬ ì–´íƒ­í„°ë¥¼ ì¡°íšŒí•œë‹¤.
```java
    Object handler = getHandler(request);
    if (handler == null) {
        response.setStatus(HttpServletResponse.SC_NOT_FOUND);   //404
        return;
    }
    MyHandlerAdapter adapter = getHandlerAdapter(handler);
}

//URIì— ëŒ€í•œ handler(controller)ë¥¼ handlerMappingMapì—ì„œ ì°¾ì•„ì„œ ë°˜í™˜
private Object getHandler(HttpServletRequest request) {
    String requestURI = request.getRequestURI();
    return handlerMappingMap.get(requestURI);
}

//handlerë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„° ì¡°íšŒí•´ì„œ ë°˜í™˜
private MyHandlerAdapter getHandlerAdapter(Object handler) {
    for (MyHandlerAdapter adapter : handlerAdapters) {
        if (adapter.supports(handler)) {
            return adapter;
        }
    }
    throw new IllegalArgumentException("handler adapterë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. handler=" + handler);
}
```
<br/><br/>í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ë¡œ í•¸ë“¤ëŸ¬(ì»¨íŠ¸ë¡¤ëŸ¬)ë¥¼ í˜¸ì¶œí•˜ê³ , ModelViewë¥¼ ë°˜í™˜í•œë‹¤.
```java
ModelView mv = adapter.handle(request, response, handler);
```
<br/><br/>viewResolverë¥¼ í˜¸ì¶œí•´ Myviewë¥¼ ë°˜í™˜í•˜ê³ ,<br/>
modelì„ í•¨ê»˜ ë„£ì–´ viewë¥¼ renderingí•œë‹¤.
```java
    String viewName = mv.getViewName(); //viewì˜ ë…¼ë¦¬ì ì¸ ì´ë¦„
    MyView view = viewResolver(viewName);
    view.render(mv.getModel(), request, response);
}

// ë…¼ë¦¬ ì´ë¦„ -> ì‹¤ì œ ê²½ë¡œ ì´ë¦„
private MyView viewResolver(String viewName) {
    return new MyView("/WEB-INF/views/" + viewName + ".jsp");
}
```
<br/><br/>ì‹¤í–‰: http://localhost:8080/front-controller/v5/v3/members/new-form<br/><br/>
íšŒì› ë“±ë¡ í¼, íšŒì› ì €ì¥, íšŒì› ëª©ë¡ ì¡°íšŒê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤.<br/><br/>
# ğŸ” ìœ ì—°í•œ ì»¨íŠ¸ë¡¤ëŸ¬2 - v5
ControllerV4ë„ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ê¸°ëŠ¥ì„ ì¶”ê°€í•œë‹¤.<br/><br/>
### ì–´ëŒ‘í„° ìƒì„±
`src/main/java/hello/servlet/web/frontcontroller/v5/adapter/ControllerV4HandlerAdapter`<br/><br/>
ControllerV3HandlerAdapterì™€ ë‹¤ë¥¸ ì ì€<br/>
ControllerV4ëŠ” íŒŒë¼ë¯¸í„°ë¡œ paramMapê³¼ model ê°ì²´ê°€ ì „ë‹¬ë˜ê³ , ê²°ê³¼ë¡œ viewNameì„ ë°˜í™˜í•´ ì¤€ë‹¤ëŠ” ì ì´ë‹¤.
```java
Map<String, String> paramMap = createParamMap(request);
HashMap<String, Object> model = new HashMap<>();

String viewName = controller.process(paramMap, model);
```
<br/><br/>ê·¸ëŸ¬ë‚˜ ì–´ëŒ‘í„°ëŠ” ModelViewë¡œ ë°˜í™˜í•´ì•¼ í•˜ë¯€ë¡œ, ì–´ëŒ‘í„°ê°€ ModelView í˜•ì‹ìœ¼ë¡œ ë§ì¶”ì–´ ë°˜í™˜í•´ ì¤€ë‹¤.
```java
ModelView mv = new ModelView(viewName);
mv.setModel(model);

return mv;
```
<br/><br/>
### í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ ìˆ˜ì •
`src/main/java/hello/servlet/web/frontcontroller/v5/FrontControllerServletV5`<br/><br/>
í•¸ë“¤ëŸ¬ ë§¤í•‘ì— ControllerV4ë¥¼ ì‚¬ìš©í•˜ëŠ” í•¸ë“¤ëŸ¬(ì»¨íŠ¸ë¡¤ëŸ¬)ë¥¼ ì¶”ê°€í•œë‹¤.
```java
//í•¸ë“¤ëŸ¬ ë§¤í•‘ ë“±ë¡
private void initHandlerMappingMap() {
    handlerMappingMap.put("/front-controller/v5/v3/members/new-form", new MemberFormControllerV3());
    handlerMappingMap.put("/front-controller/v5/v3/members/save", new MemberSaveControllerV3());
    handlerMappingMap.put("/front-controller/v5/v3/members", new MemberListControllerV3());

    handlerMappingMap.put("/front-controller/v5/v4/members/new-form", new MemberFormControllerV4());
    handlerMappingMap.put("/front-controller/v5/v4/members/save", new MemberSaveControllerV4());
    handlerMappingMap.put("/front-controller/v5/v4/members", new MemberListControllerV4());
    }
```
<br/><br/>í•´ë‹¹ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì–´ëŒ‘í„°ì¸ ControllerV4HandlerAdapterë„ ì¶”ê°€í•œë‹¤.
```java
//í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„° ë“±ë¡
private void initHandlerAdapters() {
    handlerAdapters.add(new ControllerV3HandlerAdapter());
    handlerAdapters.add(new ControllerV4HandlerAdapter());
    }
```
<br/><br/>ì‹¤í–‰: http://localhost:8080/front-controller/v5/v4/members/new-form<br/><br/>
íšŒì› ë“±ë¡ í¼, íšŒì› ì €ì¥, íšŒì› ëª©ë¡ ì¡°íšŒê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤.<br/><br/>
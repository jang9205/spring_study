# ğŸ“– ê²€ì¦1 - Validation
<br/><br/>
# ğŸ” ê²€ì¦ ìš”êµ¬ì‚¬í•­
ìƒí’ˆ ê´€ë¦¬ ì‹œìŠ¤í…œì— ìƒˆë¡œìš´ ìš”êµ¬ì‚¬í•­ì´ ì¶”ê°€ë˜ì—ˆë‹¤.<br/>
ì›¹ ì„œë¹„ìŠ¤ëŠ” í¼ ì…ë ¥ ì‹œ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´, ê³ ê°ì´ ì…ë ¥í•œ ë°ì´í„°ë¥¼ ìœ ì§€í•œ ìƒíƒœë¡œ ì–´ë–¤ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆëŠ”ì§€ ì¹œì ˆí•˜ê²Œ ì•Œë ¤ì£¼ì–´ì•¼ í•œë‹¤.<br/><br/>
### ìš”êµ¬ì‚¬í•­: ê²€ì¦ ë¡œì§ ì¶”ê°€
- íƒ€ì… ê²€ì¦
  - ê°€ê²©, ìˆ˜ëŸ‰ì— ë¬¸ìê°€ ë“¤ì–´ê°€ë©´ ê²€ì¦ ì˜¤ë¥˜ ì²˜ë¦¬
- í•„ë“œ ê²€ì¦
  - ìƒí’ˆëª…: í•„ìˆ˜, ê³µë°±X
  - ê°€ê²©: 1000ì› ì´ìƒ, 1ë°±ë§Œì› ì´í•˜
  - ìˆ˜ëŸ‰: ìµœëŒ€ 9999
- íŠ¹ì • í•„ë“œì˜ ë²”ìœ„ë¥¼ ë„˜ì–´ì„œëŠ” ê²€ì¦
  - ê°€ê²© * ìˆ˜ëŸ‰ì˜ í•©ì€ 10,000ì› ì´ìƒ
<br/><br/>
### í´ë¼ì´ì–¸íŠ¸ ê²€ì¦, ì„œë²„ ê²€ì¦
- í´ë¼ì´ì–¸íŠ¸ ê²€ì¦ì€ ì¡°ì‘í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë³´ì•ˆì— ì·¨ì•½í•˜ë‹¤.
- ì„œë²„ë§Œìœ¼ë¡œ ê²€ì¦í•˜ë©´, ì¦‰ê°ì ì¸ ê³ ê° ì‚¬ìš©ì„±ì´ ë¶€ì¡±í•´ì§„ë‹¤.
- ë‘˜ì„ ì ì ˆíˆ ì„ì–´ì„œ ì‚¬ìš©í•˜ë˜, ìµœì¢…ì ìœ¼ë¡œ ì„œë²„ ê²€ì¦ì€ í•„ìˆ˜
- API ë°©ì‹ì„ ì‚¬ìš©í•˜ë©´ API ìŠ¤í™ì„ ì˜ ì •ì˜í•´ì„œ ê²€ì¦ ì˜¤ë¥˜ë¥¼ API ì‘ë‹µ ê²°ê³¼ì— ì˜ ë‚¨ê²¨ì£¼ì–´ì•¼ í•¨
<br/><br/>
# ğŸ” ê²€ì¦ ì§ì ‘ ì²˜ë¦¬ - ì†Œê°œ
### ìƒí’ˆ ì €ì¥ ì„±ê³µ
![image](https://github.com/jang9205/spring_study/assets/123082616/c223d3e4-46a2-4e9a-b902-efd71aca8c03)<br/><br/>
ì‚¬ìš©ìê°€ ìƒí’ˆ ë“±ë¡ í¼ì—ì„œ ì •ìƒ ë²”ìœ„ì˜ ë°ì´í„°ë¥¼ ì…ë ¥í•˜ë©´, ì„œë²„ì—ì„œëŠ” ê²€ì¦ ë¡œì§ì´ í†µê³¼í•˜ê³ , ìƒí’ˆì„ ì €ì¥í•˜ê³ ,<br/>
ìƒí’ˆ ìƒì„¸ í™”ë©´ìœ¼ë¡œ redirectí•œë‹¤.<br/><br/>
### ìƒí’ˆ ì €ì¥ ê²€ì¦ ì‹¤íŒ¨
![image](https://github.com/jang9205/spring_study/assets/123082616/3a7e6b5d-cc2f-4c60-b93e-9d30ff26f08e)<br/><br/>
ì‚¬ìš©ìê°€ ìƒí’ˆ ë“±ë¡ í¼ì—ì„œ ê²€ì¦ ë²”ìœ„ë¥¼ ë„˜ì–´ì„  ë°ì´í„°ë¥¼ ì…ë ¥í•˜ë©´, ì„œë²„ ê²€ì¦ ë¡œì§ì´ ì‹¤íŒ¨í•œë‹¤.<br/>
ê²€ì¦ì— ì‹¤íŒ¨í•œ ê²½ìš° ê³ ê°ì—ê²Œ ë‹¤ì‹œ ìƒí’ˆ ë“±ë¡ í¼ì„ ë³´ì—¬ì£¼ê³ , ì–´ë–¤ ê°’ì„ ì˜ëª» ì…ë ¥í–ˆëŠ”ì§€ ì¹œì ˆí•˜ê²Œ ì•Œë ¤ì£¼ì–´ì•¼ í•œë‹¤.<br/><br/>
# ğŸ” ê²€ì¦ ì§ì ‘ ì²˜ë¦¬ - ê°œë°œ
### ìƒí’ˆ ë“±ë¡ ê²€ì¦
`main/java/hello/itemservice/web/validation/ValidationItemControllerV1`
```java
    @PostMapping("/add")
    public String addItem(@ModelAttribute Item item, RedirectAttributes redirectAttributes, Model model) {

        //ê²€ì¦ ì˜¤ë¥˜ ê²°ê³¼ë¥¼ ë³´ê´€
        Map<String, String> errors = new HashMap<>();

        //ê²€ì¦ ë¡œì§
        if (!StringUtils.hasText(item.getItemName())) {
            errors.put("itemName", "ìƒí’ˆ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.");
        }
        if (item.getPrice() == null || item.getPrice() < 1000 || item.getPrice() > 1000000) {
            errors.put("price", "ê°€ê²©ì€ 1,000 ~ 1,000,000 ê¹Œì§€ í—ˆìš©ë©ë‹ˆë‹¤.");
        }
        if (item.getQuantity() == null || item.getQuantity() >= 9999) {
            errors.put("quantity", "ìˆ˜ëŸ‰ì€ ìµœëŒ€ 9,999 ê¹Œì§€ í—ˆìš©ë©ë‹ˆë‹¤.");
        }

        //íŠ¹ì • í•„ë“œê°€ ì•„ë‹Œ ë³µí•© ë£° ê²€ì¦
        if (item.getPrice() != null && item.getQuantity() != null) {
            int resultPrice = item.getPrice() * item.getQuantity();
            if (resultPrice < 10000) {
                errors.put("globalError", "ê°€ê²© * ìˆ˜ëŸ‰ì˜ í•©ì€ 10,000ì› ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤. í˜„ì¬ ê°’ = " + resultPrice);
            }
        }
        //ê²€ì¦ì— ì‹¤íŒ¨í•˜ë©´ ë‹¤ì‹œ ì…ë ¥ í¼ìœ¼ë¡œ
        if (!errors.isEmpty()) {
            log.info("errors = {}", errors);
            model.addAttribute("errors", errors);
            return "validation/v1/addForm";
        }

        //ì„±ê³µ ë¡œì§
        Item savedItem = itemRepository.save(item);
        redirectAttributes.addAttribute("itemId", savedItem.getId());
        redirectAttributes.addAttribute("status", true);
        return "redirect:/validation/v1/items/{itemId}";
    }
```
ê²€ì¦ ì‹œ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ `errors`ì— ë‹´ì•„ë‘”ë‹¤. ì´ë•Œ ì–´ë–¤ í•„ë“œì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆëŠ”ì§€ êµ¬ë¶„í•˜ê¸° ìœ„í•´ ì˜¤ë¥˜ê°€ ë°œìƒí•œ í•„ë“œëª…ì„ `key`ë¡œ ì‚¬ìš©í•œë‹¤.<br/>
íŠ¹ì • í•„ë“œë¥¼ ë„˜ì–´ì„œëŠ” ì˜¤ë¥˜ëŠ” í•„ë“œ ì´ë¦„ì„ ë„£ì„ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ `globalError`ë¼ëŠ” `key`ë¥¼ ì‚¬ìš©í•œë‹¤.<br/><br/>
ê²€ì¦ì—ì„œ ì˜¤ë¥˜ ë©”ì‹œì§€ê°€ í•˜ë‚˜ë¼ë„ ìˆìœ¼ë©´ ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ ì¶œë ¥í•˜ê¸° ìœ„í•´ `model`ì— `errors`ë¥¼ ë‹´ê³ , ì…ë ¥ í¼ì´ ìˆëŠ” ë·° í…œí”Œë¦¿ìœ¼ë¡œ ë³´ë‚¸ë‹¤.<br/><br/><br/><br/>
`resources/templates/validation/v1/addForm.html`<br/><br/>
**css ì¶”ê°€**
```html
        .field-error {
            border-color: #dc3545;
            color: #dc3545;
        }
```
<br/><br/>**ê¸€ë¡œë²Œ ì˜¤ë¥˜ ë©”ì‹œì§€**
```html
<div th:if="${errors?.containsKey('globalError')}">
    <p class="field-error" th:text="${errors['globalError']}">ì „ì²´ ì˜¤ë¥˜ ë©”ì‹œì§€</p>
</div>
```
ì˜¤ë¥˜ ë©”ì‹œì§€ëŠ” `errors`ì— ë‚´ìš©ì´ ìˆì„ ë•Œë§Œ ì¶œë ¥í•˜ë©´ ëœë‹¤.<br/>
íƒ€ì„ë¦¬í”„ì˜ `th:if`ë¥¼ ì‚¬ìš©í•˜ë©´ ì¡°ê±´ì— ë§Œì¡±í•  ë•Œë§Œ í•´ë‹¹ HTML íƒœê·¸ë¥¼ ì¶œë ¥í•  ìˆ˜ ìˆë‹¤.<br/><br/>
`errors?.`ì€ `errors`ê°€ `null`ì¼ ë•Œ `NullPointerException`ì´ ë°œìƒí•˜ëŠ” ëŒ€ì‹ , `null`ì„ ë°˜í™˜í•˜ëŠ” ë¬¸ë²•ì´ë‹¤.<br/>
`th:if`ì—ì„œ `null`ì€ ì‹¤íŒ¨ë¡œ ì²˜ë¦¬ë˜ë¯€ë¡œ ì˜¤ë¥˜ ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ì§€ ì•ŠëŠ”ë‹¤.<br/><br/>
![image](https://github.com/jang9205/spring_study/assets/123082616/f3ab499c-ad56-4b6c-bf1d-e036fd4c00b8)<br/><br/>
**í•„ë“œ ì˜¤ë¥˜ ë©”ì‹œì§€**
```html
        <div>
            <label for="itemName" th:text="#{label.item.itemName}">ìƒí’ˆëª…</label>
            <input type="text" id="itemName" th:field="*{itemName}"
                   th:class="${errors?.containsKey('itemName')} ? 'form-control field-error' : 'form-control'"
                   class="form-control" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
            <div class="field-error" th:if="${errors?.containsKey('itemName')}" th:text="${errors['itemName']}">
                ìƒí’ˆëª… ì˜¤ë¥˜
            </div>
        </div>
```
![image](https://github.com/jang9205/spring_study/assets/123082616/611b1c14-096b-4f7a-ae95-102c0d212d1e)<br/><br/>
**ë‚¨ì€ ë¬¸ì œì **<br/>
ë·° í…œí”Œë¦¿ì—ì„œ ì¤‘ë³µ ì²˜ë¦¬ê°€ ë§ê³ , íƒ€ì… ì˜¤ë¥˜ ì²˜ë¦¬ê°€ ì•ˆëœë‹¤.<br/>
ë˜í•œ, íƒ€ì… ì˜¤ë¥˜ê°€ ë°œìƒí•´ë„ ê³ ê°ì´ ì…ë ¥í•œ ë¬¸ìë¥¼ í™”ë©´ì— ë‚¨ê²¨ì•¼ í•˜ì§€ë§Œ<br/>
ì»¨íŠ¸ë¡¤ëŸ¬ê°€ í˜¸ì¶œëœë‹¤ê³  ê°€ì •í•´ë„ `Item`ì˜ `price`ëŠ” `Integer`ì´ë¯€ë¡œ ë¬¸ìë¥¼ ë³´ê´€í•  ìˆ˜ê°€ ì—†ë‹¤.<br/><br/>
ê²°êµ­ ê³ ê°ì´ ì…ë ¥í•œ ê°’ë„ ì–´ë”˜ê°€ì— ë³„ë„ë¡œ ê´€ë¦¬ê°€ ë˜ì–´ì•¼ í•œë‹¤.<br/><br/>
# ğŸ” BindingResult1
ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ê²€ì¦ ì˜¤ë¥˜ ì²˜ë¦¬ ë°©ë²•ì„ ì•Œì•„ë³¸ë‹¤.<br/><br/>
`main/java/hello/itemservice/web/validation/ValidationItemControllerV2`
```java
    @PostMapping("/add")
    public String addItemV1(@ModelAttribute Item item, BindingResult bindingResult, RedirectAttributes redirectAttributes) {

        //ê²€ì¦ ë¡œì§
        if (!StringUtils.hasText(item.getItemName())) {
            bindingResult.addError(new FieldError("item", "itemName", "ìƒí’ˆ ì´ë¦„ì€ í•„ìˆ˜ ì…ë‹ˆë‹¤."));
        }
        if (item.getPrice() == null || item.getPrice() < 1000 || item.getPrice() > 1000000) {
            bindingResult.addError(new FieldError("item", "price", "ê°€ê²©ì€ 1,000 ~ 1,000,000 ê¹Œì§€ í—ˆìš©ë©ë‹ˆë‹¤."));
        }
        if (item.getQuantity() == null || item.getQuantity() >= 9999) {
            bindingResult.addError(new FieldError("item", "quantity", "ìˆ˜ëŸ‰ì€ ìµœëŒ€ 9,999 ê¹Œì§€ í—ˆìš©ë©ë‹ˆë‹¤."));

        }

        //íŠ¹ì • í•„ë“œê°€ ì•„ë‹Œ ë³µí•© ë£° ê²€ì¦
        if (item.getPrice() != null && item.getQuantity() != null) {
            int resultPrice = item.getPrice() * item.getQuantity();
            if (resultPrice < 10000) {
                bindingResult.addError(new ObjectError("item","ê°€ê²© * ìˆ˜ëŸ‰ì˜ í•©ì€ 10,000ì› ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤. í˜„ì¬ ê°’ = " + resultPrice));
            }
        }
        //ê²€ì¦ì— ì‹¤íŒ¨í•˜ë©´ ë‹¤ì‹œ ì…ë ¥ í¼ìœ¼ë¡œ
        if (bindingResult.hasErrors()) {
            log.info("errors={}", bindingResult);
            return "validation/v2/addForm";
        }

        //ì„±ê³µ ë¡œì§
        Item savedItem = itemRepository.save(item);
        redirectAttributes.addAttribute("itemId", savedItem.getId());
        redirectAttributes.addAttribute("status", true);
        return "redirect:/validation/v2/items/{itemId}";
    }
```
`BindingResult bindingResult` íŒŒë¼ë¯¸í„°ì˜ ìœ„ì¹˜ëŠ” `@ModelAttribute Item item` ë‹¤ìŒì— ì™€ì•¼ í•œë‹¤.<br/>
ë˜í•œ, `BindingResult`ëŠ” `Model`ì— ìë™ìœ¼ë¡œ í¬í•¨ëœë‹¤.<br/><br/>
#### **í•„ë“œ ì˜¤ë¥˜ - FieldError**
```java
public FieldError(String objectName, String field, String defaultMessage) {}
```
í•„ë“œì— ì˜¤ë¥˜ê°€ ìˆìœ¼ë©´ `FieldError` ê°ì²´ë¥¼ ìƒì„±í•´ì„œ `bindingResult`ì— ë‹´ì•„ë‘ë©´ ëœë‹¤.
- `objectName`: `@ModelAttribute` ì´ë¦„
- `field`: ì˜¤ë¥˜ê°€ ë°œìƒí•œ í•„ë“œ ì´ë¦„
- `defaultMessage`: ì˜¤ë¥˜ ê¸°ë³¸ ë©”ì‹œì§€
<br/><br/>
#### ê¸€ë¡œë²Œ ì˜¤ë¥˜ - ObjectError
```java
public ObjectError(String objectName, String defaultMessage) {}
```
íŠ¹ì • í•„ë“œë¥¼ ë„˜ì–´ì„œëŠ” ì˜¤ë¥˜ê°€ ìˆìœ¼ë©´ `ObjectError` ê°ì²´ë¥¼ ìƒì„±í•´ì„œ `bindingResult`ì— ë‹´ì•„ë‘ë©´ ëœë‹¤.
- `objectName`: `@ModelAttribute`ì˜ ì´ë¦„
- `defaultMessage`: ì˜¤ë¥˜ ê¸°ë³¸ ë©”ì‹œì§€
#### 
<br/><br/>
`resources/templates/validation/v2/addForm.html`<br/><br/>
**ê¸€ë¡œë²Œ ì˜¤ë¥˜ ë©”ì‹œì§€**
```html
<div th:if="${#fields.hasGlobalErrors()}">
    <p class="field-error" th:each="err : ${#fields.globalErrors()}" th:text="${err}">ê¸€ë¡œë²Œ ì˜¤ë¥˜ ë©”ì‹œì§€</p>
</div>
```
íƒ€ì„ë¦¬í”„ëŠ” ìŠ¤í”„ë§ì˜ `BindingResult`ë¥¼ í™œìš©í•´ì„œ í¸ë¦¬í•˜ê²Œ ê²€ì¦ ì˜¤ë¥˜ë¥¼ í‘œí˜„í•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.<br/><br/>
`#fields`: `#fields`ë¡œ `BindingResult`ê°€ ì œê³µí•˜ëŠ” ê²€ì¦ ì˜¤ë¥˜ì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.<br/><br/>
**í•„ë“œ ì˜¤ë¥˜ ë©”ì‹œì§€**
```html
        <div>
            <label for="itemName" th:text="#{label.item.itemName}">ìƒí’ˆëª…</label>
            <input type="text" id="itemName" th:field="*{itemName}"
                   th:errorclass="field-error" class="form-control" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
            <div class="field-error" th:errors="*{itemName}">
                ìƒí’ˆëª… ì˜¤ë¥˜
            </div>
        </div>
```
`th:errors`: í•´ë‹¹ í•„ë“œì— ì˜¤ë¥˜ê°€ ìˆëŠ” ê²½ìš°ì— íƒœê·¸ë¥¼ ì¶œë ¥í•œë‹¤. `th:if`ì˜ í¸ì˜ ë²„ì „ì´ë‹¤.<br/>
`th:errorclass`: `th:field`ì—ì„œ ì§€ì •í•œ í•„ë“œì— ì˜¤ë¥˜ê°€ ìˆìœ¼ë©´ `class` ì •ë³´ë¥¼ ì¶”ê°€í•œë‹¤.<br/><br/>
**ê²€ì¦ê³¼ ì˜¤ë¥˜ ë©”ì‹œì§€ ê³µì‹ ë©”ë‰´ì–¼**<br/>
https://www.thymeleaf.org/doc/tutorials/3.0/thymeleafspring.html#validation-and-error-messages<br/><br/>
# ğŸ” BindingResult2
### BindingResult
- ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ê²€ì¦ ì˜¤ë¥˜ë¥¼ ë³´ê´€í•˜ëŠ” ê°ì²´ì´ë‹¤.
- `BindingResult`ê°€ ìˆìœ¼ë©´ `@ModelAttribute`ì— ë°ì´í„° ë°”ì¸ë”© ì‹œ ì˜¤ë¥˜ê°€ ë°œìƒí•´ë„ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ í˜¸ì¶œëœë‹¤.
<br/><br/>**ì˜ˆ) @ModelAttributeì— ë°”ì¸ë”© ì‹œ íƒ€ì… ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´?**
  - `BindingResult`ê°€ ì—†ìœ¼ë©´ -> 400 ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ í˜¸ì¶œë˜ì§€ ì•Šê³ , ì˜¤ë¥˜ í˜ì´ì§€ë¡œ ì´ë™í•œë‹¤.
  - `BindingResult`ê°€ ìˆìœ¼ë©´ -> ì˜¤ë¥˜ ì •ë³´(`FieldError`)ë¥¼ `BindingResult`ì— ë‹´ì•„ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì •ìƒ í˜¸ì¶œí•œë‹¤.
<br/><br/>
### BindingResultì— ê²€ì¦ ì˜¤ë¥˜ë¥¼ ì ìš©í•˜ëŠ” 3ê°€ì§€ ë°©ë²•
- `@ModelAttribute`ì˜ ê°ì²´ì— íƒ€ì… ì˜¤ë¥˜ ë“±ìœ¼ë¡œ ë°”ì¸ë”©ì´ ì‹¤íŒ¨í•˜ëŠ” ê²½ìš° ìŠ¤í”„ë§ì´ `FieldError`ë¥¼ ìƒì„±í•´ì„œ `BindingResult`ì— ë„£ì–´ì¤€ë‹¤.
- ê°œë°œìê°€ ì§ì ‘ ë„£ì–´ì¤€ë‹¤.
- `Validator`ë¥¼ ì‚¬ìš©í•œë‹¤.
<br/><br/>
### BindingResultì™€ Errors
`BindingResult`ëŠ” ì¸í„°í˜ì´ìŠ¤ì´ê³ , `Errors` ì¸í„°í˜ì´ìŠ¤ë¥¼ ìƒì†ë°›ê³  ìˆë‹¤.<br/>
`Errors` ì¸í„°í˜ì´ìŠ¤ëŠ” ë‹¨ìˆœí•œ ì˜¤ë¥˜ ì €ì¥ê³¼ ì¡°íšŒ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.<br/>
`BindingResult`ëŠ” ì—¬ê¸°ì— ë”í•´ì„œ ì¶”ê°€ì ì¸ ê¸°ëŠ¥ë“¤ì„ ì œê³µí•œë‹¤.<br/><br/>
ì£¼ë¡œ ê´€ë¡€ìƒ `BindingResult`ë¥¼ ë§ì´ ì‚¬ìš©í•œë‹¤.<br/><br/>
# ğŸ” FieldError, ObjectError
ì˜¤ë¥˜ê°€ ë°œìƒí•˜ëŠ” ê²½ìš° ê³ ê°ì´ ì…ë ¥í•œ ë‚´ìš©ì´ ëª¨ë‘ ì‚¬ë¼ì§€ëŠ”ë° ì´ ë¬¸ì œë¥¼ í•´ê²°í•´ë³´ì.<br/><br/>
`main/java/hello/itemservice/web/validation/ValidationItemControllerV2`
```java
    @PostMapping("/add")
    public String addItemV2(@ModelAttribute Item item, BindingResult bindingResult, RedirectAttributes redirectAttributes) {

        //ê²€ì¦ ë¡œì§
        if (!StringUtils.hasText(item.getItemName())) {
            bindingResult.addError(new FieldError("item", "itemName", item.getItemName(), false, null, null, "ìƒí’ˆ ì´ë¦„ì€ í•„ìˆ˜ ì…ë‹ˆë‹¤."));
        }
        if (item.getPrice() == null || item.getPrice() < 1000 || item.getPrice() > 1000000) {
            bindingResult.addError(new FieldError("item", "price", item.getPrice(), false, null, null, "ê°€ê²©ì€ 1,000 ~ 1,000,000 ê¹Œì§€ í—ˆìš©ë©ë‹ˆë‹¤."));
        }
        if (item.getQuantity() == null || item.getQuantity() >= 9999) {
            bindingResult.addError(new FieldError("item", "quantity", item.getQuantity(), false, null, null, "ìˆ˜ëŸ‰ì€ ìµœëŒ€ 9,999 ê¹Œì§€ í—ˆìš©ë©ë‹ˆë‹¤."));

        }

        //íŠ¹ì • í•„ë“œê°€ ì•„ë‹Œ ë³µí•© ë£° ê²€ì¦
        if (item.getPrice() != null && item.getQuantity() != null) {
            int resultPrice = item.getPrice() * item.getQuantity();
            if (resultPrice < 10000) {
                bindingResult.addError(new ObjectError("item", null, null, "ê°€ê²© * ìˆ˜ëŸ‰ì˜ í•©ì€ 10,000ì› ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤. í˜„ì¬ ê°’ = " + resultPrice));
            }
        }
...
```
### FieldError ìƒì„±ì
`FieldError`ëŠ” ë‘ ê°€ì§€ ìƒì„±ìë¥¼ ì œê³µí•œë‹¤.
```java
public FieldError(String objectName, String field, String defaultMessage);
public FieldError(String objectName, String field, @Nullable Object rejectedValue, boolean bindingFailure, 
@Nullable String[] codes, @Nullable Object[] arguments, @Nullable String defaultMessage)
```
íŒŒë¼ë¯¸í„° ëª©ë¡
- `objectName`: ì˜¤ë¥˜ê°€ ë°œìƒí•œ ê°ì²´ ì´ë¦„
- `field`: ì˜¤ë¥˜ í•„ë“œ
- `rejectedValue`: ì‚¬ìš©ìê°€ ì…ë ¥í•œ ê°’(ê±°ì ˆëœ ê°’)
- `bindingFailure`: íƒ€ì… ì˜¤ë¥˜ ê°™ì€ ë°”ì¸ë”© ì‹¤íŒ¨ì¸ì§€, ê²€ì¦ ì‹¤íŒ¨ì¸ì§€ êµ¬ë¶„ ê°’
- `codes`: ë©”ì‹œì§€ ì½”ë“œ
- `arguments`: ë©”ì‹œì§€ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì¸ì
- `defaultMessage`: ê¸°ë³¸ ì˜¤ë¥˜ ë©”ì‹œì§€
<br/><br/>`ObjectError`ë„ ìœ ì‚¬í•˜ê²Œ ë‘ ê°€ì§€ ìƒì„±ìë¥¼ ì œê³µí•œë‹¤.<br/><br/>
### ì˜¤ë¥˜ ë°œìƒ ì‹œ ì‚¬ìš©ì ì…ë ¥ ê°’ ìœ ì§€
```java
new FieldError("item", "price", item.getPrice(), false, null, null, "ê°€ê²©ì€ 1,000 ~ 1,000,000 ê¹Œì§€ í—ˆìš©ë©ë‹ˆë‹¤.")
```
`FieldError`ëŠ” ì˜¤ë¥˜ ë°œìƒ ì‹œ ì‚¬ìš©ì ì…ë ¥ ê°’ì„ ì €ì¥í•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.<br/>
`rejectedValue`ê°€ ë°”ë¡œ ì˜¤ë¥˜ ë°œìƒ ì‹œ ì‚¬ìš©ì ì…ë ¥ ê°’ì„ ì €ì¥í•˜ëŠ” í•„ë“œë‹¤.<br/><br/>
`bindingFailure`ëŠ” íƒ€ì… ì˜¤ë¥˜ ê°™ì€ ë°”ì¸ë”©ì´ ì‹¤íŒ¨í–ˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ì ì–´ì£¼ë©´ ëœë‹¤.<br/>
ì—¬ê¸°ì„œëŠ” ë°”ì¸ë”©ì´ ì‹¤íŒ¨í•œ ê²ƒì€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— `false`ë¥¼ ì‚¬ìš©í•œë‹¤.<br/><br/>
### íƒ€ì„ë¦¬í”„ì˜ ì‚¬ìš©ì ì…ë ¥ ê°’ ìœ ì§€
```html
th:field="*{price}"
```
íƒ€ì„ë¦¬í”„ì˜ `th:field`ëŠ” ë§¤ìš° ë˜‘ë˜‘í•˜ê²Œ ë™ì‘í•˜ëŠ”ë°, ì •ìƒ ìƒí™©ì—ëŠ” ëª¨ë¸ ê°ì²´ì˜ ê°’ì„ ì‚¬ìš©í•˜ì§€ë§Œ,<br/>
ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ `FieldError`ì—ì„œ ë³´ê´€í•œ ê°’ì„ ì‚¬ìš©í•´ì„œ ê°’ì„ ì¶œë ¥í•œë‹¤.<br/><br/>
### ìŠ¤í”„ë§ì˜ ë°”ì¸ë”© ì˜¤ë¥˜ ì²˜ë¦¬
íƒ€ì… ì˜¤ë¥˜ë¡œ ë°”ì¸ë”©ì— ì‹¤íŒ¨í•˜ë©´ ìŠ¤í”„ë§ì€ `FieldError`ë¥¼ ìƒì„±í•˜ë©´ì„œ ì‚¬ìš©ìê°€ ì…ë ¥í•œ ê°’ì„ ë„£ì–´ë‘”ë‹¤.<br/>
ê·¸ë¦¬ê³  í•´ë‹¹ ì˜¤ë¥˜ë¥¼ `BindingResult`ì— ë‹´ì•„ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í˜¸ì¶œí•œë‹¤.<br/>
ë”°ë¼ì„œ íƒ€ì… ì˜¤ë¥˜ ê°™ì€ ë°”ì¸ë”© ì‹¤íŒ¨ ì‹œì—ë„ ì‚¬ìš©ìì˜ ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ ì •ìƒ ì¶œë ¥í•  ìˆ˜ ìˆë‹¤.<br/><br/>
# ğŸ” ì˜¤ë¥˜ ì½”ë“œì™€ ë©”ì‹œì§€ ì²˜ë¦¬1
`FieldError`, `ObjectError`ì˜ ìƒì„±ìëŠ” `codes`, `arguments`ë¥¼ ì œê³µí•œë‹¤.<br/>
ì´ê²ƒì€ ì˜¤ë¥˜ ë°œìƒ ì‹œ ì˜¤ë¥˜ ì½”ë“œë¡œ ë©”ì‹œì§€ë¥¼ ì°¾ê¸° ìœ„í•´ ì‚¬ìš©ëœë‹¤.<br/><br/>
### errors ë©”ì‹œì§€ íŒŒì¼ ìƒì„±
`messages.properties`ë¥¼ ì‚¬ìš©í•´ë„ ë˜ì§€ë§Œ, ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ êµ¬ë¶„í•˜ê¸° ì‰½ê²Œ `errors.properties`ë¼ëŠ” ë³„ë„ì˜ íŒŒì¼ë¡œ ê´€ë¦¬í•œë‹¤.<br/><br/>
ë¨¼ì € ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ í•´ë‹¹ ë©”ì‹œì§€ íŒŒì¼ì„ ì¸ì‹í•  ìˆ˜ ìˆê²Œ ë‹¤ìŒ ì„¤ì •ì„ ì¶”ê°€í•œë‹¤.<br/>
ì´ë ‡ê²Œ í•˜ë©´ `messages.properties`, `errors.properties` ë‘ íŒŒì¼ì„ ëª¨ë‘ ì¸ì‹í•œë‹¤.<br/><br/>
#### ìŠ¤í”„ë§ ë¶€íŠ¸ ë©”ì‹œì§€ ì„¤ì • ì¶”ê°€
`application.properties`
```properties
spring.messages.basename=messages,errors
```
#### errors.properties ì¶”ê°€
`resources/errors.properties`
```properties
required.item.itemName=ìƒí’ˆ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.
range.item.price=ê°€ê²©ì€ {0} ~ {1} ê¹Œì§€ í—ˆìš©í•©ë‹ˆë‹¤.
max.item.quantity=ìˆ˜ëŸ‰ì€ ìµœëŒ€ {0} ê¹Œì§€ í—ˆìš©í•©ë‹ˆë‹¤.
totalPriceMin=ê°€ê²© * ìˆ˜ëŸ‰ì˜ í•©ì€ {0}ì› ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤. í˜„ì¬ ê°’ = {1}
```
#### Controller ìˆ˜ì •
`main/java/hello/itemservice/web/validation/ValidationItemControllerV2`
```java
@PostMapping("/add")
public String addItemV3(@ModelAttribute Item item, BindingResult bindingResult, RedirectAttributes redirectAttributes) {
  ...
    bindingResult.addError(new FieldError("item", "itemName", item.getItemName(), false, new String[]{"required.item.itemName"}, null, null));
  ...
    bindingResult.addError(new FieldError("item", "price", item.getPrice(), false, new String[]{"range.item.price"}, new Object[]{1000, 1000000}, null));
  ...
    bindingResult.addError(new FieldError("item", "quantity", item.getQuantity(), false, new String[]{"max.item.quantity"}, new Object[]{9999}, null));
  ...
      bindingResult.addError(new ObjectError("item", new String[]{"totalPriceMin"}, new Object[]{10000, resultPrice}, null));
  ...
```
- `codes`: `required.item.itemName`ë¥¼ ì‚¬ìš©í•´ì„œ ë©”ì‹œì§€ ì½”ë“œë¥¼ ì§€ì •í•œë‹¤. ë©”ì‹œì§€ ì½”ë“œëŠ” í•˜ë‚˜ê°€ ì•„ë‹ˆë¼ ë°°ì—´ë¡œ ì—¬ëŸ¬ ê°’ì„ ì „ë‹¬í•  ìˆ˜ ìˆëŠ”ë°, ìˆœì„œëŒ€ë¡œ ë§¤ì¹­í•´ì„œ ì²˜ìŒ ë§¤ì¹­ë˜ëŠ” ë©”ì‹œì§€ê°€ ì‚¬ìš©ëœë‹¤.
- `arguments`: `Object[]{1000, 1000000}`ë¥¼ ì‚¬ìš©í•´ì„œ ì½”ë“œì˜ `{0}`, `{1}`ë¡œ ì¹˜í™˜í•  ê°’ì„ ì „ë‹¬í•œë‹¤.
<br/><br/>
# ğŸ” ì˜¤ë¥˜ ì½”ë“œì™€ ë©”ì‹œì§€ ì²˜ë¦¬2
ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ `BindingResult`ëŠ” ê²€ì¦í•´ì•¼ í•  ê°ì²´ì¸ `target` ë°”ë¡œ ë‹¤ìŒì— ì˜¨ë‹¤.<br/>
ë”°ë¼ì„œ `BindingResult`ëŠ” ì´ë¯¸ ë³¸ì¸ì´ ê²€ì¦í•´ì•¼ í•  ê°ì²´ì¸ `target`ì„ ì•Œê³  ìˆë‹¤.<br/><br/>
### rejectValue(), reject()
`BindingResult`ê°€ ì œê³µí•˜ëŠ” `rejectValue()`, `reject()`ë¥¼ ì‚¬ìš©í•˜ë©´ `FieldError`, `ObjectError`ë¥¼ ì§ì ‘ ìƒì„±í•˜ì§€ ì•Šê³ , ê¹”ë”í•˜ê²Œ ê²€ì¦ ì˜¤ë¥˜ë¥¼ ë‹¤ë£° ìˆ˜ ìˆë‹¤.<br/>
`rejectValue()`, `reject()`ë¥¼ ì‚¬ìš©í•´ì„œ ê¸°ì¡´ ì½”ë“œë¥¼ ë‹¨ìˆœí™”í•´ë³´ì.<br/><br/>
`main/java/hello/itemservice/web/validation/ValidationItemControllerV2`
```java
@PostMapping("/add")
public String addItemV4(@ModelAttribute Item item, BindingResult bindingResult, RedirectAttributes redirectAttributes) {
  ...
    bindingResult.rejectValue("itemName", "required");
  ...
    bindingResult.rejectValue("price", "range", new Object[]{1000, 1000000}, null);
  ...
    bindingResult.rejectValue("quantity", "max", new Object[]{9999}, null);
  ...
      bindingResult.reject("totalPriceMin", new Object[]{10000, resultPrice}, null);
  ...
```
#### rejectValue(), reject()
```java
void rejectValue(@Nullable String field, String errorCode, @Nullable Object[] errorArgs, @Nullable String defaultMessage);

void reject(String errorCode, @Nullable Object[] errorArgs, @Nullable String defaultMessage);
```
- `field`: ì˜¤ë¥˜ í•„ë“œëª…
- `errorCode`: ì˜¤ë¥˜ ì½”ë“œ(messageResolverë¥¼ ìœ„í•œ ì˜¤ë¥˜ ì½”ë“œì´ë‹¤.)
- `errorArgs`: ì˜¤ë¥˜ ë©”ì‹œì§€ì—ì„œ `{0}`ì„ ì¹˜í™˜í•˜ê¸° ìœ„í•œ ê°’
- `defaultMessage`: ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ì„ ë•Œ ì‚¬ìš©í•˜ëŠ” ê¸°ë³¸ ë©”ì‹œì§€
<br/><br/>
# ğŸ” ì˜¤ë¥˜ ì½”ë“œì™€ ë©”ì‹œì§€ ì²˜ë¦¬3
ì˜¤ë¥˜ ì½”ë“œë¥¼ ë§Œë“¤ ë•Œ ë‹¤ìŒê³¼ ê°™ì´ ìì„¸íˆ ë§Œë“¤ ìˆ˜ë„ ìˆê³ ,<br/>
`required.item.itemName`: ìƒí’ˆ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.<br/><br/>
ë˜ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë‹¨ìˆœí•˜ê²Œ ë§Œë“¤ ìˆ˜ë„ ìˆë‹¤.<br/>
`required`: í•„ìˆ˜ ê°’ì…ë‹ˆë‹¤.<br/><br/>
ê°€ì¥ ì¢‹ì€ ë°©ë²•ì€ ë²”ìš©ì„±ìœ¼ë¡œ ì‚¬ìš©í•˜ë‹¤ê°€, ì„¸ë°€í•˜ê²Œ ì‘ì„±í•´ì•¼ í•˜ëŠ” ê²½ìš°ì—ëŠ” ì„¸ë°€í•œ ë‚´ìš©ì´ ì ìš©ë˜ë„ë¡ ë©”ì‹œì§€ì— ë‹¨ê³„ë¥¼ ë‘ëŠ” ë°©ë²•ì´ë‹¤.<br/><br/>
`required`ë¼ëŠ” ì˜¤ë¥˜ ì½”ë“œë¥¼ ì‚¬ìš©í•œë‹¤ê³  ê°€ì •í•´ë³´ì.<br/>
ë‹¤ìŒê³¼ ê°™ì´ `required`ë¼ëŠ” ë©”ì‹œì§€ë§Œ ìˆìœ¼ë©´ ì´ ë©”ì‹œì§€ë¥¼ ì„ íƒí•´ì„œ ì‚¬ìš©í•œë‹¤.<br/>
```properties
required: í•„ìˆ˜ ê°’ì…ë‹ˆë‹¤.
```
<br/><br/>ê·¸ëŸ°ë° ì˜¤ë¥˜ ë©”ì‹œì§€ì— `required.item.itemName`ê³¼ ê°™ì´ ê°ì²´ëª…ê³¼ í•„ë“œëª…ì„ ì¡°í•©í•œ ì„¸ë°€í•œ ë©”ì‹œì§€ ì½”ë“œê°€ ìˆìœ¼ë©´<br/> 
ì´ ë©”ì‹œì§€ë¥¼ ë†’ì€ ìš°ì„ ìˆœìœ„ë¡œ ì‚¬ìš©í•œë‹¤.
```properties
#Level1
required.item.itemName: ìƒí’ˆ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.

#Level2
required: í•„ìˆ˜ ê°’ì…ë‹ˆë‹¤.
```
<br/><br/>ìŠ¤í”„ë§ì€ `MessageCodesResolver`ë¼ëŠ” ê²ƒìœ¼ë¡œ ì´ëŸ¬í•œ ê¸°ëŠ¥ì„ ì§€ì›í•œë‹¤.<br/><br/>
# ğŸ” ì˜¤ë¥˜ ì½”ë“œì™€ ë©”ì‹œì§€ ì²˜ë¦¬4
í…ŒìŠ¤íŠ¸ ì½”ë“œë¡œ `MessageCodesResolver`ë¥¼ ì•Œì•„ë³´ì.<br/><br/>
`test/java/hello/itemservice/validation/MessageCodesResolverTest`
```java
public class MessageCodesResolverTest {

    MessageCodesResolver codesResolver = new DefaultMessageCodesResolver();

    @Test
    void messageCodesResolverObject() {
        String[] messageCodes = codesResolver.resolveMessageCodes("required", "item");
        assertThat(messageCodes).containsExactly("required.item", "required");
    }

    @Test
    void messageCodesResolverField() {
        String[] messageCodes = codesResolver.resolveMessageCodes("required", "item", "itemName", String.class);
        assertThat(messageCodes).containsExactly(
                "required.item.itemName",
                "required.itemName",
                "required.java.lang.String",
                "required"
        );
    }
}
```
`MessageCodesResolver`ëŠ” ê²€ì¦ ì˜¤ë¥˜ ì½”ë“œë¡œ ë©”ì‹œì§€ ì½”ë“œë“¤ì„ ìƒì„±í•œë‹¤.<br/><br/>
### DefaultMessageCodesResolverì˜ ê¸°ë³¸ ë©”ì‹œì§€ ìƒì„± ê·œì¹™
#### ê°ì²´ ì˜¤ë¥˜
```
ê°ì²´ ì˜¤ë¥˜ì˜ ê²½ìš° ë‹¤ìŒ ìˆœì„œë¡œ 2ê°€ì§€ ìƒì„±
1.: code + "." + object name
2.: code

ì˜ˆ) ì˜¤ë¥˜ ì½”ë“œ: required, object name: item
1.: required.item
2.: required
```
#### í•„ë“œ ì˜¤ë¥˜
```
í•„ë“œ ì˜¤ë¥˜ì˜ ê²½ìš° ë‹¤ìŒ ìˆœì„œë¡œ 4ê°€ì§€ ë©”ì‹œì§€ ì½”ë“œ ìƒì„±
1.: code + "." + object name + "." + field
2.: code + "." + field
3.: code + "." + field type
4.: code

ì˜ˆ) ì˜¤ë¥˜ ì½”ë“œ: typeMismatch, object name "user", field "age", field type: int
1. "typeMismatch.user.age"
2. "typeMismatch.age"
3. "typeMismatch.int"
4. "typeMismatch"
```
<br/><br/>
### ë™ì‘ ë°©ì‹
- `rejectValue()`, `reject()`ëŠ” ë‚´ë¶€ì—ì„œ `MessageCodesResolver`ë¥¼ ì‚¬ìš©í•œë‹¤.
- `MessageCodesResolver`ë¥¼ í†µí•´ì„œ ìƒì„±ëœ ìˆœì„œëŒ€ë¡œ ì˜¤ë¥˜ ì½”ë“œë¥¼ ë³´ê´€í•œë‹¤.
<br/><br/>
### ì˜¤ë¥˜ ë©”ì‹œì§€ ì¶œë ¥
íƒ€ì„ë¦¬í”„ í™”ë©´ì„ ë Œë”ë§ í•  ë•Œ `th:errors`ê°€ ì‹¤í–‰ëœë‹¤.<br/>
ë§Œì•½ ì´ë•Œ ì˜¤ë¥˜ê°€ ìˆë‹¤ë©´ ìƒì„±ëœ ì˜¤ë¥˜ ë©”ì‹œì§€ ì½”ë“œë¥¼ ìˆœì„œëŒ€ë¡œ ëŒì•„ê°€ë©´ì„œ ë©”ì‹œì§€ë¥¼ ì°¾ëŠ”ë‹¤.<br/>
ê·¸ë¦¬ê³  ì—†ìœ¼ë©´ ë””í´íŠ¸ ë©”ì‹œì§€ë¥¼ ì¶œë ¥í•œë‹¤.<br/><br/>
# ğŸ” ì˜¤ë¥˜ ì½”ë“œì™€ ë©”ì‹œì§€ ì²˜ë¦¬5
### ì˜¤ë¥˜ ì½”ë“œ ê´€ë¦¬ ì „ëµ
`MessageCodesResolver`ëŠ” `required.item.itemName`ì²˜ëŸ¼ êµ¬ì²´ì ì¸ ê²ƒì„ ë¨¼ì € ë§Œë“¤ì–´ì£¼ê³ , `required`ì²˜ëŸ¼ ëœ êµ¬ì²´ì ì¸ ê²ƒì„ ê°€ì¥ ë‚˜ì¤‘ì— ë§Œë“ ë‹¤.<br/><br/>
í¬ê²Œ ì¤‘ìš”í•˜ì§€ ì•Šì€ ë©”ì‹œì§€ëŠ” ë²”ìš©ì„± ìˆëŠ” `requried` ê°™ì€ ë©”ì‹œì§€ë¡œ ëë‚´ê³ , ì •ë§ ì¤‘ìš”í•œ ë©”ì‹œì§€ëŠ” ê¼­ í•„ìš”í•  ë•Œ êµ¬ì²´ì ìœ¼ë¡œ ì ì–´ì„œ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì´ ë” íš¨ê³¼ì ì´ë‹¤.<br/><br/>
### ì˜¤ë¥˜ ì½”ë“œ ì „ëµ ë„ì…
`resources/errors.properties`
```properties
#required.item.itemName=ìƒí’ˆ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.
#range.item.price=ê°€ê²©ì€ {0} ~ {1} ê¹Œì§€ í—ˆìš©í•©ë‹ˆë‹¤.
#max.item.quantity=ìˆ˜ëŸ‰ì€ ìµœëŒ€ {0} ê¹Œì§€ í—ˆìš©í•©ë‹ˆë‹¤.
#totalPriceMin=ê°€ê²© * ìˆ˜ëŸ‰ì˜ í•©ì€ {0}ì› ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤. í˜„ì¬ ê°’ = {1}

#==ObjectError==
#Level1
totalPriceMin.item=ìƒí’ˆì˜ ê°€ê²© * ìˆ˜ëŸ‰ì˜ í•©ì€ {0}ì› ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤. í˜„ì¬ ê°’ = {1}

#Level2 - ìƒëµ
totalPriceMin=ì „ì²´ ê°€ê²©ì€ {0}ì› ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤. í˜„ì¬ ê°’ = {1}


#==FieldError==
#Level1
required.item.itemName=ìƒí’ˆ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.
range.item.price=ê°€ê²©ì€ {0} ~ {1} ê¹Œì§€ í—ˆìš©í•©ë‹ˆë‹¤.
max.item.quantity=ìˆ˜ëŸ‰ì€ ìµœëŒ€ {0} ê¹Œì§€ í—ˆìš©í•©ë‹ˆë‹¤.

#Level2 - ìƒëµ

#Level3
required.java.lang.String = í•„ìˆ˜ ë¬¸ìì…ë‹ˆë‹¤.
required.java.lang.Integer = í•„ìˆ˜ ìˆ«ìì…ë‹ˆë‹¤.
min.java.lang.String = {0} ì´ìƒì˜ ë¬¸ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.
min.java.lang.Integer = {0} ì´ìƒì˜ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.
range.java.lang.String = {0} ~ {1} ê¹Œì§€ì˜ ë¬¸ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.
range.java.lang.Integer = {0} ~ {1} ê¹Œì§€ì˜ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.
max.java.lang.String = {0} ê¹Œì§€ì˜ ë¬¸ìë¥¼ í—ˆìš©í•©ë‹ˆë‹¤.
max.java.lang.Integer = {0} ê¹Œì§€ì˜ ìˆ«ìë¥¼ í—ˆìš©í•©ë‹ˆë‹¤.

#Level4
required = í•„ìˆ˜ ê°’ ì…ë‹ˆë‹¤.
min= {0} ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.
range= {0} ~ {1} ë²”ìœ„ë¥¼ í—ˆìš©í•©ë‹ˆë‹¤.
max= {0} ê¹Œì§€ í—ˆìš©í•©ë‹ˆë‹¤.
```
`itemName`ì˜ ê²½ìš° `required` ê²€ì¦ ì˜¤ë¥˜ ë©”ì‹œì§€ê°€ ë°œìƒí•˜ë©´ ë‹¤ìŒ ì½”ë“œ ìˆœì„œëŒ€ë¡œ ë©”ì‹œì§€ê°€ ìƒì„±ëœë‹¤.
1. `required.item.itemName`
2. `required.itemName`
3. `required.java.lang.String`
4. `required`
<br/><br/>ì´ë ‡ê²Œ ìƒì„±ëœ ë©”ì‹œì§€ ì½”ë“œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìˆœì„œëŒ€ë¡œ `MessageSource`ì—ì„œ ë©”ì‹œì§€ì—ì„œ ì°¾ëŠ”ë‹¤.<br/><br/>
### ValidationUtils
#### ValidationUtils ì‚¬ìš© ì „
```java
if (!StringUtils.hasText(item.getItemName())) {
  bindingResult.rejectValue("itemName", "required");
}
```
#### ValidationUtils ì‚¬ìš© í›„
```java
ValidationUtils.rejectIfEmptyOrWhitespace(bindingResult, "itemName", "required");
```
ë‹¤ìŒê³¼ ê°™ì´ í•œì¤„ë¡œ ê°€ëŠ¥, ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì€ Empty , ê³µë°± ê°™ì€ ë‹¨ìˆœí•œ ê¸°ëŠ¥ë§Œ ì œê³µ<br/><br/>
**ì •ë¦¬**
1. `rejectValue()` í˜¸ì¶œ
2. `MessageCodesResolver`ë¥¼ ì‚¬ìš©í•´ì„œ ê²€ì¦ ì˜¤ë¥˜ ì½”ë“œë¡œ ë©”ì‹œì§€ ì½”ë“œë“¤ì„ ìƒì„±
3. `new FieldError()`ë¥¼ ìƒì„±í•˜ë©´ì„œ ë©”ì‹œì§€ ì½”ë“œë“¤ì„ ë³´ê´€
4. `th:errors`ì—ì„œ ë©”ì‹œì§€ ì½”ë“œë“¤ë¡œ ë©”ì‹œì§€ë¥¼ ìˆœì„œëŒ€ë¡œ ë©”ì‹œì§€ì—ì„œ ì°¾ê³ , ë…¸ì¶œ
<br/><br/>
# ğŸ” ì˜¤ë¥˜ ì½”ë“œì™€ ë©”ì‹œì§€ ì²˜ë¦¬6
### ìŠ¤í”„ë§ì´ ì§ì ‘ ë§Œë“  ì˜¤ë¥˜ ë©”ì‹œì§€ ì²˜ë¦¬
ê²€ì¦ ì˜¤ë¥˜ ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ì´ 2ê°€ì§€ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤.
- ê°œë°œìê°€ ì§ì ‘ ì„¤ì •í•œ ì˜¤ë¥˜ ì½”ë“œ -> `rejectValue()`ë¥¼ ì§ì ‘ í˜¸ì¶œ
- ìŠ¤í”„ë§ì´ ì§ì ‘ ê²€ì¦ ì˜¤ë¥˜ì— ì¶”ê°€í•œ ê²½ìš°(ì£¼ë¡œ íƒ€ì… ì •ë³´ê°€ ë§ì§€ ì•ŠìŒ)
#### 
ì•„ì§ì€ íƒ€ì… ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ ë©”ì‹œì§€ ì½”ë“œê°€ ì—†ê¸° ë•Œë¬¸ì— ìŠ¤í”„ë§ì´ ìƒì„±í•œ ê¸°ë³¸ ë©”ì‹œì§€ê°€ ì¶œë ¥ëœë‹¤.<br/><br/>
![image](https://github.com/jang9205/spring_study/assets/123082616/72c06b09-89a2-4830-850f-18ea76facea1)<br/><br/>
ìŠ¤í”„ë§ì€ íƒ€ì… ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ `typeMismatch`ë¼ëŠ” ì˜¤ë¥˜ ì½”ë“œë¥¼ ì‚¬ìš©í•œë‹¤.<br/><br/>
`error.properties`ì— ë‹¤ìŒ ë‚´ìš©ì„ ì¶”ê°€í•˜ì.
```properties
#ì¶”ê°€
typeMismatch.java.lang.Integer=ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.
typeMismatch=íƒ€ì… ì˜¤ë¥˜ì…ë‹ˆë‹¤.
```
![image](https://github.com/jang9205/spring_study/assets/123082616/43fb4a80-9e78-4ded-8a82-39ab7908ea9f)<br/><br/>
# ğŸ” Validator ë¶„ë¦¬1
ë³µì¡í•œ ê²€ì¦ ë¡œì§ì„ ë³„ë„ë¡œ ë¶„ë¦¬í•˜ì.<br/><br/>
`main/java/hello/itemservice/web/validation/ItemValidator`
```java
@Component
public class ItemValidator implements Validator {
    @Override
    public boolean supports(Class<?> clazz) {
        return Item.class.isAssignableFrom(clazz);
        //item == clazz
        //item == subItem
    }

    @Override
    public void validate(Object target, Errors errors) {
        Item item = (Item) target;

        //ê²€ì¦ ë¡œì§
        ...
        }
    }
}
```
<br/><br/>ìŠ¤í”„ë§ì€ ê²€ì¦ì„ ì²´ê³„ì ìœ¼ë¡œ ì œê³µí•˜ê¸° ìœ„í•´ `Validator` ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•œë‹¤.
```java
public interface Validator {
    boolean supports(Class<?> clazz);
    void validate(Object target, Errors errors);
}
```
`supports() {}`: í•´ë‹¹ ê²€ì¦ê¸°ë¥¼ ì§€ì›í•˜ëŠ” ì—¬ë¶€ í™•ì¸<br/>
`validate(Object target, Errors errors)`: ê²€ì¦ ëŒ€ìƒ ê°ì²´ì™€ `BindingResult`<br/><br/>
#### ItemValidator ì§ì ‘ í˜¸ì¶œí•˜ê¸°
`main/java/hello/itemservice/web/validation/ValidationItemControllerV2`
```java
    ...
    private final ItemValidator itemValidator;
    ...

    @PostMapping("/add")
    public String addItemV5(@ModelAttribute Item item, BindingResult bindingResult, RedirectAttributes redirectAttributes) {

        itemValidator.validate(item, bindingResult);

        //ê²€ì¦ì— ì‹¤íŒ¨í•˜ë©´ ë‹¤ì‹œ ì…ë ¥ í¼ìœ¼ë¡œ
        if (bindingResult.hasErrors()) {
            log.info("errors={}", bindingResult);
            return "validation/v2/addForm";
        }

        //ì„±ê³µ ë¡œì§
        Item savedItem = itemRepository.save(item);
        redirectAttributes.addAttribute("itemId", savedItem.getId());
        redirectAttributes.addAttribute("status", true);
        return "redirect:/validation/v2/items/{itemId}";
    }
```
`ItemValidator`ë¥¼ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ì£¼ì…ë°›ì•„ì„œ ì§ì ‘ í˜¸ì¶œí–ˆë‹¤.<br/><br/>
# ğŸ” Validator ë¶„ë¦¬2
`Validator` ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•´ì„œ ê²€ì¦ê¸°ë¥¼ ë§Œë“¤ë©´ ìŠ¤í”„ë§ì˜ ì¶”ê°€ì ì¸ ë„ì›€ì„ ë°›ì„ ìˆ˜ ìˆë‹¤.<br/><br/>
### WebDataBinderë¥¼ í†µí•´ì„œ ì‚¬ìš©í•˜ê¸°
`WebDataBinder`ëŠ” ìŠ¤í”„ë§ì˜ íŒŒë¼ë¯¸í„° ë°”ì¸ë”©ì˜ ì—­í• ì„ í•´ì£¼ê³  ê²€ì¦ ê¸°ëŠ¥ë„ ë‚´ë¶€ì— í¬í•¨í•œë‹¤.<br/><br/>
`main/java/hello/itemservice/web/validation/ValidationItemControllerV2`
```java
    @InitBinder
    public void init(WebDataBinder dataBinder) {
        dataBinder.addValidators(itemValidator);
    }
```
ì´ë ‡ê²Œ `WebDataBinder`ì— ê²€ì¦ê¸°ë¥¼ ì¶”ê°€í•˜ë©´ í•´ë‹¹ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œëŠ” ê²€ì¦ê¸°ë¥¼ ìë™ìœ¼ë¡œ ì ìš©í•  ìˆ˜ ìˆë‹¤.<br/>
`@InitBinder`: í•´ë‹¹ ì»¨íŠ¸ë¡¤ëŸ¬ì—ë§Œ ì˜í–¥ì„ ì¤€ë‹¤. ê¸€ë¡œë²Œ ì„¤ì •ì€ ë³„ë„ë¡œ í•´ì•¼í•œë‹¤.<br/><br/>
### @Validated ì ìš©
`main/java/hello/itemservice/web/validation/ValidationItemControllerV2`
```java
    @PostMapping("/add")
    public String addItemV6(@Validated @ModelAttribute Item item, BindingResult bindingResult, RedirectAttributes redirectAttributes) {

        //ê²€ì¦ì— ì‹¤íŒ¨í•˜ë©´ ë‹¤ì‹œ ì…ë ¥ í¼ìœ¼ë¡œ
        if (bindingResult.hasErrors()) {
            log.info("errors={}", bindingResult);
            return "validation/v2/addForm";
        }

        //ì„±ê³µ ë¡œì§
        Item savedItem = itemRepository.save(item);
        redirectAttributes.addAttribute("itemId", savedItem.getId());
        redirectAttributes.addAttribute("status", true);
        return "redirect:/validation/v2/items/{itemId}";
    }
```
validatorë¥¼ ì§ì ‘ í˜¸ì¶œí•˜ëŠ” ë¶€ë¶„ì´ ì‚¬ë¼ì§€ê³ , ëŒ€ì‹ ì— ê²€ì¦ ëŒ€ìƒ ì•ì— `@Validated`ê°€ ë¶™ì—ˆë‹¤.<br/><br/>
### ë™ì‘ ë°©ì‹
`@Validated`ëŠ” ê²€ì¦ê¸°ë¥¼ ì‹¤í–‰í•˜ë¼ëŠ” ì• ë…¸í…Œì´ì…˜ì´ë‹¤.<br/>
ì´ ì• ë…¸í…Œì´ì…˜ì´ ë¶™ìœ¼ë©´ ì•ì„œ `WebDataBinder`ì— ë“±ë¡í•œ ê²€ì¦ê¸°ë¥¼ ì°¾ì•„ì„œ ì‹¤í–‰í•œë‹¤.<br/>
ê·¸ëŸ°ë° ì—¬ëŸ¬ ê²€ì¦ê¸°ë¥¼ ë“±ë¡í•œë‹¤ë©´ ê·¸ ì¤‘ì— ì–´ë–¤ ê²€ì¦ê¸°ê°€ ì‹¤í–‰ë˜ì–´ì•¼ í• ì§€ êµ¬ë¶„ì´ í•„ìš”í•˜ë‹¤. ì´ë•Œ `supports()`ê°€ ì‚¬ìš©ëœë‹¤.<br/><br/>
ì—¬ê¸°ì„œëŠ” `supports(Item.class)`ê°€ í˜¸ì¶œë˜ê³ , ê²°ê³¼ê°€ `true`ì´ë¯€ë¡œ `ItemValidator`ì˜ `validate()`ê°€ í˜¸ì¶œëœë‹¤.<br/><br/>
### ê¸€ë¡œë²Œ ì„¤ì • - ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ì— ë‹¤ ì ìš©
`main/java/hello/itemservice/ItemServiceApplication`
```java
@SpringBootApplication
public class ItemServiceApplication implements WebMvcConfigurer {

	public static void main(String[] args) {
		SpringApplication.run(ItemServiceApplication.class, args);
	}

	@Override
	public Validator getValidator() {
		return new ItemValidator();
	}
}
```
ê¸°ì¡´ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ `@InitBinder`ë¥¼ ì œê±°í•´ë„ ê¸€ë¡œë²Œ ì„¤ì •ìœ¼ë¡œ ì •ìƒ ë™ì‘í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
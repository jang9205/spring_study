# ğŸ“– ë¡œê·¸ì¸ ì²˜ë¦¬2 - í•„í„°, ì¸í„°ì…‰í„°
<br/><br/>
# ğŸ” ì„œë¸”ë¦¿ í•„í„° - ì†Œê°œ
### ê³µí†µ ê´€ì‹¬ ì‚¬í•­
ìš”êµ¬ì‚¬í•­ì„ ë³´ë©´ ë¡œê·¸ì¸ í•œ ì‚¬ìš©ìë§Œ ìƒí’ˆ ê´€ë¦¬ í˜ì´ì§€ì— ë“¤ì–´ê°ˆ ìˆ˜ ìˆì–´ì•¼ í•œë‹¤. ê·¸ëŸ°ë° ë¡œê·¸ì¸í•˜ì§€ ì•Šì€ ì‚¬ìš©ìë„ URLì„ ì§ì ‘ í˜¸ì¶œí•˜ë©´ ìƒí’ˆ ê´€ë¦¬ í™”ë©´ì— ë“¤ì–´ê°ˆ ìˆ˜ ìˆë‹¤.<br/><br/>
ë“±ë¡, ìˆ˜ì •, ì‚­ì œ, ì¡°íšŒ ë“± ìƒí’ˆê´€ë¦¬ì˜ ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ ë¡œì§ì— ê³µí†µìœ¼ë¡œ ë¡œê·¸ì¸ ì—¬ë¶€ë¥¼ í™•ì¸í•´ì•¼ í•œë‹¤.<br/><br/>
ì´ë ‡ê²Œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì—¬ëŸ¬ ë¡œì§ì—ì„œ ê³µí†µìœ¼ë¡œ ê´€ì‹¬ì´ ìˆëŠ” ìˆëŠ” ê²ƒì„ **ê³µí†µ ê´€ì‹¬ì‚¬**(cross-cutting concern)ë¼ê³  í•œë‹¤. ì—¬ê¸°ì„œëŠ” ë“±ë¡, ìˆ˜ì •, ì‚­ì œ, ì¡°íšŒ ë“± ì—¬ëŸ¬ ë¡œì§ì—ì„œ ê³µí†µìœ¼ë¡œ ì¸ì¦ì— ëŒ€í•´ì„œ ê´€ì‹¬ì„ ê°€ì§€ê³  ìˆë‹¤.<br/><br/>
ì´ëŸ¬í•œ ê³µí†µ ê´€ì‹¬ì‚¬ëŠ” ìŠ¤í”„ë§ì˜ AOPë¡œë„ í•´ê²°í•  ìˆ˜ ìˆì§€ë§Œ, ì›¹ê³¼ ê´€ë ¨ëœ ê³µí†µ ê´€ì‹¬ì‚¬ëŠ” ì§€ê¸ˆë¶€í„° ì„¤ëª…í•  ì„œë¸”ë¦¿ í•„í„° ë˜ëŠ” ìŠ¤í”„ë§ ì¸í„°ì…‰í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. ì›¹ê³¼ ê´€ë ¨ëœ ê³µí†µ ê´€ì‹¬ì‚¬ë¥¼ ì²˜ë¦¬í•  ë•ŒëŠ” HTTPì˜ í—¤ë”ë‚˜ URLì˜ ì •ë³´ë“¤ì´ í•„ìš”í•œë°, ì„œë¸”ë¦¿ í•„í„°ë‚˜ ìŠ¤í”„ë§ ì¸í„°ì…‰í„°ëŠ” `HttpServletRequest`ë¥¼ ì œê³µí•œë‹¤.<br/><br/>
### ì„œë¸”ë¦¿ í•„í„° ì†Œê°œ
í•„í„°ëŠ” ì„œë¸”ë¦¿ì´ ì§€ì›í•˜ëŠ” ìˆ˜ë¬¸ì¥ì´ë‹¤.<br/><br/>
#### í•„í„° íë¦„
```
HTTP ìš”ì²­ -> WAS -> í•„í„° -> ì„œë¸”ë¦¿ -> ì»¨íŠ¸ë¡¤ëŸ¬
```
í•„í„°ë¥¼ ì ìš©í•˜ë©´ í•„í„°ê°€ í˜¸ì¶œëœ ë‹¤ìŒì— ì„œë¸”ë¦¿ì´ í˜¸ì¶œëœë‹¤.<br/>
í•„í„°ëŠ” íŠ¹ì • URL íŒ¨í„´ì— ì ìš©í•  ìˆ˜ ìˆê³ , `/*`ì´ë¼ê³  í•˜ë©´ ëª¨ë“  ìš”ì²­ì— í•„í„°ê°€ ì ìš©ëœë‹¤.<br/>
ìŠ¤í”„ë§ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì— ì„œë¸”ë¦¿ì€ ìŠ¤í”„ë§ì˜ ë””ìŠ¤íŒ¨ì²˜ ì„œë¸”ë¦¿ìœ¼ë¡œ ìƒê°í•˜ë©´ ëœë‹¤.<br/><br/>
#### í•„í„° ì œí•œ
```
HTTP ìš”ì²­ -> WAS -> í•„í„° -> ì„œë¸”ë¦¿ -> ì»¨íŠ¸ë¡¤ëŸ¬ //ë¡œê·¸ì¸ ì‚¬ìš©ì
HTTP ìš”ì²­ -> WAS -> í•„í„°(ì ì ˆí•˜ì§€ ì•Šì€ ìš”ì²­ì´ë¼ íŒë‹¨, ì„œë¸”ë¦¿ í˜¸ì¶œX) //ë¹„ ë¡œê·¸ì¸ ì‚¬ìš©ì
```
<br/><br/>
#### í•„í„° ì²´ì¸
```
HTTP ìš”ì²­ -> WAS -> í•„í„°1 -> í•„í„°2 -> í•„í„°3 -> ì„œë¸”ë¦¿ -> ì»¨íŠ¸ë¡¤ëŸ¬
```
í•„í„°ëŠ” ì²´ì¸ìœ¼ë¡œ êµ¬ì„±ë˜ëŠ”ë°, ì¤‘ê°„ì— í•„í„°ë¥¼ ììœ ë¡­ê²Œ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.<br/>
ì˜ˆë¥¼ ë“¤ì–´ì„œ ë¡œê·¸ë¥¼ ë‚¨ê¸°ëŠ” í•„í„°ë¥¼ ë¨¼ì € ì ìš©í•˜ê³ , ê·¸ ë‹¤ìŒì— ë¡œê·¸ì¸ ì—¬ë¶€ë¥¼ ì²´í¬í•˜ëŠ” í•„í„°ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.<br/><br/>
#### í•„í„° ì¸í„°í˜ì´ìŠ¤
```java
public interface Filter {
    public default void init(FilterConfig filterConfig) throws ServletException
    {}

    public void doFilter(ServletRequest request, ServletResponse response,
                         FilterChain chain) throws IOException, ServletException;
    
    public default void destroy() {}
}
```
í•„í„° ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ê³  ë“±ë¡í•˜ë©´ ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆê°€ í•„í„°ë¥¼ ì‹±ê¸€í†¤ ê°ì²´ë¡œ ìƒì„±í•˜ê³  ê´€ë¦¬í•œë‹¤.
- `init()`: í•„í„° ì´ˆê¸°í™” ë©”ì„œë“œ, ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆê°€ ìƒì„±ë  ë•Œ í˜¸ì¶œëœë‹¤.
- `doFilter()`: ê³ ê°ì˜ ìš”ì²­ì´ ì˜¬ ë•Œ ë§ˆë‹¤ í•´ë‹¹ ë©”ì„œë“œê°€ í˜¸ì¶œëœë‹¤. í•„í„°ì˜ ë¡œì§ì„ êµ¬í˜„í•˜ë©´ ëœë‹¤.
- `destroy()`: í•„í„° ì¢…ë£Œ ë©”ì„œë“œ, ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆê°€ ì¢…ë£Œë  ë•Œ í˜¸ì¶œëœë‹¤.
<br/><br/>
# ğŸ” ì„œë¸”ë¦¿ í•„í„° - ìš”ì²­ ë¡œê·¸
### ë¡œê·¸ í•„í„°
`main/java/hello/login/web/filter/LogFilter`
```java
@Slf4j
public class LogFilter implements Filter {

    @Override
    public void init(FilterConfig filterConfig) throws ServletException {
        log.info("log filter init");
    }

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
        log.info("log filter doFilter");

        HttpServletRequest httpRequest = (HttpServletRequest) request;
        String requestURI = httpRequest.getRequestURI();

        String uuid = UUID.randomUUID().toString();

        try {
            log.info("REQUEST [{}][{}]", uuid, requestURI);
            chain.doFilter(request, response);
        } catch (Exception e) {
            throw e;
        } finally {
            log.info("RESPONSE [{}][{}]", uuid, requestURI);
        }
    }

    @Override
    public void destroy() {
        log.info("log filter destroy");
    }
}
```
- `public class LogFilter implements Filter {}`
  - í•„í„°ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ í•„í„° ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•´ì•¼ í•œë‹¤.
- `doFilter(ServletRequest request, ServletResponse response, FilterChain chain)`
  - HTTP ìš”ì²­ì´ ì˜¤ë©´ `doFilter`ê°€ í˜¸ì¶œëœë‹¤.
  - `ServletRequest request`ëŠ” HTTP ìš”ì²­ì´ ì•„ë‹Œ ê²½ìš°ê¹Œì§€ ê³ ë ¤í•´ì„œ ë§Œë“  ì¸í„°í˜ì´ìŠ¤ì´ë‹¤.
  - HTTPë¥¼ ì‚¬ìš©í•˜ë©´ `HttpServletRequest httpRequest = (HttpServletRequest) request;`ì™€ ê°™ì´ ë‹¤ìš´ ì¼€ìŠ¤íŒ… í•˜ë©´ ëœë‹¤.
- `String uuid = UUID.randomUUID().toString();`
  - HTTP ìš”ì²­ì„ êµ¬ë¶„í•˜ê¸° ìœ„í•´ ìš”ì²­ë‹¹ ì„ì˜ì˜ `uuid`ë¥¼ ìƒì„±í•´ë‘”ë‹¤.
- `log.info("REQUEST [{}][{}]", uuid, requestURI);`
  - `uuid`ì™€ `requestURI`ë¥¼ ì¶œë ¥í•œë‹¤.
- `chain.doFilter(request, response);`
  - ë‹¤ìŒ í•„í„°ê°€ ìˆìœ¼ë©´ í•„í„°ë¥¼ í˜¸ì¶œí•˜ê³ , í•„í„°ê°€ ì—†ìœ¼ë©´ ì„œë¸”ë¦¿ì„ í˜¸ì¶œí•œë‹¤. 
  - ë§Œì•½ ì´ ë¡œì§ì„ í˜¸ì¶œí•˜ì§€ ì•Šìœ¼ë©´ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤.
<br/><br/>
### í•„í„° ì„¤ì •
`main/java/hello/login/WebConfig`
```java
@Configuration
public class WebConfig {

    @Bean
    public FilterRegistrationBean logFilter() {
        FilterRegistrationBean<Filter> filterRegistrationBean = new FilterRegistrationBean<>();
        filterRegistrationBean.setFilter(new LogFilter());
        filterRegistrationBean.setOrder(1);
        filterRegistrationBean.addUrlPatterns("/*");

        return filterRegistrationBean;
    }
}
```
í•„í„°ë¥¼ ë“±ë¡í•˜ëŠ” ë°©ë²•ì€ ì—¬ëŸ¬ ê°€ì§€ê°€ ìˆì§€ë§Œ, ìŠ¤í”„ë§ ë¶€íŠ¸ë¥¼ ì‚¬ìš©í•œë‹¤ë©´ `FilterRegistrationBean`ì„ ì‚¬ìš©í•´ì„œ ë“±ë¡í•˜ë©´ ëœë‹¤.
- `setFilter(new LogFilter())`: ë“±ë¡í•  í•„í„°ë¥¼ ì§€ì •í•œë‹¤.
- `setOrder(1)`: í•„í„°ëŠ” ì²´ì¸ìœ¼ë¡œ ë™ì‘í•œë‹¤. ë”°ë¼ì„œ ìˆœì„œê°€ í•„ìš”í•˜ë‹¤. ë‚®ì„ìˆ˜ë¡ ë¨¼ì € ë™ì‘í•œë‹¤.
- `addUrlPatterns("/*")` : í•„í„°ë¥¼ ì ìš©í•  URL íŒ¨í„´ì„ ì§€ì •í•œë‹¤. í•œ ë²ˆì— ì—¬ëŸ¬ íŒ¨í„´ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤.
<br/><br/>**ì‹¤í–‰ ë¡œê·¸**<br/><br/>
![image](https://github.com/jang9205/spring_study/assets/123082616/c09f0218-ef6e-4657-a8b8-e7df035e84b6)<br/><br/>
# ğŸ” ì„œë¸”ë¦¿ í•„í„° - ì¸ì¦ ì²´í¬
ë¡œê·¸ì¸ ë˜ì§€ ì•Šì€ ì‚¬ìš©ìëŠ” ìƒí’ˆ ê´€ë¦¬ë¿ë§Œ ì•„ë‹ˆë¼ ë¯¸ë˜ì— ê°œë°œë  í˜ì´ì§€ì—ë„ ì ‘ê·¼í•˜ì§€ ëª»í•˜ë„ë¡ í•œë‹¤.<br/><br/>
### ì¸ì¦ ì²´í¬ í•„í„°
`main/java/hello/login/web/filter/LoginCheckFilter`
```java
@Slf4j
public class LoginCheckFilter implements Filter {

    private static final String[] whiteList = {"/", "/members/add", "/login", "/logout", "/css/*"};

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {

        HttpServletRequest httpRequest = (HttpServletRequest) request;
        String requestURI = httpRequest.getRequestURI();

        HttpServletResponse httpResponse = (HttpServletResponse) response;

        try {
            log.info("ì¸ì¦ ì²´í¬ í•„í„° ì‹œì‘{}", requestURI);

            if (isLoginCheckPath(requestURI)) {
                log.info("ì¸ì¦ ì²´í¬ ë¡œì§ ì‹¤í–‰ {}", requestURI);
                HttpSession session = httpRequest.getSession(false);
                if (session == null || session.getAttribute(SessionConst.LOGIN_MEMBER) == null) {

                    log.info("ë¯¸ì¸ì¦ ì‚¬ìš©ì ìš”ì²­ {}", requestURI);
                    //ë¡œê·¸ì¸ìœ¼ë¡œ redirect
                    httpResponse.sendRedirect("/login?redirectURL=" + requestURI);
                    return;
                }
            }
            chain.doFilter(request, response);
        } catch (Exception e) {
            throw e;    //ì˜ˆì™¸ ë¡œê¹… ê°€ëŠ¥í•˜ì§€ë§Œ, í†°ìº£ê¹Œì§€ ì˜ˆì™¸ë¥¼ ë³´ë‚´ì¤˜ì•¼í•¨
        } finally {
            log.info("ì¸ì¦ ì²´í¬ í•„í„° ì¢…ë£Œ {}", requestURI);
        }
    }

    /**
     * í™”ì´íŠ¸ ë¦¬ìŠ¤íŠ¸ì˜ ê²½ìš° ì¸ì¦ ì²´í¬X
     */
    private boolean isLoginCheckPath(String requestURI) {
        return !PatternMatchUtils.simpleMatch(whiteList, requestURI);
    }
}
```
- `whitelist = {"/", "/members/add", "/login", "/logout","/css/*"};`
  - ì¸ì¦ í•„í„°ë¥¼ ì ìš©í•´ë„ í™ˆ, íšŒì›ê°€ì…, ë¡œê·¸ì¸ í™”ë©´, css ê°™ì€ ë¦¬ì†ŒìŠ¤ì—ëŠ” ì ‘ê·¼í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤. í™”ì´íŠ¸ ë¦¬ìŠ¤íŠ¸ ê²½ë¡œëŠ” ì¸ì¦ê³¼ ë¬´ê´€í•˜ê²Œ í•­ìƒ í—ˆìš©í•œë‹¤.
- `isLoginCheckPath(requestURI)`
  - í™”ì´íŠ¸ ë¦¬ìŠ¤íŠ¸ë¥¼ ì œì™¸í•œ ëª¨ë“  ê²½ìš°ì— ì¸ì¦ ì²´í¬ ë¡œì§ì„ ì ìš©í•œë‹¤.
- `httpResponse.sendRedirect("/login?redirectURL=" + requestURI);`
  - í˜„ì¬ ìš”ì²­í•œ ê²½ë¡œì¸ `requestURI`ë¥¼ `/login`ì— ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¡œ í•¨ê»˜ ì „ë‹¬í•œë‹¤.  `/login` ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë¡œê·¸ì¸ ì„±ê³µ ì‹œ í•´ë‹¹ ê²½ë¡œë¡œ ë°”ë¡œ ì´ë™í•œë‹¤.
- `return;`
  - í•„í„°ë¥¼ ë”ëŠ” ì§„í–‰í•˜ì§€ ì•ŠëŠ”ë‹¤. ì´í›„ í•„í„°ëŠ” ë¬¼ë¡  ì„œë¸”ë¦¿, ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ë”ëŠ” í˜¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤. ì•ì„œ `redirect`ë¥¼ ì‚¬ìš©í–ˆê¸° ë•Œë¬¸ì— `redirect`ê°€ ì‘ë‹µìœ¼ë¡œ ì ìš©ë˜ê³  ìš”ì²­ì´ ëë‚œë‹¤.
<br/><br/>
### í•„í„° ì„¤ì •
`main/java/hello/login/WebConfig`
```java
    ...

    @Bean
    public FilterRegistrationBean loginCheckFilter() {
        FilterRegistrationBean<Filter> filterRegistrationBean = new FilterRegistrationBean<>();
        filterRegistrationBean.setFilter(new LoginCheckFilter());
        filterRegistrationBean.setOrder(2);
        filterRegistrationBean.addUrlPatterns("/*");

        return filterRegistrationBean;
    }
}
```
- `setFilter(new LoginCheckFilter())`: ë¡œê·¸ì¸ í•„í„°ë¥¼ ë“±ë¡í•œë‹¤.
- `setOrder(2)`: ìˆœì„œë¥¼ 2ë²ˆìœ¼ë¡œ ì¡ì•˜ë‹¤. ë¡œê·¸ í•„í„° ë‹¤ìŒì— ë¡œê·¸ì¸ í•„í„°ê°€ ì ìš©ëœë‹¤.
- `addUrlPatterns("/*")`: ëª¨ë“  ìš”ì²­ì— ë¡œê·¸ì¸ í•„í„°ë¥¼ ì ìš©í•œë‹¤.
<br/><br/>
### RedirectURL ì²˜ë¦¬
`main/java/hello/login/web/login/LoginController`
```java
    ...

    @PostMapping("/login")
    public String loginV4(@Validated @ModelAttribute LoginForm form, BindingResult bindingResult,
                          @RequestParam(defaultValue = "/") String redirectURL,
                          HttpServletRequest request) {
        if (bindingResult.hasErrors()) {
            return "login/loginForm";
        }

        Member loginMember = loginService.login(form.getLoginId(), form.getPassword());

        if (loginMember == null) {
            bindingResult.reject("loginFail", "ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤.");
            return "login/loginForm";
        }

        //ë¡œê·¸ì¸ ì„±ê³µ ì²˜ë¦¬
        //ì„¸ì…˜ì´ ìˆìœ¼ë©´ ìˆëŠ” ì„¸ì…˜ ë°˜í™˜, ì—†ìœ¼ë©´ ì‹ ê·œ ì„¸ì…˜ ìƒì„±
        HttpSession session = request.getSession();
        //ì„¸ì…˜ì— ë¡œê·¸ì¸ íšŒì› ì •ë³´ ë³´ê´€
        session.setAttribute(SessionConst.LOGIN_MEMBER, loginMember);
        return "redirect:" + redirectURL;
    }
```
ë¡œê·¸ì¸ ì²´í¬ í•„í„°ì—ì„œ, ë¯¸ì¸ì¦ ì‚¬ìš©ìëŠ” ìš”ì²­ ê²½ë¡œë¥¼ í¬í•¨í•´ì„œ `/login`ì— `redirectURL` ìš”ì²­ íŒŒë¼ë¯¸í„°ë¥¼ ì¶”ê°€í•´ì„œ ìš”ì²­í–ˆë‹¤.<br/>
ì´ ê°’ì„ ì‚¬ìš©í•´ì„œ ë¡œê·¸ì¸ ì„±ê³µ ì‹œ í•´ë‹¹ ê²½ë¡œë¡œ ê³ ê°ì„ `redirect`í•œë‹¤.<br/><br/>
ì„œë¸”ë¦¿ í•„í„°ë¥¼ ì˜ ì‚¬ìš©í•œ ë•ë¶„ì— ë¡œê·¸ì¸ í•˜ì§€ ì•Šì€ ì‚¬ìš©ìëŠ” ë‚˜ë¨¸ì§€ ê²½ë¡œì— ë“¤ì–´ê°ˆ ìˆ˜ ì—†ê²Œ ë˜ì—ˆë‹¤. ê³µí†µ ê´€ì‹¬ì‚¬ë¥¼ ì„œë¸”ë¦¿ í•„í„°ë¥¼ ì‚¬ìš©í•´ì„œ í•´ê²°í•œ ë•ë¶„ì— í–¥í›„ ë¡œê·¸ì¸ ê´€ë ¨ ì •ì±…ì´ ë³€ê²½ë˜ì–´ë„ ì´ ë¶€ë¶„ë§Œ ë³€ê²½í•˜ë©´ ëœë‹¤.<br/><br/>
# ğŸ” ìŠ¤í”„ë§ ì¸í„°ì…‰í„° - ì†Œê°œ
ìŠ¤í”„ë§ ì¸í„°ì…‰í„°ë„ ì„œë¸”ë¦¿ í•„í„°ì™€ ê°™ì´ ì›¹ê³¼ ê´€ë ¨ëœ ê³µí†µ ê´€ì‹¬ ì‚¬í•­ì„ íš¨ê³¼ì ìœ¼ë¡œ í•´ê²°í•  ìˆ˜ ìˆëŠ” ê¸°ìˆ ì´ë‹¤.<br/>
ì„œë¸”ë¦¿ í•„í„°ê°€ ì„œë¸”ë¦¿ì´ ì œê³µí•˜ëŠ” ê¸°ìˆ ì´ë¼ë©´, ìŠ¤í”„ë§ ì¸í„°ì…‰í„°ëŠ” ìŠ¤í”„ë§ MVCê°€ ì œê³µí•˜ëŠ” ê¸°ìˆ ì´ë‹¤.<br/>
ë‘˜ë‹¤ ì›¹ê³¼ ê´€ë ¨ëœ ê³µí†µ ê´€ì‹¬ ì‚¬í•­ì„ ì²˜ë¦¬í•˜ì§€ë§Œ ì ìš©ë˜ëŠ” ìˆœì„œì™€ ë²”ìœ„, ì‚¬ìš©ë°©ë²•ì´ ë‹¤ë¥´ë‹¤.<br/><br/>
### ìŠ¤í”„ë§ ì¸í„°ì…‰í„° íë¦„
```
HTTP ìš”ì²­ -> WAS -> í•„í„° -> ì„œë¸”ë¦¿ -> ìŠ¤í”„ë§ ì¸í„°ì…‰í„° -> ì»¨íŠ¸ë¡¤ëŸ¬
```
ìŠ¤í”„ë§ ì¸í„°ì…‰í„°ëŠ” ë””ìŠ¤íŒ¨ì²˜ ì„œë¸”ë¦¿ê³¼ ì»¨íŠ¸ë¡¤ëŸ¬ ì‚¬ì´ì—ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ í˜¸ì¶œ ì§ì „ì— í˜¸ì¶œëœë‹¤.<br/>
ìŠ¤í”„ë§ ì¸í„°ì…‰í„°ëŠ” ìŠ¤í”„ë§ MVCê°€ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì´ê¸° ë•Œë¬¸ì— ë””ìŠ¤íŒ¨ì²˜ ì„œë¸”ë¦¿ ì´í›„ì— ë“±ì¥í•˜ê²Œ ëœë‹¤.<br/>
ìŠ¤í”„ë§ ì¸í„°ì…‰í„°ì—ë„ URL íŒ¨í„´ì„ ì ìš©í•  ìˆ˜ ìˆëŠ”ë°, ì„œë¸”ë¦¿ URL íŒ¨í„´ê³¼ëŠ” ë‹¤ë¥´ê³ , ë§¤ìš° ì •ë°€í•˜ê²Œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.<br/><br/>
### ìŠ¤í”„ë§ ì¸í„°ì…‰í„° ì œí•œ
```
HTTP ìš”ì²­ -> WAS -> í•„í„° -> ì„œë¸”ë¦¿ -> ìŠ¤í”„ë§ ì¸í„°ì…‰í„° -> ì»¨íŠ¸ë¡¤ëŸ¬ //ë¡œê·¸ì¸ ì‚¬ìš©ì
HTTP ìš”ì²­ -> WAS -> í•„í„° -> ì„œë¸”ë¦¿ -> ìŠ¤í”„ë§ ì¸í„°ì…‰í„°(ì ì ˆí•˜ì§€ ì•Šì€ ìš”ì²­ì´ë¼ íŒë‹¨, ì»¨íŠ¸ë¡¤ëŸ¬ í˜¸ì¶œX) // ë¹„ ë¡œê·¸ì¸ ì‚¬ìš©ì
```
ì¸í„°ì…‰í„°ì—ì„œ ì ì ˆí•˜ì§€ ì•Šì€ ìš”ì²­ì´ë¼ê³  íŒë‹¨í•˜ë©´ ê±°ê¸°ì—ì„œ ëì„ ë‚¼ ìˆ˜ë„ ìˆë‹¤. ê·¸ë˜ì„œ ë¡œê·¸ì¸ ì—¬ë¶€ë¥¼ ì²´í¬í•˜ê¸°ì— ì í•©í•˜ë‹¤.<br/><br/>
### ìŠ¤í”„ë§ ì¸í„°ì…‰í„° ì²´ì¸
```
HTTP ìš”ì²­ -> WAS -> í•„í„° -> ì„œë¸”ë¦¿ -> ì¸í„°ì…‰í„°1 -> ì¸í„°ì…‰í„°2 -> ì»¨íŠ¸ë¡¤ëŸ¬
```
ìŠ¤í”„ë§ ì¸í„°ì…‰í„°ëŠ” ì²´ì¸ìœ¼ë¡œ êµ¬ì„±ë˜ëŠ”ë°, ì¤‘ê°„ì— ì¸í„°ì…‰í„°ë¥¼ ììœ ë¡­ê²Œ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ì„œ ë¡œê·¸ë¥¼ ë‚¨ê¸°ëŠ” ì¸í„°ì…‰í„°ë¥¼ ë¨¼ì € ì ìš©í•˜ê³ , ê·¸ ë‹¤ìŒì— ë¡œê·¸ì¸ ì—¬ë¶€ë¥¼ ì²´í¬í•˜ëŠ” ì¸í„°ì…‰í„°ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.<br/><br/>
### ìŠ¤í”„ë§ ì¸í„°ì…‰í„° ì¸í„°í˜ì´ìŠ¤
```java
public interface HandlerInterceptor {
    default boolean preHandle(HttpServletRequest request, HttpServletResponse
            response, Object handler) throws Exception {}
    default void postHandle(HttpServletRequest request, HttpServletResponse
            response, Object handler, @Nullable ModelAndView modelAndView)
            throws Exception {}
    default void afterCompletion(HttpServletRequest request, HttpServletResponse
            response, Object handler, @Nullable Exception ex) throws Exception {}
}
```
- ì¸í„°ì…‰í„°ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ í˜¸ì¶œ ì „(`preHandle`), í˜¸ì¶œ í›„(`postHandle`), ìš”ì²­ ì™„ë£Œ ì´í›„(`afterCompletion`)ì™€ ê°™ì´ ë‹¨ê³„ì ìœ¼ë¡œ ì˜ ì„¸ë¶„í™”ë˜ì–´ ìˆë‹¤.
- ì„œë¸”ë¦¿ í•„í„°ì˜ ê²½ìš° ë‹¨ìˆœíˆ `request`, `response`ë§Œ ì œê³µí–ˆì§€ë§Œ, ì¸í„°ì…‰í„°ëŠ” ì–´ë–¤ ì»¨íŠ¸ë¡¤ëŸ¬(`handler`)ê°€ í˜¸ì¶œë˜ëŠ”ì§€ í˜¸ì¶œ ì •ë³´ë„ ë°›ì„ ìˆ˜ ìˆë‹¤. ê·¸ë¦¬ê³  ì–´ë–¤ `modelAndView`ê°€ ë°˜í™˜ë˜ëŠ”ì§€ ì‘ë‹µ ì •ë³´ë„ ë°›ì„ ìˆ˜ ìˆë‹¤.
<br/><br/>
### ìŠ¤í”„ë§ ì¸í„°ì…‰í„° í˜¸ì¶œ íë¦„
![image](https://github.com/jang9205/spring_study/assets/123082616/46271707-2472-41a6-a217-ae1e15cdf9a9)<br/><br/>
- `preHandle`: ì»¨íŠ¸ë¡¤ëŸ¬ í˜¸ì¶œ ì „ì— í˜¸ì¶œëœë‹¤.(ë” ì •í™•íˆëŠ” í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„° í˜¸ì¶œ ì „ì— í˜¸ì¶œëœë‹¤.)
  - `preHandle`ì˜ ì‘ë‹µê°’ì´ `true`ì´ë©´ ë‹¤ìŒìœ¼ë¡œ ì§„í–‰í•˜ê³ , `false`ì´ë©´ ë”ëŠ” ì§„í–‰í•˜ì§€ ì•ŠëŠ”ë‹¤. `false`ì¸ ê²½ìš° ë‚˜ë¨¸ì§€ ì¸í„°ì…‰í„°ëŠ” ë¬¼ë¡ ì´ê³ , í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ë„ í˜¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤.
- `postHandle`: ì»¨íŠ¸ë¡¤ëŸ¬ í˜¸ì¶œ í›„ì— í˜¸ì¶œëœë‹¤. (ë” ì •í™•íˆëŠ” í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„° í˜¸ì¶œ í›„ì— í˜¸ì¶œëœë‹¤.)
- `afterCompletion`: ë·°ê°€ ë Œë”ë§ ëœ ì´í›„ì— í˜¸ì¶œëœë‹¤.
<br/><br/>
### ìŠ¤í”„ë§ ì¸í„°ì…‰í„° ì˜ˆì™¸ ìƒí™©
![image](https://github.com/jang9205/spring_study/assets/123082616/ec68396a-e01f-4eb7-9fdb-4321edc487c4)<br/><br/>
#### ì˜ˆì™¸ê°€ ë°œìƒ ì‹œ
- `preHandle`: ì»¨íŠ¸ë¡¤ëŸ¬ í˜¸ì¶œ ì „ì— í˜¸ì¶œëœë‹¤.
- `postHandle`: ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ `postHandle`ì€ í˜¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤.
- `afterCompletion`: í•­ìƒ í˜¸ì¶œëœë‹¤. ì´ ê²½ìš° ì˜ˆì™¸(`ex`)ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë°›ì•„ì„œ ì–´ë–¤ ì˜ˆì™¸ê°€ ë°œìƒí–ˆëŠ”ì§€ ë¡œê·¸ë¡œ ì¶œë ¥í•  ìˆ˜ ìˆë‹¤.
#### afterCompletionì€ ì˜ˆì™¸ê°€ ë°œìƒí•´ë„ í˜¸ì¶œëœë‹¤.
- ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ `postHandle()`ëŠ” í˜¸ì¶œë˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì˜ˆì™¸ì™€ ë¬´ê´€í•˜ê²Œ ê³µí†µ ì²˜ë¦¬ë¥¼ í•˜ë ¤ë©´ `afterCompletion()`ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
- ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ `afterCompletion()`ì— ì˜ˆì™¸ ì •ë³´(`ex`)ë¥¼ í¬í•¨í•´ì„œ í˜¸ì¶œëœë‹¤.
<br/><br/>
ì¸í„°ì…‰í„°ëŠ” ìŠ¤í”„ë§ MVC êµ¬ì¡°ì— íŠ¹í™”ëœ í•„í„° ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤ê³  ì´í•´í•˜ë©´ ëœë‹¤.<br/>
ìŠ¤í”„ë§ MVCë¥¼ ì‚¬ìš©í•˜ê³ , íŠ¹ë³„íˆ í•„í„°ë¥¼ ê¼­ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ìƒí™©ì´ ì•„ë‹ˆë¼ë©´ ì¸í„°ì…‰í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë” í¸ë¦¬í•˜ë‹¤.<br/><br/>
# ğŸ” ìŠ¤í”„ë§ ì¸í„°ì…‰í„° - ìš”ì²­ ë¡œê·¸
### ìš”ì²­ ë¡œê·¸ ì¸í„°ì…‰í„°
`main/java/hello/login/web/interceptor/LogInterceptor`
```java
@Slf4j
public class LogInterceptor implements HandlerInterceptor {

    public static final String LOG_ID = "logId";

    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {

        String requestURI = request.getRequestURI();
        String uuid = UUID.randomUUID().toString();

        request.setAttribute(LOG_ID, uuid);

        //@RequestMapping: HandlerMethod
        //ì •ì  ë¦¬ì†ŒìŠ¤: ResourceHttpRequestHandler
        if (handler instanceof HandlerMethod) {
            HandlerMethod hm = (HandlerMethod) handler;   //í˜¸ì¶œí•  ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì„œë“œì˜ ëª¨ë“  ì •ë³´ê°€ í¬í•¨ë˜ì–´ ìˆë‹¤.
        }

        log.info("REQUEST [{}][{}][{}]", uuid, requestURI, handler);
        return true;
    }

    @Override
    public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception {
        log.info("postHandler [{}]", modelAndView);
    }

    @Override
    public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception {
        String requestURI = request.getRequestURI();
        String logId = (String) request.getAttribute(LOG_ID);
        log.info("RESPONSE [{}][{}][{}]", logId, requestURI, handler);

        if (ex != null) {
            log.error("afterCompletion error!!", ex);
        }
    }
}
```
- `String uuid = UUID.randomUUID().toString()`
  - ìš”ì²­ ë¡œê·¸ë¥¼ êµ¬ë¶„í•˜ê¸° ìœ„í•œ `uuid`ë¥¼ ìƒì„±í•œë‹¤.
- `request.setAttribute(LOG_ID, uuid)`
  - ì„œë¸”ë¦¿ í•„í„°ì˜ ê²½ìš° ì§€ì—­ë³€ìˆ˜ë¡œ í•´ê²°ì´ ê°€ëŠ¥í•˜ì§€ë§Œ, ìŠ¤í”„ë§ ì¸í„°ì…‰í„°ëŠ” í˜¸ì¶œ ì‹œì ì´ ì™„ì „íˆ ë¶„ë¦¬ë˜ì–´ ìˆë‹¤. ë”°ë¼ì„œ `preHandle`ì—ì„œ ì§€ì •í•œ ê°’ì„ `postHandle`, `afterCompletion`ì—ì„œ í•¨ê»˜ ì‚¬ìš©í•˜ë ¤ë©´ ì–´ë”˜ê°€ì— ë‹´ì•„ë‘ì–´ì•¼ í•œë‹¤. `LogInterceptor`ë„ ì‹±ê¸€í†¤ì²˜ëŸ¼ ì‚¬ìš©ë˜ê¸° ë•Œë¬¸ì— ë§´ë²„ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ìœ„í—˜í•˜ë‹¤. ë”°ë¼ì„œ `request`ì— ë‹´ì•„ë‘ì—ˆë‹¤. ì´ ê°’ì€ `afterCompletion`ì—ì„œ `request.getAttribute(LOG_ID)`ë¡œ ì°¾ì•„ì„œ ì‚¬ìš©í•œë‹¤.
- `return true`
  - `true`ë©´ ì •ìƒ í˜¸ì¶œì´ë‹¤. ë‹¤ìŒ ì¸í„°ì…‰í„°ë‚˜ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ í˜¸ì¶œëœë‹¤.
<br/><br/>
#### 
<br/><br/>
```java
if (handler instanceof HandlerMethod) {
 HandlerMethod hm = (HandlerMethod) handler; //í˜¸ì¶œí•  ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì„œë“œì˜ ëª¨ë“  ì •ë³´ê°€ í¬í•¨ë˜ì–´ ìˆë‹¤.
}
```
**HandlerMethod**<br/>
í•¸ë“¤ëŸ¬ ì •ë³´ëŠ” ì–´ë–¤ í•¸ë“¤ëŸ¬ ë§¤í•‘ì„ ì‚¬ìš©í•˜ëŠ”ê°€ì— ë”°ë¼ ë‹¬ë¼ì§„ë‹¤. ìŠ¤í”„ë§ì„ ì‚¬ìš©í•˜ë©´ ì¼ë°˜ì ìœ¼ë¡œ `@Controller`, `@RequestMapping`ì„ í™œìš©í•œ í•¸ë“¤ëŸ¬ ë§¤í•‘ì„ ì‚¬ìš©í•˜ëŠ”ë°, ì´ ê²½ìš° í•¸ë“¤ëŸ¬ ì •ë³´ë¡œ `HandlerMethod`ê°€ ë„˜ì–´ì˜¨ë‹¤.<br/><br/>
**ResourceHttpRequestHandler**<br/>
`@Controller`ê°€ ì•„ë‹ˆë¼ `/resources/static`ì™€ ê°™ì€ ì •ì  ë¦¬ì†ŒìŠ¤ê°€ í˜¸ì¶œ ë˜ëŠ” ê²½ìš° `ResourceHttpRequestHandler`ê°€ í•¸ë“¤ëŸ¬ ì •ë³´ë¡œ ë„˜ì–´ì˜¤ê¸° ë•Œë¬¸ì— íƒ€ì…ì— ë”°ë¼ì„œ ì²˜ë¦¬ê°€ í•„ìš”í•˜ë‹¤.<br/><br/>
### ì¸í„°ì…‰í„° ë“±ë¡
`main/java/hello/login/WebConfig`
```java
@Configuration
public class WebConfig implements WebMvcConfigurer {

    @Override
    public void addInterceptors(InterceptorRegistry registry) {
        registry.addInterceptor(new LogInterceptor())
                .order(1)
                .addPathPatterns("/**")
                .excludePathPatterns("/css/**", "/*.ico", "/error");
    }

    ...
```
`WebMvcConfigurer`ê°€ ì œê³µí•˜ëŠ” `addInterceptors()`ë¥¼ ì‚¬ìš©í•´ì„œ ì¸í„°ì…‰í„°ë¥¼ ë“±ë¡í•  ìˆ˜ ìˆë‹¤.
- `registry.addInterceptor(new LogInterceptor())`: ì¸í„°ì…‰í„°ë¥¼ ë“±ë¡í•œë‹¤.
- `order(1)`: ì¸í„°ì…‰í„°ì˜ í˜¸ì¶œ ìˆœì„œë¥¼ ì§€ì •í•œë‹¤. ë‚®ì„ ìˆ˜ë¡ ë¨¼ì € í˜¸ì¶œëœë‹¤.
- `addPathPatterns("/**")`: ì¸í„°ì…‰í„°ë¥¼ ì ìš©í•  URL íŒ¨í„´ì„ ì§€ì •í•œë‹¤.
- `excludePathPatterns("/css/**", "/*.ico", "/error")`: ì¸í„°ì…‰í„°ì—ì„œ ì œì™¸í•  íŒ¨í„´ì„ ì§€ì •í•œë‹¤.
<br/><br/>![image](https://github.com/jang9205/spring_study/assets/123082616/e1ba313e-3443-4ac3-b25c-525db0a46e44)<br/><br/>
#### ìŠ¤í”„ë§ì˜ URL ê²½ë¡œ
ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” URL ê²½ë¡œëŠ” ì„œë¸”ë¦¿ ê¸°ìˆ ì´ ì œê³µí•˜ëŠ” URL ê²½ë¡œì™€ ì™„ì „íˆ ë‹¤ë¥´ë‹¤. ë”ìš± ìì„¸í•˜ê³ , ì„¸ë°€í•˜ê²Œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.<br/><br/>
**PathPattern ê³µì‹ ë¬¸ì„œ**<br/>
https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/util/pattern/PathPattern.html<br/><br/>
# ğŸ” ìŠ¤í”„ë§ ì¸í„°ì…‰í„° - ì¸ì¦ ì²´í¬
`main/java/hello/login/web/interceptor/LoginCheckInterceptor`
```java
@Slf4j
public class LoginCheckInterceptor implements HandlerInterceptor {

    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {

        String requestURI = request.getRequestURI();

        log.info("ì¸ì¦ ì²´í¬ ì¸í„°ì…‰í„° ì‹¤í–‰ {}", requestURI);

        HttpSession session = request.getSession();

        if (session == null || session.getAttribute(SessionConst.LOGIN_MEMBER) == null) {
            log.info("ë¯¸ì¸ì¦ ì‚¬ìš©ì ìš”ì²­");
            //ë¡œê·¸ì¸ìœ¼ë¡œ redirect
            response.sendRedirect("/login?redirectURL=" + requestURI);
            return false;
        }

        return true;
    }
}
```
ì¸ì¦ì´ë¼ëŠ” ê²ƒì€ ì»¨íŠ¸ë¡¤ëŸ¬ í˜¸ì¶œ ì „ì—ë§Œ í˜¸ì¶œë˜ë©´ ë˜ê¸° ë–„ë¬¸ì— `preHandle`ë§Œ êµ¬í˜„í•˜ë©´ ëœë‹¤.<br/><br/>
`main/java/hello/login/WebConfig`
```java
@Configuration
public class WebConfig implements WebMvcConfigurer {

    @Override
    public void addInterceptors(InterceptorRegistry registry) {
        registry.addInterceptor(new LogInterceptor())
                .order(1)
                .addPathPatterns("/**")
                .excludePathPatterns("/css/**", "/*.ico", "/error");

        registry.addInterceptor(new LoginCheckInterceptor())
                .order(2)
                .addPathPatterns("/**")
                .excludePathPatterns("/", "/members/add", "/login", "/logout", "/css/**", "/*.ico", "/error");
    }

    ...
```
ì¸í„°ì…‰í„°ë¥¼ ì ìš©í•˜ê±°ë‚˜ í•˜ì§€ ì•Šì„ ë¶€ë¶„ì€ `addPathPatterns`ì™€ `excludePathPatterns`ì— ì‘ì„±í•˜ë©´ ëœë‹¤.<br/><br/>
![image](https://github.com/jang9205/spring_study/assets/123082616/3095f9f5-7cf3-43a3-a62a-3bdeaf4c3e0b)<br/><br/>
íŠ¹ë³„í•œ ë¬¸ì œê°€ ì—†ë‹¤ë©´ ì¸í„°ì…‰í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.<br/><br/>
# ğŸ” ArgumentResolver í™œìš©
`ArgumentResolver`ë¥¼ ì‚¬ìš©í•´ì„œ ë¡œê·¸ì¸ íšŒì›ì„ í¸ë¦¬í•˜ê²Œ ì°¾ì„ ìˆ˜ ìˆë‹¤.<br/><br/>
`main/java/hello/login/web/HomeController`
```java
    ...

    @GetMapping("/")
    public String homeLoginV3ArgumentResolver(@Login Member loginMember, Model model) {

        //ì„¸ì…˜ì— íšŒì› ë°ì´í„°ê°€ ì—†ìœ¼ë©´ home
        if (loginMember == null) {
            return "home";
        }

        //ì„¸ì…˜ì´ ìœ ì§€ë˜ë©´ ë¡œê·¸ì¸ìœ¼ë¡œ ì´ë™
        model.addAttribute("member", loginMember);
        return "loginHome";
    }
}
```
`@Login` ì• ë…¸í…Œì´ì…˜ì´ ìˆìœ¼ë©´ ì§ì ‘ ë§Œë“  `ArgumentResolver`ê°€ ë™ì‘í•´ì„œ ìë™ìœ¼ë¡œ ì„¸ì…˜ì— ìˆëŠ” ë¡œê·¸ì¸ íšŒì›ì„ ì°¾ì•„ì£¼ê³ , ë§Œì•½ ì„¸ì…˜ì— ì—†ë‹¤ë©´ `null`ì„ ë°˜í™˜í•œë‹¤.<br/><br/>
#### @Login ì• ë…¸í…Œì´ì…˜ ìƒì„±
`main/java/hello/login/web/argumentresolver/Login`
```java
@Target(ElementType.PARAMETER)
@Retention(RetentionPolicy.RUNTIME)
public @interface Login {
}
```
`@Target(ElementType.PARAMETER)`: íŒŒë¼ë¯¸í„°ì—ë§Œ ì‚¬ìš©í•œë‹¤.<br/>
`@Retention(RetentionPolicy.RUNTIME)`: ë¦¬í”Œë ‰ì…˜ ë“±ì„ í™œìš©í•  ìˆ˜ ìˆë„ë¡ ëŸ°íƒ€ì„ê¹Œì§€ ì• ë…¸í…Œì´ì…˜ ì •ë³´ê°€ ë‚¨ì•„ìˆë‹¤.<br/><br/>
#### HandlerMethodArgumentResolver êµ¬í˜„
`main/java/hello/login/web/argumentresolver/LoginMemberArgumentResolver`
```java
@Slf4j
public class LoginMemberArgumentResolver implements HandlerMethodArgumentResolver {

    @Override
    public boolean supportsParameter(MethodParameter parameter) {
        log.info("supportsParameter ì‹¤í–‰");

        boolean hasLoginAnnotation = parameter.hasParameterAnnotation(Login.class);
        boolean hasMemberType = Member.class.isAssignableFrom(parameter.getParameterType());
        return hasLoginAnnotation && hasMemberType;
    }

    @Override
    public Object resolveArgument(MethodParameter parameter, ModelAndViewContainer mavContainer, NativeWebRequest webRequest, WebDataBinderFactory binderFactory) throws Exception {

        log.info("resolveArgument ì‹¤í–‰");

        HttpServletRequest request = (HttpServletRequest) webRequest.getNativeRequest();
        HttpSession session = request.getSession(false);
        if (session == null) {
            return null;
        }

        return session.getAttribute(SessionConst.LOGIN_MEMBER);
    }
}
```
`supportsParameter()`: `@Login` ì• ë…¸í…Œì´ì…˜ì´ ìˆìœ¼ë©´ì„œ `Member` íƒ€ì…ì´ë©´ í•´ë‹¹ `ArgumentResolver`ê°€ ì‚¬ìš©ëœë‹¤.<br/>
`resolveArgument()`: ì»¨íŠ¸ë¡¤ëŸ¬ í˜¸ì¶œ ì§ì „ì— í˜¸ì¶œë˜ì–´ì„œ í•„ìš”í•œ íŒŒë¼ë¯¸í„° ì •ë³´ë¥¼ ìƒì„±í•´ì¤€ë‹¤. ì—¬ê¸°ì„œëŠ” ì„¸ì…˜ì— ìˆëŠ” ë¡œê·¸ì¸ íšŒì› ì •ë³´ì¸ `member` ê°ì²´ë¥¼ ì°¾ì•„ì„œ ë°˜í™˜í•´ì¤€ë‹¤. ì´í›„ ìŠ¤í”„ë§MVCëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©´ì„œ ì—¬ê¸°ì—ì„œ ë°˜í™˜ëœ `member` ê°ì²´ë¥¼ íŒŒë¼ë¯¸í„°ì— ì „ë‹¬í•´ì¤€ë‹¤.<br/><br/>
#### WebMvcConfigurerì— ì„¤ì • ì¶”ê°€
`main/java/hello/login/WebConfig`
```java
@Configuration
public class WebConfig implements WebMvcConfigurer {

    @Override
    public void addArgumentResolvers(List<HandlerMethodArgumentResolver> resolvers) {
        resolvers.add(new LoginMemberArgumentResolver());
    }

    ...
```
ì‹¤í–‰í•´ë³´ë©´ ê²°ê³¼ëŠ” ë™ì¼í•˜ì§€ë§Œ ë” í¸ë¦¬í•˜ê²Œ ë¡œê·¸ì¸ íšŒì› ì •ë³´ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.<br/>
ì´ë ‡ê²Œ `ArgumentResolver`ë¥¼ í™œìš©í•˜ë©´ ê³µí†µ ì‘ì—…ì´ í•„ìš”í•  ë•Œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë”ìš± í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.